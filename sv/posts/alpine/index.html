<!DOCTYPE html><HTML lang="sv"><head><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link href="https://www.unto.re/sv/posts/alpine/" rel="canonical"/><link href="https://www.unto.re/amp/sv/posts/alpine/" rel="amphtml"/><script class="" id="" type="application/ld+json">{"copyrightHolder":"untoreh","@id":"https://www.unto.re","url":"https://www.unto.re","copyrightYear":2021,"@context":"https://schema.org/","image":"/assets/appa.png","@type":"WebSite"}</script><script class="" id="" type="application/ld+json">{"audience":"cool people","url":"https://www.unto.re/posts/alpine/index.html","mainContentOfPage":{"@type":"WebPageElement","cssSelector":".franklin-content"},"accessMode":["textual","visual"],"accessibilitySummary":"Visual elements are tentatively described.","description":"Pine, Alpine linux based on OSTree","author":{"sameAs":["https://github.com/untoreh","https://twitter.com/untoreh"],"email":"contact@unto.re","name":"untoreh","@type":"https://schema.org/Person","image":"/assets/appa.png"},"mentions":[],"@context":"https://schema.org","accessModeSufficient":{"itemListElement":["textual","visual"],"@type":"itemList"},"@type":"https://schema.org/WebPage","lastReviewed":"2021-04-19","dateCreated":"April 24, 2021","@id":"https://www.unto.re/posts/alpine/index.html","dateModified":"2021-04-19","availableLanguage":[{"name":"English","@type":"Language"},{"name":"German","@type":"Language"},{"name":"Italian","@type":"Language"},{"name":"Mandarin Chinese","@type":"Language"},{"name":"Spanish","@type":"Language"},{"name":"Hindi","@type":"Language"},{"name":"Arabic","@type":"Language"},{"name":"Portuguese","@type":"Language"},{"name":"Bengali","@type":"Language"},{"name":"Russian","@type":"Language"},{"name":"Japanese","@type":"Language"},{"name":"Punjabi","@type":"Language"},{"name":"Javanese","@type":"Language"},{"name":"Vietnamese","@type":"Language"},{"name":"French","@type":"Language"},{"name":"Urdu","@type":"Language"},{"name":"Turkish","@type":"Language"},{"name":"Polish","@type":"Language"},{"name":"Ukranian","@type":"Language"},{"name":"Dutch","@type":"Language"},{"name":"Greek","@type":"Language"},{"name":"Swedish","@type":"Language"},{"name":"Zulu","@type":"Language"},{"name":"Romanian","@type":"Language"},{"name":"Malay","@type":"Language"},{"name":"Korean","@type":"Language"},{"name":"Thai","@type":"Language"},{"name":"Filipino","@type":"Language"}],"keywords":["tools","about"],"creativeWorkStatus":"Published","publisher":{"url":"https://www.unto.re","sameAs":["https://github.com/untoreh","https://twitter.com/untoreh"],"contactPoint":{"contactType":"info","email":"contact@unto.re","@type":"ContactPoint","telephone":""},"logo":"/assets/appa.png","name":"untoreh's site","@type":"Organization"},"datePublished":"2021-04-19","inLanguage":"English","image":"/assets/appa.png","name":"","mainEntityOfPage":{"@id":"https://www.unto.re/posts/alpine/index.html","@type":"Article"}}</script><script class="" id="ldj-breadcrumbs" type="application/ld+json">{"itemListElement":[{"position":1,"item":"https://www.unto.re","name":"Home","@type":"ListItem"},{"position":2,"item":"/posts/","name":"Posts List","@type":"ListItem"},{"position":3,"item":"https://www.unto.re/posts/alpine","name":"Alpine","@type":"ListItem"}],"@type":"BreadcrumbList"}</script><link href="/css/franklin.css" rel="stylesheet"/><link href="/css/main.css" rel="stylesheet"/><link href="/css/menu.css" rel="stylesheet"/><link href="/css/pages.css" rel="stylesheet"/><link href="/css/lunr.css" rel="stylesheet"/><link href="/css/footer.css" rel="stylesheet"/><link href="/css/responsive.css" rel="stylesheet"/><link href="/css/animations.css" rel="stylesheet"/><link href="/css/docco.css" rel="stylesheet"/><link href="/css/flags-sprite.css" rel="stylesheet"/><link href="/assets/favicon.png" rel="icon" type="image/x-icon"/><link href="/assets/favicon.svg" rel="icon" type="image/svg+xml"/><title> Alpint</title><meta content="Pine, Alpine linux based on OSTree" name="description"/><script src="/libs/load.js"></script><script class="" id="" type="application/ld+json">{"url":"/sv/posts/alpine/","mainContentOfPage":{"@type":"WebPageElement","cssSelector":".franklin-content"},"accessMode":["textual","visual"],"mentions":null,"description":"","@context":"https://schema.org","accessModeSufficient":{"itemListElement":["textual","visual"],"@type":"itemList"},"@type":"https://schema.org/WebPage","lastReviewed":"","dateCreated":"","@id":"/sv/posts/alpine/","dateModified":"","keywords":[],"creativeWorkStatus":"Published","translator":{"url":"http://google.translate.com","name":"Google Translate","@type":"https://schema.org/Organization"},"translationOfWork":{"@id":"https://www.unto.re/posts/alpine/"},"datePublished":"2021-10-19T19:08:29.289","inLanguage":"sv","name":"","mainEntityOfPage":{"@id":"/sv/posts/alpine/","@type":"Article"}}</script></head><body class=""><div class="masthead"><div class="masthead__inner-wrap"><div class="masthead__menu"><a class="site-title" href="/sv/"></a><div class="author__wrap"><script class="" id="" type="application/ld+json">{"sameAs":["https://github.com/untoreh","https://twitter.com/untoreh"],"email":"contact@unto.re","name":"untoreh","@type":"https://schema.org/Person","image":"/assets/appa.png"}</script><ul><li class="author__avatar" onclick="toggleTheme()"><img alt=" untoreh-light" class="flip-front" src="/assets/appa.png"/></li><li class="author__urls social-icons"><a href="https://twitter.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden="true" class="fab fa-fw fa-twitter-square"></i></a></li><li class="author__urls social-icons"><a href="https://github.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden="true" class="fab fa-fw fa-github"></i></a></li><li class="author__urls social-icons"><a href="mailto:contact@unto.re"><i class="fas fa-envelope"></i></a></li><li><script class="" id="" type="application/ld+json">{"potentialAction":{"query-input":"required maxlength=100 name=input","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":{"uri":"","scheme":"https","userinfo":"","host":"www.unto.re","port":"","path":"/search","query":"q=%7Binput%7D","fragment":""}}}</script></li></ul></div><nav id="site-nav"><div class="horiz"><ul><li class="masthead__menu-item hvr-outline-in" id="lunrSearch"><form id="lunrSearchForm" name="lunrSearchForm"><button class="search-button" formaction="/search/index.html" type="submit" value="Search"><i class="fas fa-search menu-icons"></i></button><input class="search-input" name="q" placeholder="Search…" type="text"/></form></li><li class="masthead__menu-item hvr-outline-in"><a href="/sv/posts/" title="All the articles that I have written"><i class="fas fa-pen menu-icons"></i> inlägg</a></li><li class="masthead__menu-item hvr-outline-in"><a href="/sv/media/" title="Video and audio content from streaming websites."><i class="fas fa-tv menu-icons"></i> media</a></li><li class="masthead__menu-item hvr-outline-in menu-lang-btn" title="Change website&#39;s language"><button class="langs-dropdown-wrapper"><i class="fas fa-language menu-icons"></i> Lang
            <div class="langs-dropdown-content" id="langs-dropdown-menu"><ul id="lang-list"><a class="lang-link" href="/ar/posts/alpine" id="lang-ar"><span class="flag flag-sa"></span>Arabic</a><a class="lang-link" href="/bn/posts/alpine" id="lang-bn"><span class="flag flag-bd"></span>Bengali</a><a class="lang-link" href="/nl/posts/alpine" id="lang-nl"><span class="flag flag-nl"></span>Dutch</a><a class="lang-link" href="/posts/alpine" id="lang-en"><span class="flag flag-gb"></span>English</a><a class="lang-link" href="/tl/posts/alpine" id="lang-tl"><span class="flag flag-ph"></span>Filipino</a><a class="lang-link" href="/fr/posts/alpine" id="lang-fr"><span class="flag flag-fr"></span>French</a><a class="lang-link" href="/de/posts/alpine" id="lang-de"><span class="flag flag-de"></span>German</a><a class="lang-link" href="/el/posts/alpine" id="lang-el"><span class="flag flag-gr"></span>Greek</a><a class="lang-link" href="/hi/posts/alpine" id="lang-hi"><span class="flag flag-in"></span>Hindi</a><a class="lang-link" href="/it/posts/alpine" id="lang-it"><span class="flag flag-it"></span>Italian</a><a class="lang-link" href="/ja/posts/alpine" id="lang-ja"><span class="flag flag-jp"></span>Japanese</a><a class="lang-link" href="/jw/posts/alpine" id="lang-jw"><span class="flag flag-id"></span>Javanese</a><a class="lang-link" href="/ko/posts/alpine" id="lang-ko"><span class="flag flag-kr"></span>Korean</a><a class="lang-link" href="/ms/posts/alpine" id="lang-ms"><span class="flag flag-ms"></span>Malay</a><a class="lang-link" href="/zh/posts/alpine" id="lang-zh"><span class="flag flag-cn"></span>Mandarin Chinese</a><a class="lang-link" href="/pl/posts/alpine" id="lang-pl"><span class="flag flag-pl"></span>Polish</a><a class="lang-link" href="/pt/posts/alpine" id="lang-pt"><span class="flag flag-pt"></span>Portuguese</a><a class="lang-link" href="/pa/posts/alpine" id="lang-pa"><span class="flag flag-in"></span>Punjabi</a><a class="lang-link" href="/ro/posts/alpine" id="lang-ro"><span class="flag flag-ro"></span>Romanian</a><a class="lang-link" href="/ru/posts/alpine" id="lang-ru"><span class="flag flag-ru"></span>Russian</a><a class="lang-link" href="/es/posts/alpine" id="lang-es"><span class="flag flag-es"></span>Spanish</a><a class="lang-link" href="/sv/posts/alpine" id="lang-sv"><span class="flag flag-se"></span>Swedish</a><a class="lang-link" href="/th/posts/alpine" id="lang-th"><span class="flag flag-th"></span>Thai</a><a class="lang-link" href="/tr/posts/alpine" id="lang-tr"><span class="flag flag-tr"></span>Turkish</a><a class="lang-link" href="/uk/posts/alpine" id="lang-uk"><span class="flag flag-ua"></span>Ukranian</a><a class="lang-link" href="/ur/posts/alpine" id="lang-ur"><span class="flag flag-pk"></span>Urdu</a><a class="lang-link" href="/vi/posts/alpine" id="lang-vi"><span class="flag flag-vn"></span>Vietnamese</a><a class="lang-link" href="/zu/posts/alpine" id="lang-zu"><span class="flag flag-za"></span>Zulu</a></ul></div></button></li></ul></div><button class="ham"><i class="fas fa-bars ham-icon"></i></button><div class="vert"><ul><li class="masthead__menu-item hvr-outline-in" id="lunrSearch"><form id="lunrSearchForm" name="lunrSearchForm"><button class="search-button" formaction="/search/index.html" type="submit" value="Search"><i class="fas fa-search menu-icons"></i></button><input class="search-input" name="q" placeholder="Search…" type="text"/></form></li><li class="masthead__menu-item hvr-outline-in"><a href="/sv/posts/" title="All the articles that I have written"><i class="fas fa-pen menu-icons"></i> inlägg</a></li><li class="masthead__menu-item hvr-outline-in"><a href="/sv/media/" title="Video and audio content from streaming websites."><i class="fas fa-tv menu-icons"></i> media</a></li><li class="masthead__menu-item hvr-outline-in menu-lang-btn" title="Change website&#39;s language"><button class="langs-dropdown-wrapper"><i class="fas fa-language menu-icons"></i> Lang
            <div class="langs-dropdown-content" id="langs-dropdown-menu"><ul id="lang-list"><a class="lang-link" href="/ar/posts/alpine" id="lang-ar"><span class="flag flag-sa"></span>Arabic</a><a class="lang-link" href="/bn/posts/alpine" id="lang-bn"><span class="flag flag-bd"></span>Bengali</a><a class="lang-link" href="/nl/posts/alpine" id="lang-nl"><span class="flag flag-nl"></span>Dutch</a><a class="lang-link" href="/posts/alpine" id="lang-en"><span class="flag flag-gb"></span>English</a><a class="lang-link" href="/tl/posts/alpine" id="lang-tl"><span class="flag flag-ph"></span>Filipino</a><a class="lang-link" href="/fr/posts/alpine" id="lang-fr"><span class="flag flag-fr"></span>French</a><a class="lang-link" href="/de/posts/alpine" id="lang-de"><span class="flag flag-de"></span>German</a><a class="lang-link" href="/el/posts/alpine" id="lang-el"><span class="flag flag-gr"></span>Greek</a><a class="lang-link" href="/hi/posts/alpine" id="lang-hi"><span class="flag flag-in"></span>Hindi</a><a class="lang-link" href="/it/posts/alpine" id="lang-it"><span class="flag flag-it"></span>Italian</a><a class="lang-link" href="/ja/posts/alpine" id="lang-ja"><span class="flag flag-jp"></span>Japanese</a><a class="lang-link" href="/jw/posts/alpine" id="lang-jw"><span class="flag flag-id"></span>Javanese</a><a class="lang-link" href="/ko/posts/alpine" id="lang-ko"><span class="flag flag-kr"></span>Korean</a><a class="lang-link" href="/ms/posts/alpine" id="lang-ms"><span class="flag flag-ms"></span>Malay</a><a class="lang-link" href="/zh/posts/alpine" id="lang-zh"><span class="flag flag-cn"></span>Mandarin Chinese</a><a class="lang-link" href="/pl/posts/alpine" id="lang-pl"><span class="flag flag-pl"></span>Polish</a><a class="lang-link" href="/pt/posts/alpine" id="lang-pt"><span class="flag flag-pt"></span>Portuguese</a><a class="lang-link" href="/pa/posts/alpine" id="lang-pa"><span class="flag flag-in"></span>Punjabi</a><a class="lang-link" href="/ro/posts/alpine" id="lang-ro"><span class="flag flag-ro"></span>Romanian</a><a class="lang-link" href="/ru/posts/alpine" id="lang-ru"><span class="flag flag-ru"></span>Russian</a><a class="lang-link" href="/es/posts/alpine" id="lang-es"><span class="flag flag-es"></span>Spanish</a><a class="lang-link" href="/sv/posts/alpine" id="lang-sv"><span class="flag flag-se"></span>Swedish</a><a class="lang-link" href="/th/posts/alpine" id="lang-th"><span class="flag flag-th"></span>Thai</a><a class="lang-link" href="/tr/posts/alpine" id="lang-tr"><span class="flag flag-tr"></span>Turkish</a><a class="lang-link" href="/uk/posts/alpine" id="lang-uk"><span class="flag flag-ua"></span>Ukranian</a><a class="lang-link" href="/ur/posts/alpine" id="lang-ur"><span class="flag flag-pk"></span>Urdu</a><a class="lang-link" href="/vi/posts/alpine" id="lang-vi"><span class="flag flag-vn"></span>Vietnamese</a><a class="lang-link" href="/zu/posts/alpine" id="lang-zu"><span class="flag flag-za"></span>Zulu</a></ul></div></button></li></ul></div></nav></div></div></div><div><h1 id="title"><a href="/sv/posts/alpine"> Alpint</a></h1><blockquote id="page-description" style="font-style: italic;"> 
                Pine, Alpine linux baserat på OSTree
            </blockquote></div><div class="franklin-content"><p> Att välja vad<a href="https://en.wikipedia.org/wiki/Operating_system"> OS</a>  körs på dina servrar är en fråga om bekvämlighet och förtrogenhet. Bekvämlighet betyder att du vill ha något som ger dig så mindre problem som möjligt, förtrogenhet betyder att du föredrar det<em> inte</em>  att lära sig ytterligare saker om du inte behöver.</p><p> Mina servrar är<a href="https://devops.stackexchange.com/questions/653/what-is-the-definition-of-cattle-not-pets"> sällskapsdjur</a>så jag mår bra manuellt med några kommandon då och då och kräver ingen fullständig automatisering.</p><p> Efter att ha provat<a href="https://en.wikipedia.org/wiki/Container_Linux"> CoreOS</a>  under ett år bytte jag till min egen förenklade<a href="https://en.wikipedia.org/wiki/Linux_distribution"> distro</a>  baserat på alpint och<a href="https://en.wikipedia.org/wiki/OSTree"> ostree</a>.</p><h2 id="goals"><a class="header-anchor" href="#goals"> Mål</a></h2><p> Denna version av alpin tar ledtrådar från<a href="https://kinvolk.io/flatcar-container-linux/"> flakbil</a>  och<a href="https://www.projectatomic.io/"> projekt-atom</a>  och är tänkt att installeras som ett skrivskyddat rotfilsystem med uppdateringar som sker atomiskt, det vill säga antingen lyckas de eller systemet byter tillbaka till föregående tillstånd. För att detta ska vara möjligt måste systemet alltid ha åtminstone<strong> två ögonblicksbilder</strong>  av den släppta filsystemversionen, tillgänglig på lagring.</p><h2 id="targets"><a class="header-anchor" href="#targets"> Mål</a></h2><p> I vilka miljöer kommer systemet att köras? Jag riktade<a href="https://en.wikipedia.org/wiki/OpenVZ"> OVZ</a>  och [KVM], men i allmänhet kan man säga<em> behållare</em>  och<em> virtuella maskiner</em>  med den största skillnaden att behållare inte kör sin egen kärna, särskilt de inte har en startprocess, de ringer direkt till<em> i det</em>  system (som till exempel i ett<code><a href="https://en.wikipedia.org/wiki/Docker_(software)">Dockerfile</a></code>  det skulle definieras av<code>CMD</code>  eller<code>ENTRYPOINT</code>  uttalanden), som är ansvarig för att hantera trädet av processer som kommer att hålla behållaren igång (precis som en normal session, om init -processen dör, slutar behållaren). Behållare kan inte heller konfigurera systemknappar och kan ha ytterligare begränsningar för funktioner.</p><h2 id="bisecting_the_build_process"><a class="header-anchor" href="#bisecting_the_build_process"> Halverar byggprocessen</a></h2><p> Hur är bilden uppbyggd?</p><h3 id="dependencies"><a class="header-anchor" href="#dependencies"> Beroenden</a></h3><p> De<code>prepare.sh</code>  script hanterar beroenden, varav de flesta är paketen för att erbjuda vanliga cli -verktyg som<code>coreutils</code>, <code>util-linux</code>, <code>binutils</code> , verktyg för att arbeta med blockenheter som<code>blkid</code>, <code>sfdisk</code>, <code>multipath-tools</code>  och filsystem med<code>xfsprogs</code>  och<code>e2fsprogs</code> . De<code>squashfs-tools</code>  paketet används i slutet för att komprimera det inbyggda rotfilsystemet. A<code>glib</code>  kompatibilitetspaketet är också installerat som standard eftersom alpine är baserat på<code><a href="https://musl.libc.org/">musl</a></code>, kompatibilitetspaketet fungerar genom att tillhandahålla några bibliotek som är byggda mot.</p><h3 id="the_tree"><a class="header-anchor" href="#the_tree"> Trädet</a></h3><p> Filträd för både virtuella datorer och behållare byggs med respektive<code>make.sh</code>  och<code>make_ovz.sh</code> . Detta är en förenklad beskrivning av stegen</p><ul><li><p> ställ in den version som ska byggas enligt förvarstaggen</p></li><li><p> skapa en katalog för det nya trädet och rensa miljön</p></li><li><p> skapa basmålskataloger och kataloger som krävs av ostree, som<code>sysroot</code></p></li><li><p> skapa symlänkar för att överensstämma med<a href="https://www.freedesktop.org/software/systemd/man/file-hierarchy.html"> filsystem hierarki standard</a></p></li><li><p> kopiera anpassade tjänster och anpassade konfigurationer</p></li><li><p> setup chroot med monterade systemkataloger</p></li><li><p> bootstrap en alpin rootfs med baspaket</p></li><li><p> tillämpa minimal konfiguration på rootfs som referenser, tidszon, värdnamn.</p></li><li><p> kopieringstjänster som startas av init</p></li><li><p> konfigurera startkonfigurationen med den angivna kärnbilden</p></li><li><p> lägg eventuellt till anpassade kärnmoduler</p></li><li><p> utföra saneringar</p></li><li><p> begå rootfs<sup id="fnref:rootfs"><a class="fnref" href="#fndef:rootfs">[1]</a></sup>  till ostree -förvaret</p></li></ul><p> För behållare är sekvensen densamma, men konfigurationen ändras, eftersom ett system inte startas från en<a href="https://en.wikipedia.org/wiki/Bootloader"> bootloader</a>  ostree har problem med att verifiera miljön, vi måste tillämpa några<a href="https://github.com/untoreh/pine/blob/e65f12be70fd91edfd935e3ae9854c7be555ec73/make_ovz.sh#L73"> lösningar</a>  och konfigurera några enheter som vanligtvis hanteras av<a href="https://en.wikipedia.org/wiki/Initial_ramdisk"> initramfs</a>  steg. Detta är hur<a href="https://en.wikipedia.org/wiki/OpenVZ"> OVZ</a>  eller<a href="https://en.wikipedia.org/wiki/LXC"> LXC</a>  mallar är konfigurerade.</p><h3 id="packaging"><a class="header-anchor" href="#packaging"> Förpackning</a></h3><p> När vi har vår ostree engagerade filer träd<code>build.sh</code>  eller<code>build-update.sh</code>  tar hand om att ta fram den artefakt som kommer att distribueras. Skillnaden mellan skripten är att uppdateringsversionen startar från ett tidigare ostree -arkiv och<em> också</em>  producerar en delta -artefakt som ett körsystem kan använda på sin ostree -instans för att utföra uppgraderingar. Detta är en förenklad beskrivning av byggstegen</p><ul><li><p> om nybyggd</p><ul><li><p>skapa nya partitioner på en ny bild monterad som en loop -enhet</p></li></ul></li><li><p> annan</p><ul><li><p> montera sysroot och startpartitioner från tidigare build</p></li></ul></li><li><p> rensa upp tidigare ostree -distributioner (länkgårdar) på monterad byggnad</p></li><li><p> begå nytt byggt träd på monterat bygge</p></li><li><p> verifiera integritet och kontrollsummor</p></li><li><p> skapa nytt delta för uppgraderingar</p></li><li><p> köra ostree -distribution för att regenerera startkonfigurationen</p></li><li><p> ta bort gamla ostree commits</p></li><li><p> verifiera startpartitionens integritet</p></li><li><p> avmontera ny uppdaterad byggbild</p></li><li><p> skapa bildkontrollsumma och komprimera den (med<code>squashfs</code>  för behållare)</p></li></ul><p> Partitionskonfigurationen tillämpas med en fdisk<code>layout.cfg</code>  fil som definierar partitionsstorlekarna, har vi en partition för rootfs (<code>~430M</code> ), startpartitionen (<code>~40M</code> ) och en bytepartition (<code>~40M</code> ). Med behållare med bara hoppa över montering av den tidigare byggnaden över en loop -enhet, och dra bara den nya ostree -kommittén över det gamla (extraherade) ostree -förvaret.</p><h2 id="customizations"><a class="header-anchor" href="#customizations"> Anpassningar</a></h2><p> Vad buntar jag ihop i den här bilden (förutom installerade paket)?</p><ul><li><p> En liten lib in<code>functions.sh</code>  för vanliga uppgifter som utförs inom skalet</p></li><li><p> ostree -baserade uppgraderingsskript med låsmekanism baserad på KV -butik</p></li><li><p> övervakningsskript för IO både lokala (<code>iomon</code> ) och nätverk (<code>tcpmon</code>)</p></li><li><p> konfigurationsskript för andra behållartider än<code>bubblewrap</code>: <code>podman</code>, <code>toolbox</code></p></li></ul><p> Det som förr var och inte är längre</p><ul><li><p><code>sup</code>: <a href="https://github.com/pressly/sup/"> Supera</a>  användes för orkestrering (distribuera behållare) och konfiguration av värddatorn, men sedan bytte jag till<a href="https://www.ansible.com/"> ansvarsfull</a>  eftersom det fanns långvariga buggar i sup som saknade en fix, valde jag inte ansible från början eftersom jag inte ville att ett pythonberoende skulle installeras på varje server, så småningom bestämde jag mig med en sekundär alpin<a href="https://en.wikipedia.org/wiki/Chroot"> chroot</a>  på värdmaskinerna, som ligger i<code>/opt/alp</code>skulle jag installera ytterligare mindre kritisk programvara. Idag skulle jag dock återigen byta från ansible till<a href="https://github.com/Fizzadar/pyinfra"> pyinfra</a> , eftersom</p><ul><li><p> det är python utan kokplatta (ansible har pseudo<code>DSL</code>  som orsakar mer huvudvärk än de som det löser)</p></li><li><p> den kör sina recept med vanliga ssh -kommandon, så det finns inget krav på pythonberoende på målvärdar</p></li></ul></li><li><p><code>containerpilot</code> : Användningsfallet för containerpilot är att hantera komplexa beroenden mellan behållare utan skalskript ... det slutade få uppdateringar från<a href="https://github.com/joyent/containerpilot"> glädjande</a>  och sattes i underhållsläge, jag gillade inte heller minneskraven och minnesanvändningen skulle ständigt öka under en lång drifttid. Jag bytte den för enkla skalskript med<a href="https://www.consul.io/"> konsul</a> , Jag kanske tittar på mer korrekta alternativ om skalskript börjar växa för mycket. Tyngre lösningar som<a href="https://kubernetes.io/"> kubernetes</a>, <a href="https://docs.docker.com/engine/swarm/"> svärm</a>  eller<a href="https://www.nomadproject.io/"> nomad</a>  kasserades från start.</p></li><li><p><code>beegfs</code> : Jag brukade skicka den kärnmodul som var nödvändig för<a href="https://en.wikipedia.org/wiki/BeeGFS"> beegfs</a>  men efter ett tag bröt det kompatibiliteten och det faktum att det inte fanns ett korrekt stöd<a href="https://en.wikipedia.org/wiki/Filesystem_in_Userspace"> säkring</a>  modulen gör släpp det helt, jag kör för närvarande inte [DFS] på mina servrar, men möjligheten att ha ett färdigt filsystem för att ansluta till ett nätverk är fortfarande tilltalande.</p></li><li><p></p></li></ul><h2 id="installation"><a class="header-anchor" href="#installation"> Installation</a></h2><p>För att installera bilden kan du antingen ladda upp den till värdleverantören och installera från VNC, för virtuella datorer, men jag kapar vanligtvis en befintlig installation, eftersom det alltid är möjligt, så länge jag har testat installationsskriptet mot version av Linux-distributionen, vanligtvis använder jag debian-8 eller ubuntu-14, har inte testat andra eftersom jag alltid har funnit att dessa är tillgängliga. Installationsstegen följer</p><ul><li><p> säkerställa https -stöd för nedladdningar</p></li><li><p> ladda ner en busybox -version</p></li><li><p> installera en busybox link-farm</p></li><li><p> bestämma ipv4/ipv6 -adresser för nätverkskonfiguration</p></li><li><p> säkerställa chroot -funktioner</p></li><li><p> ladda ner tallbilden och extrahera den</p></li><li><p> if VM</p><ul><li><p> blinka över målenheten</p></li><li><p> montera över en loop -enhet</p></li></ul></li><li><p> skriva den lokala nätverkskonfigurationen över<em> att bli blinkade</em>  rootfs</p></li><li><p> om behållare</p><ul><li><p> kopiera init -tjänsten (för behållare) över huvudmonteringspunkten<code>/sbin/init</code></p></li></ul></li><li><p> if VM</p><ul><li><p> partitionera den kvarvarande disken med standard (<code>xfs</code> ) partitioner</p></li><li><p> avmontera</p></li><li><p> verifiera partitionernas integritet</p></li></ul></li><li><p> starta om</p></li></ul><h2 id="conclusions"><a class="header-anchor" href="#conclusions"> Slutsatser</a></h2><p> jag gjorde<a href="https://github.com/untoreh/pine"> tall</a> 5 years from time of writing and I am still using it, and I see no reasons to switch to anything else. Alpine as a linux distro is great, simple, and I have never experienced breakage. I can easily deploy on <a href="https://en.wikipedia.org/wiki/Network_address_translation"> NATed</a>  servrar som tenderar att erbjuda extremt låga resurser, faktiskt har jag en låda som körs med bara<code>64M</code>  RAM -minne och har fortfarande alla funktioner jag behöver.</p><p></p><table class="fndef" id="fndef:rootfs"><tbody><tr><td class="fndef-backref"><a href="#fnref:rootfs">[1]</a></td><td class="fndef-content"> rotfilsystem</td></tr></tbody></table><p></p><div id="post-tags-list"> 
Inläggstaggar:
<span class="post-tag"><a href="tag/tools" style="">  verktyg</a>, </span><span class="post-tag"><a href="tag/about" style="">  handla om</a></span></div><div class="page-foot"><div class="copyright"> 
        19 april 2021
    </div><script async="" crossorigin="anonymous" issue-term="pathname" label="Comment" repo="untoreh/untoreh.github.io" src="https://utteranc.es/client.js"></script></div></div><div class="page__footer"><footer><div class="page__footer-copyright"> 
            © untoreh - Drivs av<a href="https://github.com/tlienart/Franklin.jl"> Franklin</a></div><div class="page__footer-links">
            -
            <ul><li><a href="/sv/sitemapxml"> Webbplatskarta</a></li>
                |
                <li><a href="/sv/tag"> Taggar</a></li>
                |
                <li><a href="/sv/feedxml"> RSS</a></li></ul></div><ul class="author__wrap"><li class="author__urls social-icons"><a href="https://twitter.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden="true" class="fab fa-fw fa-twitter-square"></i></a></li><li class="author__urls social-icons"><a href="https://github.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden="true" class="fab fa-fw fa-github"></i></a></li><li class="author__urls social-icons"><a href="mailto:contact@unto.re"><i class="fas fa-envelope"></i></a></li><li><script class="" id="" type="application/ld+json">{"potentialAction":{"query-input":"required maxlength=100 name=input","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":{"uri":"","scheme":"https","userinfo":"","host":"www.unto.re","port":"","path":"/search","query":"q=%7Binput%7D","fragment":""}}}</script></li></ul></footer></div><script crossorigin="anonymous" defer="" id="fa" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" src="https://use.fontawesome.com/releases/v5.8.2/js/all.js"></script><script src="/libs/colors.js"></script><script src="/libs/menu.js"></script><script defer="" src="/libs/lunr/lunr.min.js"></script></body></HTML>