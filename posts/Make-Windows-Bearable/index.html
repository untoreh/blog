<!doctype html> <html lang=en > <script type="application/ld+json">{"copyrightHolder":"untoreh","@id":"https://unto.re","url":"https://unto.re","copyrightYear":2021,"@context":"https://schema.org/","@type":"WebSite"}</script> <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/main.css"> <link rel=stylesheet  href="/css/menu.css"> <link rel=stylesheet  href="/css/pages.css"> <link rel=stylesheet  href="/css/lunr.css"> <link rel=stylesheet  href="/css/footer.css"> <link rel=stylesheet  href="/css/responsive.css"> <link rel=stylesheet  href="/css/animations.css"> <link rel=icon  href="/assets/favicon.png"> <!--[if IE ]> <![endif]--> <title>Make Windows Bearable</title> <script src="/libs/lunr/lunr.min.js"></script> <script src="/libs/lunr/lunr_index.js"></script> <script src="/libs/lunr/lunrclient.js"></script> <script src="/libs/load.js"></script> <body class=""> <div class=masthead > <div class=masthead__inner-wrap > <div class=masthead__menu > <a class=site-title  href="/"></a> <div class=author__wrap > <script type="application/ld+json">{"sameAs":["https://github.com/untoreh","https://twitter.com/untoreh"],"description":"I am Francesco Giannelli. The website «unto.re» is the place where I put stuff I should remember...or forget. Located in south italy. Born in the early nineties.","image":"/assets/appa.png","name":"untoreh","@type":"https://schema.org/Person","email":"contact@unto.re"}</script> <ul> <li onclick="toggleTheme()" class=author__avatar > <img class=flip-front  src="/assets/appa.png" alt= "untoreh-light"><li class="author__urls social-icons"> <a href="https://twitter.com/untoreh" rel= "nofollow noopener noreferrer"><i class= "fab fa-fw fa-twitter-square" aria-hidden=true ></i></a> <li class="author__urls social-icons"> <a href="https://github.com/untoreh" rel= "nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden=true ></i></a> <li class="author__urls social-icons"> <a href="mailto:contact@unto.re"><i class= "fas fa-envelope"></i></a> <li class="author__place hvr-buzz-out"><script type="application/ld+json">{"homeLocation":{"addressCountry":"IT","addressRegion":"Apulia","@type":"https://schema.org/Place"}}</script> <div class="author__bio .hvr-bubble-float-top"> I am Francesco Giannelli. The website «unto.re» is the place where I put stuff I should remember...or forget. Located in south italy. Born in the early nineties. </div><a rel="nofollow noopener noreferrer" href= "https://goo.gl/maps/E3Si7WzG4LX7wpNJ6" target=_blank ><i class= "fas fa-fw fa-map-marker-alt" aria-hidden=true ></i>italy</a> <li><script type="application/ld+json">{"potentialAction":{"query-input":"required maxlength=100 name=query","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":"https://unto.re/search?&q={query}"}}</script> </ul> </div> <nav id=site-nav > <div class=horiz > <ul> <li id=lunrSearch  class="masthead__menu-item hvr-outline-in"><form id=lunrSearchForm  name=lunrSearchForm > <button class=search-button  type=submit  value=Search  formaction="/search/index.html"> <i class= "fas fa-search menu-icons"></i></button> <input class=search-input  name=q  placeholder="Search&#8230;" type=text > </form> <li class="masthead__menu-item hvr-outline-in"> <a href="/posts/"><i class="fas fa-pen menu-icons"></i>posts</a> <li class="masthead__menu-item hvr-outline-in"> <a href="/tag/lightbulbs/"><i class="fas fa-lightbulb menu-icons"></i>bulbs</a> <li class="masthead__menu-item hvr-outline-in"> <a href="/reads/"><i class="fas fa-book menu-icons"></i>reads</a> <li class="masthead__menu-item hvr-outline-in"> <a href="/tag/about/"><i class="fas fa-wrench menu-icons"></i>about</a> </ul> </div><button class=ham ><i class= "fas fa-bars ham-icon"></i></button> <div class=vert > <ul> <li id=lunrSearch  class="masthead__menu-item hvr-outline-in"><form id=lunrSearchForm  name=lunrSearchForm > <button class=search-button  type=submit  value=Search  formaction="/search/index.html"> <i class= "fas fa-search menu-icons"></i></button> <input class=search-input  name=q  placeholder="Search&#8230;" type=text > </form> <li class="masthead__menu-item hvr-outline-in"> <a href="/posts/"><i class="fas fa-pen menu-icons"></i>posts</a> <li class="masthead__menu-item hvr-outline-in"> <a href="/tag/lightbulbs/"><i class="fas fa-lightbulb menu-icons"></i>bulbs</a> <li class="masthead__menu-item hvr-outline-in"> <a href="/reads/"><i class="fas fa-book menu-icons"></i>reads</a> <li class="masthead__menu-item hvr-outline-in"> <a href="/tag/about/"><i class="fas fa-wrench menu-icons"></i>about</a> </ul> </div> </nav> </div> </div> </div> <div> <h1 id=title ><a href="">Make Windows Bearable</a></h1> <blockquote id=page-description  style="font-style: italic;"> A list of tools to make Windows feel more like Linux </blockquote> </div> <div class=franklin-content > <p>Since I <a href="/posts/OS-Hopping">switched to windows 10 with WSL</a> I figured I&#39;d make a list of software that I had to use to bring windows closer to my usual linux workflow. Let&#39;s make it clear that Windows UI sucks, it is stuck in the <em>90s</em> and everything is supposed to be clicked and dragged with your mouse pointer. I don&#39;t know if it is a <em>culture</em> thing &#40;windows devs must like the mouse very much&#41;, or for <em>target demographic</em> &#40;&quot;click at that thing&#33;&quot; is easy to explain&#41;, or because of <em>security best practice</em> &#40;if we give too much control to the user, malware will exploit it&#41; or just the <em>Windows Shell</em> being made of a pile of technological debt which makes it harder to add functionality for advanced users. The fact is that simple things in Linux need convoluted solutions in Windows.</p> <h2 id=virtual_desktops ><a href="#virtual_desktops" class=header-anchor >Virtual Desktops</a></h2> <p>In linux every windows manager has some form of virtual desktop, windows got built virtual desktops fairly recently with W10. The thing is that at the time of writing you can only cycle left and right with hotkeys, and there aren&#39;t hotkeys to go to desktop X. There is this <a href="https://github.com/Grabacr07/VirtualDesktop">vd library</a> but I haven&#39;t found software that makes use of it, instead only AHK<sup id="fnref:AHK"><a href="#fndef:AHK" class=fnref >[1]</a></sup> scripts with poor implementations like &quot;loop until we are at the correct VD&quot;. </p> <p>The lack of proper shortcuts for windows built-in virtual desktops made me force to use 3rd party software, of which there are many, I chose <a href="https://dexpot.de/">dexpot</a> as it does all the things I would need and more &#40;I would be happy with just <code>go to X</code> and <code>move window to X</code> shortcuts&#41;. The only problem was that dexpot isn&#39;t able to bind already bound keys...somewhat AHK is able to override keys used by other applications, whereas dexpot doesn&#39;t, I assume it is because it relies on a different windows API &#40;or &#91;dll&#93;&#41;. Workaround is to remap shortcuts the I wanted &#40;e.g. <code>Win&#43;1</code>&#41; with a free shortcut that could be set on dexpot &#40;e.g. <code>Win&#43;Shift&#43;F1</code>&#41;</p> <h2 id=keyboard_mapping ><a href="#keyboard_mapping" class=header-anchor >Keyboard mapping</a></h2> <p><a href="https://github.com/microsoft/PowerToys">Powertoys</a> allows to map keys, and shortcuts, such that I can map CapsLock-&gt;LeftControl and RightControl-&gt;LeftControl. And shortcuts like <code>Win&#43;hjkl</code> to arrows. Too bad <code>Win&#43;l</code> is a windows default shortcut for locking the screen and can&#39;t be remapped...a registry key overrides the shortcuts and fixes this...until you update windows...so you have to apply the fix at each boot&#33;</p> <h2 id=launcher ><a href="#launcher" class=header-anchor >Launcher</a></h2> <p>The apps launcher provided by powertoys is instead quite featureful, doesn&#39;t use much more memory than KRunner and is fast and responsive. The only complaint is that from time to time it looses focus, but this is most likely a problem with Windows sick &#40;as in perverted&#41; control of which window is supposed to be focused at any given time.</p> <h2 id=tiling ><a href="#tiling" class=header-anchor >Tiling</a></h2> <p>I switched from sway to KDE on Linux, so I wasn&#39;t that much of a tiled windows lover. Powertoys has FancyZones which is a slight improvement over basic windows Snaps that window offers, as it gives you <em>gaps</em> and <em>layouts</em>. Yet it is still lacking the most important thing that make tiling useful, that is <em>rules</em> to apply to matching windows, but this would also need support for virtual desktops...and we have already mentioned their current state. In Comparison KWin allows you to match windows with very complex definitions. FancyZones works around the rules issue by preserving windows positions across sessions, but I haven&#39;t investigated how well this works with different virtual desktops.</p> <h2 id=dragging_windows ><a href="#dragging_windows" class=header-anchor >Dragging windows</a></h2> <p>Windows can only be dragged from the titlebar, and an additional <a href="https://github.com/RamonUnch/AltDrag">utility</a> needs to be used to move them with a shortcut combination.</p> <h2 id=system_monitor ><a href="#system_monitor" class=header-anchor >System monitor</a></h2> <p>With KDE you have plasma widgets to display system informations, although plasma widgets tend to consume a lot of memory so I didn&#39;t use them that much. With Windows there isn&#39;t a built-in utility for this, after trying a few utilities I settled on <a href="https://github.com/zhongyang219/TrafficMonitor">Traffic Monitor</a> which gives network, cpu, memory, and just recently were added GPU and temps. The result is a nice low-profile rectangle displayed within the taskbar:</p> <img src="/assets/posts/img/trafficmonitor.png" alt=""> <p>Bonus point for Windows is that my UPS is recognized and is shown in the tray area, so doesn&#39;t need additional configuration, whereas in linux <a href="https://networkupstools.org/">NUT</a> there are <a href="https://github.com/networkupstools/nut/issues/300">drivers problems</a>.</p> <h2 id=system_services ><a href="#system_services" class=header-anchor >System Services</a></h2> <p>Many didn&#39;t like systemd when it came along into the linux kernel..With Windows I instead started missing it..Windows Services <a href="https://stackoverflow.com/questions/7629813/is-there-windows-analog-to-supervisord">is not really something oriented towards users</a> like systemd. Windows has the <strong>Task Scheduler</strong> to deal with things that look like <code>one-shot</code> unit files, but again its interface &#40;or lack thereof&#41; is dreadful. Lucky us we don&#39;t really need custom daemons in windows, since most of the windows applications we use are supposed are just <em>run at startup</em> kind of logic, and don&#39;t need more advanced configurations. In fact, apart the litter of tools &#40;<em>sigh</em>&#41; to make windows work like a modern environment, then only other native windows applications in use are the browser &#40;<a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a>&#41; since browser GPU acceleration is bad within WSL &#40;well even on native linux...&#41; and the video player &#40;<a href="https://mpv.io/">mpv</a>&#41;..and games of course...</p> <h2 id=packages ><a href="#packages" class=header-anchor >Packages</a></h2> <p>I don&#39;t like <a href="https://chocolatey.org">chocolatey</a> as it requires administrator privileges, I always look first for scoop packages as those are installed in the user folder, which is more convenient and more consistent, and simplifies backups.</p> <h2 id=wslg ><a href="#wslg" class=header-anchor >WSL/g</a></h2> <p>I was induced to switch to windows from the recent <a href="https://github.com/microsoft/wslg">WSLg</a> update. Which required mesa drivers compiled with the <code>d3d12</code>backend support for <code>opengl</code>. Windows provides a community preview ubuntu layer, but I opted for <a href="https://github.com/yuk7/ArchWSL">arch linux</a> since there was already an AUR package for <a href="https://aur.archlinux.org/packages/mesa-d3d12/">mesa with d3d12</a>. Since WSL currently doesn&#39;t support systemd, I ended up using <a href="https://github.com/Supervisor/supervisor/">supervisor</a> to manage a few services. To make sure supervisor is active there is a check in the shell profile for a lock file that should be created on <code>tmpfs</code> if supervisor has been previously started.</p> <p>WSL supports only <code>ext4</code> file systems, to use other file systems, you have to mount the partition &#40;or the disk&#41; directly insider the WSL VM. However they have to be mounted manually <em>as administrator</em> from windows. To automate this we can use the task scheduler that allows to bypass UAC prompt by running tasks <em>with the highest priviledge</em>. We can run a wsl <code>--mount</code> command to mount our desired disks/partitions and then run mount the filesystem from within linux. Because my <code>/home/</code> resisde in a mounted <code>btrfs</code> filesystem I have to mount it automatically, so we use <code>/etc/fstab</code> to map our partition &#40;by <code>LABEL</code>&#41; to <code>/home</code>. Because we use nix with <code>nix-env</code> we need to bind mount our nix store to <code>/nix</code> on every wsl startup, and because <code>/tmp</code> is not on <code>tmpfs</code> we have to create an overlay mount which mounts <code>tmpfs</code> over the existing <code>/tmp</code> directory, to preserve important files, specifically the X11 files, required to talk to the X server.</p> <p>These mounts are execute with a script, which should be run <em>after</em> we have mounted the disk inside linux. We need a task that runs after the mount task is completed, and because WSL uses different VMs for different windows users the script must be run NOT with highest priviledges &#40;oterwise it would mount on the Administrator VM&#41;.</p> <p>To ensure WSLg works, we have to make sure the XDG<em>RUNTIME</em>DIR is set, since it is different and located &#40;by default&#41; at <code>/mnt/wlsg/runtime-dir</code>. This is how windows under wayland look, you can see that since with wayland window decorations can be drawn by either the compositor or the application, they keep the configuration of your GTK/QT theming, so you end up with a native linux theme looking window inside a Windows shell...which is a little bit disorienting at first.</p> <div class=wslgemacs ><style> .wslgemacs img { width: 100%; } </style> <img src="/assets/posts/img/wslgemacs.png" alt=""></div> <h2 id=terminal_emulator ><a href="#terminal_emulator" class=header-anchor >Terminal emulator</a></h2> <p>On linux I was using <a href="https://github.com/kovidgoyal/kitty">kitty</a>, since it was one of the newer terminal emulators with GPU acceleration <sup id="fnref:whygpu"><a href="#fndef:whygpu" class=fnref >[2]</a></sup> and a somewhat stable daemon mode which allows multiple windows with the same instance. However on windows, I dabbled with a few windows based terminals like Windows Terminal, fluent terminal, wsltty, conemu, but eventually I switched to <a href="https://github.com/wez/wezterm">wezterm</a>. Despite being a more recent terminal it has all the features you would want from a terminal emulator:</p> <ul> <li><p>tabs and panes, such that you don&#39;t need tmux</p> <li><p>a multiplexing &#40;remote headless mode&#41;, such that you don&#39;t need tmux</p> <li><p>text copy mode with vi keybindings, such that you don&#39;t need tmux</p> <li><p>quick select, an hint mode to quickly select text objects from the scrollback</p> <li><p>default commands for new tabs</p> <li><p>Very good keymaps customization, apart the fact that you can&#39;t use Left/Right Shift/Ctrl/Alt as different modifiers.</p> </ul> <p>With Windows I also modified my workflow a bit such that I don&#39;t need a terminal with daemon mode that supports multiple separate windows, by using a dropdown terminal. To make wezterm <em>drop down</em> after tried many drop-down AHK scripts, eventually I found <a href="https://github.com/lonepie/mintty-quake-console">one</a> that worked fairly well. A better alternative however would be <a href="https://github.com/flyingpie/windows-terminal-quake">windows-terminal-quake</a>, but I have had problem with it misbehaving with the virtual desktops managed by dexpot, whereas mitty-quake-console seems to be compatible with dexpot virtual desktops. Most likely when the built-in Windows virtual desktops experience improves, I will switch to windows-terminal-quake. WezTerm is also cross-platform which means, I can keep using it with a native linux installation. It has been a really fortunate finding for this Windows&#43;WSL switch, since Kitty doesn&#39;t yet support Windows, and the other terminal alternatives, had some failry major annoyances that <em>I couldn&#39;t come to terms with</em>.</p> <p><table class=fndef  id="fndef:AHK"> <tr> <td class=fndef-backref ><a href="#fnref:AHK">[1]</a> <td class=fndef-content >AutoHotKey </table> <table class=fndef  id="fndef:whygpu"> <tr> <td class=fndef-backref ><a href="#fnref:whygpu">[2]</a> <td class=fndef-content >why again do I need gpu acceleration in the terminal? </table> </p> <div class=page-foot > <div class=copyright > June 05, 2021 </div> <script src="https://utteranc.es/client.js" repo="untoreh/untoreh.github.io" issue-term=pathname  label=Comment  crossorigin=anonymous  async> </script> </div> </div><div class=page__footer > <footer> <div class=page__footer-copyright > © untoreh - Powered by <a href= "https://github.com/tlienart/Franklin.jl">Franklin</a> </div> <div class=page__footer-links > - <ul> <li> <a href="/sitemap.xml">Sitemap</a> | <li> <a href="/tag">Tags</a> | <li> <a href="/feed.xml">RSS</a> </ul> </div> <ul class=author__wrap > <li class="author__urls social-icons"> <a href="https://twitter.com/untoreh" rel= "nofollow noopener noreferrer"><i class= "fab fa-fw fa-twitter-square" aria-hidden=true ></i></a> <li class="author__urls social-icons"> <a href="https://github.com/untoreh" rel= "nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden=true ></i></a> <li class="author__urls social-icons"> <a href="mailto:contact@unto.re"><i class= "fas fa-envelope"></i></a> <li class="author__place hvr-buzz-out"><script type="application/ld+json">{"homeLocation":{"addressCountry":"IT","addressRegion":"Apulia","@type":"https://schema.org/Place"}}</script> <div class="author__bio .hvr-bubble-float-top"> I am Francesco Giannelli. The website «unto.re» is the place where I put stuff I should remember...or forget. Located in south italy. Born in the early nineties. </div><a rel="nofollow noopener noreferrer" href= "https://goo.gl/maps/E3Si7WzG4LX7wpNJ6" target=_blank ><i class= "fas fa-fw fa-map-marker-alt" aria-hidden=true ></i>italy</a> <li><script type="application/ld+json">{"potentialAction":{"query-input":"required maxlength=100 name=query","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":"https://unto.re/search?&q={query}"}}</script> </ul> </footer> </div> <script defer src= "https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity= "sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin=anonymous ></script> <script src="/libs/colors.js"></script> <script src="/libs/menu.js"></script> <script defer src="/libs/lunr/lunr.min.js"></script>