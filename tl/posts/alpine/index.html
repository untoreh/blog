<!DOCTYPE html><HTML lang=en ><meta charset=UTF-8 /><script type="application/ld+json">{"copyrightHolder":"untoreh","@id":"https://unto.re","url":"https://unto.re","copyrightYear":2021,"@context":"https://schema.org/","@type":"WebSite"}</script><script type="application/ld+json">{"audience":"cool people","url":"https://unto.re/posts/alpine/index.html","mainContentOfPage":{"@type":"WebPageElement","cssSelector":".franklin-content"},"accessMode":["textual","visual"],"accessibilitySummary":"Visual elements are tentatively described.","author":"untoreh","description":"Pine, Alpine linux based on OSTree","mentions":[],"accessModeSufficient":{"itemListElement":["textual","visual"],"description":"text and images","@type":"itemList"},"lastReviewed":"April 19, 2021","@type":"https://schema.org/WebPage","dateCreated":"April 24, 2021","@id":"https://unto.re/posts/alpine/index.html","dateModified":"April 19, 2021","abstract":"Pine, Alpine linux based on OSTree","headline":"Alpine","creativeWorkStatus":"Published","availableLanguage":[{"name":"English","@type":"Language"},{"name":"German","@type":"Language"},{"name":"Italian","@type":"Language"},{"name":"Mandarin Chinese","@type":"Language"},{"name":"Spanish","@type":"Language"},{"name":"Hindi","@type":"Language"},{"name":"Arabic","@type":"Language"},{"name":"Portuguese","@type":"Language"},{"name":"Bengali","@type":"Language"},{"name":"Russian","@type":"Language"},{"name":"Japanese","@type":"Language"},{"name":"Punjabi","@type":"Language"},{"name":"Javanese","@type":"Language"},{"name":"Vietnamese","@type":"Language"},{"name":"French","@type":"Language"},{"name":"Urdu","@type":"Language"},{"name":"Turkish","@type":"Language"},{"name":"Polish","@type":"Language"},{"name":"Ukranian","@type":"Language"},{"name":"Dutch","@type":"Language"},{"name":"Greek","@type":"Language"},{"name":"Swedish","@type":"Language"},{"name":"Zulu","@type":"Language"},{"name":"Romanian","@type":"Language"},{"name":"Malay","@type":"Language"},{"name":"Korean","@type":"Language"},{"name":"Thai","@type":"Language"},{"name":"Filipino","@type":"Language"}],"keywords":["tools","about"],"datePublished":"April 24, 2021","inLanguage":"English","name":"Alpine","identifier":"https://unto.re/posts/alpine/index.html"}</script><meta content="width=device-width, initial-scale=1" name=viewport /><link href="/css/franklin.css" rel=stylesheet /><link href="/css/main.css" rel=stylesheet /><link href="/css/menu.css" rel=stylesheet /><link href="/css/pages.css" rel=stylesheet /><link href="/css/lunr.css" rel=stylesheet /><link href="/css/footer.css" rel=stylesheet /><link href="/css/responsive.css" rel=stylesheet /><link href="/css/animations.css" rel=stylesheet /><link href="/css/docco.css" rel=stylesheet /><link href="/css/flag-icon.min.css" rel=stylesheet /><link href="/assets/favicon.png" rel=icon /><title> Alpine</title><script src="/libs/lunr/lunr.min.js"></script><script src="/libs/lunr/lunr_index.js"></script><script src="/libs/lunr/lunrclient.min.js"></script><script src="/libs/load.js"></script><script type="application/ld+json">{"@id":"https://unto.re/tl/posts/alpine/index.html","url":"https://unto.re/tl/posts/alpine/index.html","abstract":null,"headline":null,"keywords":null,"description":null,"mentions":null,"translator":{"url":"https://translate.google.com/","name":"Google","@type":"https://schema.org/Organization"},"translationOfWork":{"@id":"/home/fra/dev/blog/https://unto.re/"},"inLanguage":"tl","name":null,"@type":"https://schema.org/WebPage"}</script><body class=""><div class=masthead ><div class=masthead__inner-wrap ><div class=masthead__menu ><a class=site-title href="/tl/"></a><div class=author__wrap ><script type="application/ld+json">{"sameAs":["https://github.com/untoreh","https://twitter.com/untoreh"],"description":"<ul>\n<li><p><strong>Name</strong>: Francesco Giannelli</p>\n\n<li><p><strong>Website</strong>: &#91;«https://unto.re»&#93;, the place where I put stuff I should remember...or forget</p>\n\n<li><p><strong>Location</strong>: south italy {{bio_link}}</p>\n\n<li><p><strong>Year</strong>: &#39;91</p>\n\n</ul>\n","image":"/assets/appa.png","name":"untoreh","@type":"https://schema.org/Person","email":"contact@unto.re"}</script><ul><li class=author__avatar onclick="toggleTheme()"><img alt=" untoreh-light" class=flip-front src="/assets/appa.png"/><li class="author__urls social-icons"><a href="https://twitter.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden=true class="fab fa-fw fa-twitter-square"></i></a><li class="author__urls social-icons"><a href="https://github.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden=true class="fab fa-fw fa-github"></i></a><li class="author__urls social-icons"><a href="mailto:contact@unto.re"><i class="fas fa-envelope"></i></a><li><script type="application/ld+json">{"potentialAction":{"query-input":"required maxlength=100 name=query","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":"https://unto.re/search?&q={query}"}}</script></ul></div><nav id=site-nav ><div class=horiz ><ul><li class="masthead__menu-item hvr-outline-in" id=lunrSearch ><form id=lunrSearchForm name=lunrSearchForm ><button class=search-button formaction="/search/index.html" type=submit value=Search ><i class="fas fa-search menu-icons"></i></button><input class=search-input name=q placeholder="Search…" type=text /></form><li class="masthead__menu-item hvr-outline-in"><a href="/tl/posts/" title="All the articles that I have written"><i class="fas fa-pen menu-icons"></i> mga post</a><li class="masthead__menu-item hvr-outline-in"><a href="/tl/about/" title="Things about me, what I have read, past projects and ideas for future ones"><i class="fas fa-user-alt menu-icons"></i> tungkol sa</a><li class="masthead__menu-item hvr-outline-in menu-lang-btn" title="Change website&#39;s language"><button class=langs-dropdown-wrapper ><i class="fas fa-language menu-icons"></i> Lang <div class=langs-dropdown-content id=langs-dropdown-menu ><ul id=lang-list ><a class=lang-link href="/ar/posts/alpine" id=lang-ar ><span class="flag-icon flag-icon-sa"></span> Arabe</a><a class=lang-link href="/tl/bn/posts/alpine" id=lang-bn ><span class="flag-icon flag-icon-bd"></span> Bengali</a><a class=lang-link href="/tl/nl/posts/alpine" id=lang-nl ><span class="flag-icon flag-icon-nl"></span>Dutch</a><a class=lang-link href="/tl/en/posts/alpine" id=lang-en ><span class="flag-icon flag-icon-gb"></span> Ingles</a><a class=lang-link href="/tl/tl/posts/alpine" id=lang-tl ><span class="flag-icon flag-icon-ph"></span> Pilipino</a><a class=lang-link href="/tl/fr/posts/alpine" id=lang-fr ><span class="flag-icon flag-icon-fr"></span> Pranses</a><a class=lang-link href="/tl/de/posts/alpine" id=lang-de ><span class="flag-icon flag-icon-de"></span> Aleman</a><a class=lang-link href="/tl/el/posts/alpine" id=lang-el ><span class="flag-icon flag-icon-gr"></span> Griyego</a><a class=lang-link href="/tl/hi/posts/alpine" id=lang-hi ><span class="flag-icon flag-icon-in"></span> Hindi</a><a class=lang-link href="/tl/it/posts/alpine" id=lang-it ><span class="flag-icon flag-icon-it"></span> Italyano</a><a class=lang-link href="/tl/ja/posts/alpine" id=lang-ja ><span class="flag-icon flag-icon-jp"></span> Japanese</a><a class=lang-link href="/tl/jw/posts/alpine" id=lang-jw ><span class="flag-icon flag-icon-id"></span> Java</a><a class=lang-link href="/tl/ko/posts/alpine" id=lang-ko ><span class="flag-icon flag-icon-kr"></span> Koreano</a><a class=lang-link href="/tl/ms/posts/alpine" id=lang-ms ><span class="flag-icon flag-icon-ms"></span> Malay</a><a class=lang-link href="/tl/zh/posts/alpine" id=lang-zh ><span class="flag-icon flag-icon-cn"></span> Mandarin na Tsino</a><a class=lang-link href="/tl/pl/posts/alpine" id=lang-pl ><span class="flag-icon flag-icon-pl"></span> Polish</a><a class=lang-link href="/tl/pt/posts/alpine" id=lang-pt ><span class="flag-icon flag-icon-pt"></span> Portuges</a><a class=lang-link href="/tl/pa/posts/alpine" id=lang-pa ><span class="flag-icon flag-icon-in"></span> Punjabi</a><a class=lang-link href="/tl/ro/posts/alpine" id=lang-ro ><span class="flag-icon flag-icon-ro"></span> Romaniano</a><a class=lang-link href="/tl/ru/posts/alpine" id=lang-ru ><span class="flag-icon flag-icon-ru"></span> Russian</a><a class=lang-link href="/tl/es/posts/alpine" id=lang-es ><span class="flag-icon flag-icon-es"></span> Kastila</a><a class=lang-link href="/tl/sv/posts/alpine" id=lang-sv ><span class="flag-icon flag-icon-se"></span> Suweko</a><a class=lang-link href="/tl/th/posts/alpine" id=lang-th ><span class="flag-icon flag-icon-th"></span> Thai</a><a class=lang-link href="/tl/tr/posts/alpine" id=lang-tr ><span class="flag-icon flag-icon-tr"></span> Turko</a><a class=lang-link href="/tl/uk/posts/alpine" id=lang-uk ><span class="flag-icon flag-icon-ua"></span> Ukranian</a><a class=lang-link href="/tl/ur/posts/alpine" id=lang-ur ><span class="flag-icon flag-icon-pk"></span> Urdu</a><a class=lang-link href="/tl/vi/posts/alpine" id=lang-vi ><span class="flag-icon flag-icon-vn"></span> Vietnamese</a><a class=lang-link href="/tl/zu/posts/alpine" id=lang-zu ><span class="flag-icon flag-icon-za"></span> Zulu</a></ul></div></button></ul></div><button class=ham ><i class="fas fa-bars ham-icon"></i></button><div class=vert ><ul><li class="masthead__menu-item hvr-outline-in" id=lunrSearch ><form id=lunrSearchForm name=lunrSearchForm ><button class=search-button formaction="/search/index.html" type=submit value=Search ><i class="fas fa-search menu-icons"></i></button><input class=search-input name=q placeholder="Search…" type=text /></form><li class="masthead__menu-item hvr-outline-in"><a href="/tl/posts/" title="All the articles that I have written"><i class="fas fa-pen menu-icons"></i> mga post</a><li class="masthead__menu-item hvr-outline-in"><a href="/tl/about/" title="Things about me, what I have read, past projects and ideas for future ones"><i class="fas fa-user-alt menu-icons"></i> tungkol sa</a><li class="masthead__menu-item hvr-outline-in menu-lang-btn" title="Change website&#39;s language"><button class=langs-dropdown-wrapper ><i class="fas fa-language menu-icons"></i> Lang <div class=langs-dropdown-content id=langs-dropdown-menu ><ul id=lang-list ><a class=lang-link href="/ar/posts/alpine" id=lang-ar ><span class="flag-icon flag-icon-sa"></span> Arabe</a><a class=lang-link href="/tl/bn/posts/alpine" id=lang-bn ><span class="flag-icon flag-icon-bd"></span> Bengali</a><a class=lang-link href="/tl/nl/posts/alpine" id=lang-nl ><span class="flag-icon flag-icon-nl"></span>Dutch</a><a class=lang-link href="/tl/en/posts/alpine" id=lang-en ><span class="flag-icon flag-icon-gb"></span> Ingles</a><a class=lang-link href="/tl/tl/posts/alpine" id=lang-tl ><span class="flag-icon flag-icon-ph"></span> Pilipino</a><a class=lang-link href="/tl/fr/posts/alpine" id=lang-fr ><span class="flag-icon flag-icon-fr"></span> Pranses</a><a class=lang-link href="/tl/de/posts/alpine" id=lang-de ><span class="flag-icon flag-icon-de"></span> Aleman</a><a class=lang-link href="/tl/el/posts/alpine" id=lang-el ><span class="flag-icon flag-icon-gr"></span> Griyego</a><a class=lang-link href="/tl/hi/posts/alpine" id=lang-hi ><span class="flag-icon flag-icon-in"></span> Hindi</a><a class=lang-link href="/tl/it/posts/alpine" id=lang-it ><span class="flag-icon flag-icon-it"></span> Italyano</a><a class=lang-link href="/tl/ja/posts/alpine" id=lang-ja ><span class="flag-icon flag-icon-jp"></span> Japanese</a><a class=lang-link href="/tl/jw/posts/alpine" id=lang-jw ><span class="flag-icon flag-icon-id"></span> Java</a><a class=lang-link href="/tl/ko/posts/alpine" id=lang-ko ><span class="flag-icon flag-icon-kr"></span> Koreano</a><a class=lang-link href="/tl/ms/posts/alpine" id=lang-ms ><span class="flag-icon flag-icon-ms"></span> Malay</a><a class=lang-link href="/tl/zh/posts/alpine" id=lang-zh ><span class="flag-icon flag-icon-cn"></span> Mandarin na Tsino</a><a class=lang-link href="/tl/pl/posts/alpine" id=lang-pl ><span class="flag-icon flag-icon-pl"></span> Polish</a><a class=lang-link href="/tl/pt/posts/alpine" id=lang-pt ><span class="flag-icon flag-icon-pt"></span> Portuges</a><a class=lang-link href="/tl/pa/posts/alpine" id=lang-pa ><span class="flag-icon flag-icon-in"></span> Punjabi</a><a class=lang-link href="/tl/ro/posts/alpine" id=lang-ro ><span class="flag-icon flag-icon-ro"></span> Romaniano</a><a class=lang-link href="/tl/ru/posts/alpine" id=lang-ru ><span class="flag-icon flag-icon-ru"></span> Russian</a><a class=lang-link href="/tl/es/posts/alpine" id=lang-es ><span class="flag-icon flag-icon-es"></span> Kastila</a><a class=lang-link href="/tl/sv/posts/alpine" id=lang-sv ><span class="flag-icon flag-icon-se"></span> Suweko</a><a class=lang-link href="/tl/th/posts/alpine" id=lang-th ><span class="flag-icon flag-icon-th"></span> Thai</a><a class=lang-link href="/tl/tr/posts/alpine" id=lang-tr ><span class="flag-icon flag-icon-tr"></span> Turko</a><a class=lang-link href="/tl/uk/posts/alpine" id=lang-uk ><span class="flag-icon flag-icon-ua"></span> Ukranian</a><a class=lang-link href="/tl/ur/posts/alpine" id=lang-ur ><span class="flag-icon flag-icon-pk"></span> Urdu</a><a class=lang-link href="/tl/vi/posts/alpine" id=lang-vi ><span class="flag-icon flag-icon-vn"></span> Vietnamese</a><a class=lang-link href="/tl/zu/posts/alpine" id=lang-zu ><span class="flag-icon flag-icon-za"></span> Zulu</a></ul></div></button></ul></div></nav></div></div></div><div><h1 id=title ><a href="/tl/posts/alpine"> Alpine</a></h1><blockquote id=page-description style="font-style: italic;"> Pine, Alpine linux batay sa OSTree </blockquote></div><div class=franklin-content ><p> Pagpili ng ano<a href="https://en.wikipedia.org/wiki/Operating_system"> OS</a> tumatakbo sa iyong mga server ay isang bagay ng kaginhawaan at pamilyar. Nangangahulugan ang kaginhawaan na nais mo ang isang bagay na magbibigay sa iyo ng mas kaunting mga problema hangga't maaari, nangangahulugan ang pamilyar na mas gugustuhin mo<em> hindi</em> upang malaman ang karagdagang mga bagay kung hindi mo na kailangan.</p><p> Ang aking mga server ay<a href="https://devops.stackexchange.com/questions/653/what-is-the-definition-of-cattle-not-pets"> mga alaga</a>kaya't ako ay ok na manu-manong naglalabas ng ilang mga utos bawat minsan, at hindi nangangailangan ng kumpletong awtomatiko.</p><p> Matapos subukan<a href="https://en.wikipedia.org/wiki/Container_Linux"> CoreOS</a> sa loob ng isang taon lumipat ako sa sarili kong pinasimple<a href="https://en.wikipedia.org/wiki/Linux_distribution"> distro</a> batay sa alpine at<a href="https://en.wikipedia.org/wiki/OSTree"> ostree</a>.</p><h2 id=goals ><a class=header-anchor href="#goals"> Mga Layunin</a></h2><p> Ang bersyon ng alpine na ito ay kumukuha ng mga pahiwatig mula sa<a href="https://kinvolk.io/flatcar-container-linux/"> flatcar</a> at<a href="https://www.projectatomic.io/"> proyekto-atomic</a> at dapat na mai-install bilang isang read-only root file-system na may mga pag-update na nagaganap ng atomiko, iyon ay, alinman sa kanilang pagtagumpay o ang system ay nagpapalit pabalik sa nakaraang estado. Para ito ay posible upang ang system ay dapat laging magkaroon ng kahit man lang<strong> dalawang snapshot</strong> ng inilabas na bersyon ng file-system, magagamit sa imbakan.</p><h2 id=targets ><a class=header-anchor href="#targets"> Mga Target</a></h2><p> Sa anong mga kapaligiran tatakbo ang system? Target ko<a href="https://en.wikipedia.org/wiki/OpenVZ"> OVZ</a> at [KVM], ngunit sa pangkalahatan maaari mong sabihin<em> mga lalagyan</em> at<em> virtual machine</em> kasama ang pangunahing pagkakaiba na ang mga lalagyan ay hindi nagpapatakbo ng kanilang sariling kernel, sa partikular wala silang proseso ng boot, direkta silang tumawag sa<em> sa loob</em> system (na halimbawa sa a<code><a href="https://en.wikipedia.org/wiki/Docker_(software)">Dockerfile</a></code> ito ay tukuyin ng<code>CMD</code> o<code>ENTRYPOINT</code> pahayag), na responsable upang pamahalaan ang puno ng mga prcesses na panatilihin ang lalagyan na lalagyan (tulad ng isang normal na sesyon, kung ang proseso ng init ay namatay, ang lalagyan ay natapos). Ang mga lalagyan din ay hindi maaaring i-configure ang mga knob ng system, at maaaring magkaroon ng mga karagdagang paghihigpit sa mga kakayahan.</p><h2 id=bisecting_the_build_process ><a class=header-anchor href="#bisecting_the_build_process"> Bisecting ang proseso ng pagbuo</a></h2><p> Paano binuo ang imahe?</p><h3 id=dependencies ><a class=header-anchor href="#dependencies"> Mga dependency</a></h3><p> Ang<code>prepare.sh</code> pinangangasiwaan ng script ang mga dependency, karamihan sa mga ito ay ang mga pakete upang mag-alok ng mga karaniwang kasangkapan tulad<code>coreutils</code>, <code>util-linux</code>, <code>binutils</code> , mga utility upang mapatakbo sa mga block device tulad ng<code>blkid</code>, <code>sfdisk</code>, <code>multipath-tools</code> at mga file system na may<code>xfsprogs</code> at<code>e2fsprogs</code> . Ang<code>squashfs-tools</code> ang pakete ay ginagamit sa dulo upang i-compress ang built system ng root file. A<code>glib</code> ang package ng pagiging tugma ay naka-install din bilang default sapagkat ang alpine ay batay sa<code><a href="https://musl.libc.org/">musl</a></code>, gumagana ang package sa pagiging tugma sa pamamagitan ng pagbibigay ng ilang mga aklatan na binuo laban.</p><h3 id=the_tree ><a class=header-anchor href="#the_tree"> Ang puno</a></h3><p> Ang mga puno ng file para sa parehong VM at lalagyan ay binubuo ayon sa pagkakabanggit<code>make.sh</code> at<code>make_ovz.sh</code> . Ito ay isang pinasimple na paglalarawan ng mga hakbang</p><ul><li><p> itakda ang bersyon na itatayo alinsunod sa tag ng repository</p><li><p> lumikha ng isang direktoryo para sa bagong puno at limasin ang kapaligiran</p><li><p> lumikha ng mga base target na direktoryo at direktoryo na kinakailangan ng ostree, tulad ng<code>sysroot</code></p><li><p> lumikha ng mga symlink upang sumunod sa<a href="https://www.freedesktop.org/software/systemd/man/file-hierarchy.html"> pamantayan ng hierarchy ng filesystem</a></p><li><p> kopyahin ang mga pasadyang serbisyo at pasadyang mga config</p><li><p> pag-setup ng chroot na may mga naka-mount na direktoryo ng system</p><li><p> bootstrap isang alpine rootfs na may mga base package</p><li><p> maglapat ng kaunting pagsasaayos sa mga rootf tulad ng mga kredensyal, timezone, hostname.</p><li><p> kopyahin ang mga serbisyo upang masimulan sa pamamagitan ng init</p><li><p> i-setup ang pagsasaayos ng boot sa tinukoy na imahe ng kernel</p><li><p> opsyonal na magdagdag ng mga pasadyang module ng kernel</p><li><p> magsagawa ng paglilinis</p><li><p> gawin ang mga rootf<sup id="fnref:rootfs"><a class=fnref href="#fndef:rootfs">[1]</a></sup> sa ostree repository</p></ul><p> Para sa mga lalagyan, pareho ang pagkakasunud-sunod, ngunit nagbabago ang pagsasaayos, dahil sa isang system na hindi na-boot mula sa a<a href="https://en.wikipedia.org/wiki/Bootloader"> bootloader</a> Ang ostree ay may mga problema sa pag-verify sa kapaligiran, kailangan naming mag-apply ng ilan<a href="https://github.com/untoreh/pine/blob/e65f12be70fd91edfd935e3ae9854c7be555ec73/make_ovz.sh#L73"> mga workaround</a> at pag-set up ng ilang mga aparato na karaniwang hawakan ng<a href="https://en.wikipedia.org/wiki/Initial_ramdisk"> initramfs</a> hakbang Ganito<a href="https://en.wikipedia.org/wiki/OpenVZ"> OVZ</a> o<a href="https://en.wikipedia.org/wiki/LXC"> LXC</a> naka-configure ang mga template.</p><h3 id=packaging ><a class=header-anchor href="#packaging"> Pagbalot</a></h3><p> Sa sandaling mayroon kaming aming ostree nakatuong mga file ng puno<code>build.sh</code> o<code>build-update.sh</code> nangangalaga sa paggawa ng artifact na ibabahagi. Ang pagkakaiba sa pagitan ng mga script ay ang bersyon ng pag-update ay nagsisimula mula sa isang nakaraang imbakan ng ostree, at<em> din</em> gumagawa ng isang delta artifact na maaaring mailapat ng isang tumatakbo na system sa kanyang halimbawa ng halimbawa upang magsagawa ng mga pag-upgrade. Ito ay isang pinasimple na paglalarawan ng mga hakbang sa pagbuo</p><ul><li><p> kung bagong build</p><ul><li><p>lumikha ng mga bagong partisyon sa isang bagong imahe na naka-mount bilang isang loop aparato</p></ul><li><p> iba pa</p><ul><li><p> i-mount ang sysroot at i-boot ang mga partisyon ng nakaraang pagbuo</p></ul><li><p> linisin ang mga nakaraang pag-deploy ng ostree (link farms) sa naka-mount na build</p><li><p> gumawa ng bagong built na puno sa naka-mount na build</p><li><p> i-verify ang integridad at mga check check</p><li><p> lumikha ng bagong delta para sa mga pag-upgrade</p><li><p> magpatupad ng ostree deploy upang muling makabuo ng pagsasaayos ng boot</p><li><p> tanggalin ang mga lumang ostree commits</p><li><p> i-verify ang integridad ng boot partition</p><li><p> i-unmount ang bagong na-update na imahe ng build</p><li><p> bumuo ng imahe ng tsekum at i-compress ito (na may<code>squashfs</code> para sa mga lalagyan)</p></ul><p> Ang pagsasaayos ng mga partisyon ay inilalapat gamit ang isang maliit na salapi<code>layout.cfg</code> file na tumutukoy sa mga laki ng pagkahati, mayroon kaming isang pagkahati para sa mga rootfs (<code>~430M</code> ), ang partisyon ng boot (<code>~40M</code> ) at isang partisyon ng pagpapalit (<code>~40M</code> ). Sa mga lalagyan na may laktawan lamang ang pag-mount ang nakaraang build sa isang loop device, at hilahin lamang ang bagong ostree na gumawa sa luma (na-extract) na ostree repository.</p><h2 id=customizations ><a class=header-anchor href="#customizations"> Mga pagpapasadya</a></h2><p> Ano ang binubuo ko sa imaheng ito (bukod sa mga naka-install na package)?</p><ul><li><p> Isang maliit na lib in<code>functions.sh</code> para sa mga karaniwang gawain na naisakatuparan sa loob ng shell</p><li><p> ostree batay sa pag-upgrade ng mga script na may mekanismo ng pagla-lock batay sa KV store</p><li><p> pagsubaybay ng mga script para sa IO parehong lokal (<code>iomon</code> ) at network (<code>tcpmon</code>)</p><li><p> mga script ng pag-setup para sa mga runtime ng container maliban sa<code>bubblewrap</code>: <code>podman</code>, <code>toolbox</code></p></ul><p> Kung ano ang dati at wala na</p><ul><li><p><code>sup</code>: <a href="https://github.com/pressly/sup/"> Sinabi ni Sup</a> ay ginamit para sa orchestration (deploy container) at pagsasaayos ng host machine, ngunit pagkatapos ay lumipat ako sa<a href="https://www.ansible.com/"> hindi nakakain</a> dahil may matagal nang nakatayo na mga bug sa sup na kulang sa isang pag-aayos, hindi ako pumili ng nakakain mula sa simula dahil hindi ko nais na mai-install ang isang dependant na sawa sa bawat server, kalaunan ay nakipag-ayos ako sa isang pangalawang alpine<a href="https://en.wikipedia.org/wiki/Chroot"> chroot</a> sa mga host machine, na matatagpuan sa<code>/opt/alp</code>Nag-install ba ako ng karagdagang hindi gaanong kritikal na software. Ngayon, subalit, lilipat ulit ako mula sa hindi nakakain hanggang sa<a href="https://github.com/Fizzadar/pyinfra"> pyinfra</a> , kasi</p><ul><li><p> ito ay sawa na walang boilerplate (ansible ay may pseudo<code>DSL</code> na sanhi ng mas maraming sakit ng ulo kaysa sa mga nalulutas nito)</p><li><p> isinasagawa nito ang mga resipe nito na may payak na mga utos ng ssh, kaya walang isang kinakailangan sa pagtitiwala sawa sa mga target na host</p></ul><li><p><code>containerpilot</code> : Ang kaso ng paggamit para sa lalagyan ng piloto ay upang pamahalaan ang mga kumplikadong pagtitiwala sa pagitan ng mga lalagyan nang walang mga script ng shell ... tumigil ito sa pagkuha ng mga pag-update<a href="https://github.com/joyent/containerpilot"> nagagalak</a> at inilagay sa mode ng pagpapanatili, hindi ko rin gusto ang mga kinakailangan sa memorya at ang paggamit ng memorya ay mangyayari na patuloy na tataas para sa mahabang panahon ng uptime. Inilipat ko ito para sa mga simpleng shell script<a href="https://www.consul.io/"> konsul</a> , Maaari akong tumingin sa mas tamang mga kahalili kung ang mga script ng shell ay nagsisimulang lumaki nang labis. Mas mabibigat na mga solusyon tulad ng<a href="https://kubernetes.io/"> kubernetes</a>, <a href="https://docs.docker.com/engine/swarm/"> dumapo</a> o<a href="https://www.nomadproject.io/"> palad</a> ay itinapon mula sa get-go.</p><li><p><code>beegfs</code> : Dati pinadala ko ang kernel module na kinakailangan para sa<a href="https://en.wikipedia.org/wiki/BeeGFS"> beegf</a> ngunit pagkatapos ng ilang sandali ay sinira nito ang pagiging tugma, at ang katunayan na walang maayos na sinusuportahan<a href="https://en.wikipedia.org/wiki/Filesystem_in_Userspace"> piyus</a> Ang modyul na ginawa ay i-drop ito nang kabuuan, kasalukuyang hindi ako nagpapatakbo ng isang [DFS] sa aking mga server, ngunit ang posibilidad na magkaroon ng isang handa na pumunta file-system upang mai-plug sa isang network ay nakakaakit pa rin.</p><li><p></p></ul><h2 id=installation ><a class=header-anchor href="#installation"> Pag-install</a></h2><p>Upang mai-install ang imahe maaari mong i-upload ito sa provider ng pagho-host at mai-install mula sa VNC, sa kaso ng mga virtual machine, ngunit karaniwan kong hijack ang isang mayroon nang pag-install, sapagkat ito ay laging posible, pati na't nasubukan ko ang setup script laban sa bersyon ng ang pamamahagi ng linux, sa pangkalahatan ay gumagamit ako ng debian-8 o ubuntu-14, hindi pa nasubukan ang iba pa dahil ang mga ito ay palagi kong nahanap na magagamit ang mga ito. Ang mga hakbang sa pag-setup ay sumusunod</p><ul><li><p> matiyak na suporta sa https para sa mga pag-download</p><li><p> mag-download ng isang bersyon ng busybox</p><li><p> mag-install ng isang busybox link-farm</p><li><p> tukuyin ang mga ipv4 / ipv6 address para sa config ng network</p><li><p> tiyakin ang mga kakayahan ng chroot</p><li><p> i-download ang imahe ng pine at i-extract ito</p><li><p> kung si VM</p><ul><li><p> i-flash ang target na aparato</p><li><p> i-mount sa isang loop aparato</p></ul><li><p> isulat ang lokal na pagsasaayos ng network sa<em> upang mai-flash</em> rootfs</p><li><p> kung lalagyan</p><ul><li><p> kopyahin ang init service (para sa mga lalagyan) sa pangunahing root mount point<code>/sbin/init</code></p></ul><li><p> kung si VM</p><ul><li><p> hatiin ang natitirang disk na may pamantayan (<code>xfs</code> ) mga partisyon</p><li><p> matalo</p><li><p> i-verify ang integridad ng mga partisyon</p></ul><li><p> i-reboot</p></ul><h2 id=conclusions ><a class=header-anchor href="#conclusions"> Konklusyon</a></h2><p> Gumawa ako<a href="https://github.com/untoreh/pine"> pine</a> 5 years from time of writing and I am still using it, and I see no reasons to switch to anything else. Alpine as a linux distro is great, simple, and I have never experienced breakage. I can easily deploy on <a href="https://en.wikipedia.org/wiki/Network_address_translation"> NATED</a> ang mga server na may posibilidad na mag-alok ng mga ultra-mababang mapagkukunan, talagang mayroon akong isang kahon na tumatakbo sa lamang<code>64M</code> ng RAM, at mayroon pa ring lahat ng mga tampok na kailangan ko.</p><p></p><table class=fndef id="fndef:rootfs"><tr><td class=fndef-backref ><a href="#fnref:rootfs">[1]</a><td class=fndef-content > root file system</table><p></p><div id=post-tags-list > Mag-post ng Mga Tag: <span class=post-tag ><a href="/tl/posts/tag/tools" style=""> mga kasangkapan</a>, </span><span class=post-tag ><a href="/tl/posts/tag/about" style=""> tungkol sa</a></span></div><div class=page-foot ><div class=copyright > Abril 19, 2021 </div><script async="" crossorigin=anonymous issue-term=pathname label=Comment repo="untoreh/untoreh.github.io" src="https://utteranc.es/client.js"></script></div></div><div class=page__footer ><footer><div class=page__footer-copyright > © untoreh - Pinapagana ng<a href="https://github.com/tlienart/Franklin.jl"> Franklin</a></div><div class=page__footer-links > - <ul><li><a href="/tl/sitemap.xml"> Sitemap</a> | <li><a href="/tl/tag"> Mga tag</a> | <li><a href="/tl/feed.xml"> RSS</a></ul></div><ul class=author__wrap ><li class="author__urls social-icons"><a href="https://twitter.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden=true class="fab fa-fw fa-twitter-square"></i></a><li class="author__urls social-icons"><a href="https://github.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden=true class="fab fa-fw fa-github"></i></a><li class="author__urls social-icons"><a href="mailto:contact@unto.re"><i class="fas fa-envelope"></i></a><li><script type="application/ld+json">{"potentialAction":{"query-input":"required maxlength=100 name=query","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":"https://unto.re/search?&q={query}"}}</script></ul></footer></div><script crossorigin=anonymous defer="" id=fa integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" src="https://use.fontawesome.com/releases/v5.8.2/js/all.js"></script><script src="/libs/colors.js"></script><script src="/libs/menu.js"></script><script defer="" src="/libs/lunr/lunr.min.js"></script></HTML>