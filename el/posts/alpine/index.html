<!doctypehtml><html prefix="og: https://ogp.me/ns# article: http://ogp.me/ns/article# website: http://ogp.me/ns/website#"lang=el><meta charset=UTF-8><meta content=width=device-width,initial-scale=1 name=viewport><link href=https://www.unto.re/el/posts/alpine/ rel=canonical><link title="ιστοσελίδα του untoreh"href=https://www.unto.re/feed.xml rel=alternate type=application/rss+xml><link href=https://www.unto.re/amp/el/posts/alpine/ rel=amphtml><meta content="untoreh's site"property=og:title><meta content=website property=og:type><meta content=https://www.unto.re property=og:url><meta content=https://www.unto.re/assets/appa.png property=og:image><meta content="Articles, logs, infos, status and live updates are published here."property=og:description><meta content=English property=og:locale><meta content=English property=og:locale:alternate><meta content=German property=og:locale:alternate><meta content=Italian property=og:locale:alternate><meta content="Mandarin Chinese"property=og:locale:alternate><meta content=Spanish property=og:locale:alternate><meta content=Hindi property=og:locale:alternate><meta content=Arabic property=og:locale:alternate><meta content=Portuguese property=og:locale:alternate><meta content=Bengali property=og:locale:alternate><meta content=Russian property=og:locale:alternate><meta content=Japanese property=og:locale:alternate><meta content=Punjabi property=og:locale:alternate><meta content=Javanese property=og:locale:alternate><meta content=Vietnamese property=og:locale:alternate><meta content=French property=og:locale:alternate><meta content=Urdu property=og:locale:alternate><meta content=Turkish property=og:locale:alternate><meta content=Polish property=og:locale:alternate><meta content=Ukranian property=og:locale:alternate><meta content=Dutch property=og:locale:alternate><meta content=Greek property=og:locale:alternate><meta content=Swedish property=og:locale:alternate><meta content=Zulu property=og:locale:alternate><meta content=Romanian property=og:locale:alternate><meta content=Malay property=og:locale:alternate><meta content=Korean property=og:locale:alternate><meta content=Thai property=og:locale:alternate><meta content=Filipino property=og:locale:alternate><meta content=summary name=twitter:card><meta content=@untoreh name=twitter:creator><script type=application/ld+json>{"copyrightHolder":"untoreh","@id":"https://www.unto.re","url":"https://www.unto.re","copyrightYear":2021,"@context":"https://schema.org/","image":"/assets/appa.png","@type":"WebSite"}</script><script id=ldj-webpage type=application/ld+json>{"audience":"cool people","url":"https://www.unto.re/posts/alpine/index.html","mainContentOfPage":{"@type":"WebPageElement","cssSelector":".franklin-content"},"accessMode":["textual","visual"],"accessibilitySummary":"Visual elements are tentatively described.","description":"Pine, Alpine linux based on OSTree","author":{"sameAs":["https://github.com/untoreh","https://twitter.com/untoreh"],"email":"contact@unto.re","name":"untoreh","@type":"https://schema.org/Person","image":"/assets/appa.png"},"mentions":[],"@context":"https://schema.org","accessModeSufficient":{"itemListElement":["textual","visual"],"@type":"itemList"},"@type":"https://schema.org/WebPage","lastReviewed":"2021-04-19","dateCreated":"April 24, 2021","@id":"https://www.unto.re/posts/alpine/index.html","dateModified":"2021-04-19","availableLanguage":[{"name":"English","@type":"Language"},{"name":"German","@type":"Language"},{"name":"Italian","@type":"Language"},{"name":"Mandarin Chinese","@type":"Language"},{"name":"Spanish","@type":"Language"},{"name":"Hindi","@type":"Language"},{"name":"Arabic","@type":"Language"},{"name":"Portuguese","@type":"Language"},{"name":"Bengali","@type":"Language"},{"name":"Russian","@type":"Language"},{"name":"Japanese","@type":"Language"},{"name":"Punjabi","@type":"Language"},{"name":"Javanese","@type":"Language"},{"name":"Vietnamese","@type":"Language"},{"name":"French","@type":"Language"},{"name":"Urdu","@type":"Language"},{"name":"Turkish","@type":"Language"},{"name":"Polish","@type":"Language"},{"name":"Ukranian","@type":"Language"},{"name":"Dutch","@type":"Language"},{"name":"Greek","@type":"Language"},{"name":"Swedish","@type":"Language"},{"name":"Zulu","@type":"Language"},{"name":"Romanian","@type":"Language"},{"name":"Malay","@type":"Language"},{"name":"Korean","@type":"Language"},{"name":"Thai","@type":"Language"},{"name":"Filipino","@type":"Language"}],"keywords":["tools","about"],"creativeWorkStatus":"Published","publisher":{"url":"https://www.unto.re","sameAs":["https://github.com/untoreh","https://twitter.com/untoreh"],"contactPoint":{"contactType":"info","email":"contact@unto.re","@type":"ContactPoint","telephone":""},"logo":"/assets/appa-60px.png","name":"untoreh's site","@type":"Organization"},"datePublished":"2021-04-19","inLanguage":"English","image":"/assets/appa.png","name":"","mainEntityOfPage":{"@id":"https://www.unto.re/posts/alpine/index.html","@type":"Article"}}</script><script id=ldj-breadcrumbs type=application/ld+json>{"itemListElement":[{"position":1,"item":"https://www.unto.re","name":"Home","@type":"ListItem"},{"position":2,"item":"/posts/","name":"Posts List","@type":"ListItem"},{"position":3,"item":"https://www.unto.re/posts/alpine","name":"Alpine","@type":"ListItem"}],"@type":"BreadcrumbList"}</script><link href=/css/franklin.css rel=stylesheet><link href=/css/main.css rel=stylesheet><link href=/css/menu.css rel=stylesheet><link href=/css/pages.css rel=stylesheet><link href=/css/lunr.css rel=stylesheet><link href=/css/footer.css rel=stylesheet><link href=/css/responsive.css rel=stylesheet><link href=/css/animations.css rel=stylesheet><link href=/css/docco.css rel=stylesheet><link href=/css/flags-sprite.css rel=stylesheet><link href=/assets/favicon.png rel=icon type=image/x-icon><link href=/assets/favicon.svg rel=icon type=image/svg+xml><title> αλπικός</title><meta content="Pine, Alpine linux based on OSTree"name=description><script src=/libs/load.js></script><script type=application/ld+json>{"url":"/el/posts/alpine/","mainContentOfPage":{"@type":"WebPageElement","cssSelector":".franklin-content"},"accessMode":["textual","visual"],"mentions":null,"description":"","@context":"https://schema.org","accessModeSufficient":{"itemListElement":["textual","visual"],"@type":"itemList"},"@type":"https://schema.org/WebPage","lastReviewed":"","dateCreated":"","@id":"/el/posts/alpine/","dateModified":"","keywords":[],"creativeWorkStatus":"Published","translator":{"url":"http://google.translate.com","name":"Google Translate","@type":"https://schema.org/Organization"},"translationOfWork":{"@id":"https://www.unto.re/posts/alpine/"},"datePublished":"2021-10-26T14:51:10.430","inLanguage":"el","name":"","mainEntityOfPage":{"@id":"/el/posts/alpine/","@type":"Article"}}</script><body><div class=masthead><div class=masthead__menu__inner-wrap><div class=masthead__menu><a title="untoreh's site"class=site-title href=/el/></a><div class=author__wrap><script type=application/ld+json>{"sameAs":["https://github.com/untoreh","https://twitter.com/untoreh"],"email":"contact@unto.re","name":"untoreh","@type":"https://schema.org/Person","image":"/assets/appa.png"}</script><ul><li class=author__avatar onclick=toggleTheme()><img alt=" ανοικτό φως"class=flip-front src=/assets/appa.png><li class="author__urls social-icons"><a rel="nofollow noopener noreferrer"title="Twitter link"href=https://twitter.com/untoreh><i class="fab fa-fw fa-twitter-square"aria-hidden=true></i></a><li class="author__urls social-icons"><a rel="nofollow noopener noreferrer"title="GitHub link"href=https://github.com/untoreh><i class="fab fa-fw fa-github"aria-hidden=true></i></a><li class="author__urls social-icons"><a href=mailto:contact@unto.re title=email><i class="fas fa-envelope"></i></a><li><script type=application/ld+json>{"potentialAction":{"query-input":"required maxlength=100 name=input","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":{"uri":"","scheme":"https","userinfo":"","host":"www.unto.re","port":"","path":"/search","query":"q=%7Binput%7D","fragment":""}}}</script></ul></div><nav id=site-nav><div class=horiz><ul><li class="lunrSearch masthead__menu-item hvr-outline-in"><form class=lunrSearchForm name=lunrSearchForm><button title="Αναζήτηση Ιστοτόπου"class=search-button formaction=/search/index.html value=Search><i class="fas fa-search menu-icons"></i></button><input class=search-input name=q placeholder=Search…></form><li class="masthead__menu-item hvr-outline-in"><a title="All the articles that I have written"href=/el/posts/><i class="fas fa-pen menu-icons"></i> αναρτήσεις</a><li class="masthead__menu-item hvr-outline-in"><a title="Video and audio content from streaming websites."href=/el/media/><i class="fas fa-tv menu-icons"></i> μεσο ΜΑΖΙΚΗΣ ΕΝΗΜΕΡΩΣΗΣ</a><li class="masthead__menu-item hvr-outline-in menu-lang-btn"title="Change website's language"><button title="Languages Menu"class=langs-dropdown-wrapper type=button><i class="fas fa-language menu-icons"></i> Lang <div class="langs-dropdown-content langs-dropdown-menu"><ul class=lang-list><a class="lang-link lang-ar"href=/ar/posts/alpine><span class="flag flag-sa"></span>Arabic</a><a class="lang-link lang-bn"href=/bn/posts/alpine><span class="flag flag-bd"></span>Bengali</a><a class="lang-link lang-nl"href=/nl/posts/alpine><span class="flag flag-nl"></span>Dutch</a><a class="lang-link lang-en"href=/posts/alpine><span class="flag flag-gb"></span>English</a><a class="lang-link lang-tl"href=/tl/posts/alpine><span class="flag flag-ph"></span>Filipino</a><a class="lang-link lang-fr"href=/fr/posts/alpine><span class="flag flag-fr"></span>French</a><a class="lang-link lang-de"href=/de/posts/alpine><span class="flag flag-de"></span>German</a><a class="lang-link lang-el"href=/el/posts/alpine><span class="flag flag-gr"></span>Greek</a><a class="lang-link lang-hi"href=/hi/posts/alpine><span class="flag flag-in"></span>Hindi</a><a class="lang-link lang-it"href=/it/posts/alpine><span class="flag flag-it"></span>Italian</a><a class="lang-link lang-ja"href=/ja/posts/alpine><span class="flag flag-jp"></span>Japanese</a><a class="lang-link lang-jw"href=/jw/posts/alpine><span class="flag flag-id"></span>Javanese</a><a class="lang-link lang-ko"href=/ko/posts/alpine><span class="flag flag-kr"></span>Korean</a><a class="lang-link lang-ms"href=/ms/posts/alpine><span class="flag flag-ms"></span>Malay</a><a class="lang-link lang-zh"href=/zh/posts/alpine><span class="flag flag-cn"></span>Mandarin Chinese</a><a class="lang-link lang-pl"href=/pl/posts/alpine><span class="flag flag-pl"></span>Polish</a><a class="lang-link lang-pt"href=/pt/posts/alpine><span class="flag flag-pt"></span>Portuguese</a><a class="lang-link lang-pa"href=/pa/posts/alpine><span class="flag flag-in"></span>Punjabi</a><a class="lang-link lang-ro"href=/ro/posts/alpine><span class="flag flag-ro"></span>Romanian</a><a class="lang-link lang-ru"href=/ru/posts/alpine><span class="flag flag-ru"></span>Russian</a><a class="lang-link lang-es"href=/es/posts/alpine><span class="flag flag-es"></span>Spanish</a><a class="lang-link lang-sv"href=/sv/posts/alpine><span class="flag flag-se"></span>Swedish</a><a class="lang-link lang-th"href=/th/posts/alpine><span class="flag flag-th"></span>Thai</a><a class="lang-link lang-tr"href=/tr/posts/alpine><span class="flag flag-tr"></span>Turkish</a><a class="lang-link lang-uk"href=/uk/posts/alpine><span class="flag flag-ua"></span>Ukranian</a><a class="lang-link lang-ur"href=/ur/posts/alpine><span class="flag flag-pk"></span>Urdu</a><a class="lang-link lang-vi"href=/vi/posts/alpine><span class="flag flag-vn"></span>Vietnamese</a><a class="lang-link lang-zu"href=/zu/posts/alpine><span class="flag flag-za"></span>Zulu</a></ul></div></button></ul></div><button name="Website Menu"class=ham type=button><i class="fas fa-bars ham-icon"></i></button><div class=vert><ul><li class="lunrSearch masthead__menu-item hvr-outline-in"><form class=lunrSearchForm name=lunrSearchForm><button title="Αναζήτηση Ιστοτόπου"class=search-button formaction=/search/index.html value=Search><i class="fas fa-search menu-icons"></i></button><input class=search-input name=q placeholder=Search…></form><li class="masthead__menu-item hvr-outline-in"><a title="All the articles that I have written"href=/el/posts/><i class="fas fa-pen menu-icons"></i> αναρτήσεις</a><li class="masthead__menu-item hvr-outline-in"><a title="Video and audio content from streaming websites."href=/el/media/><i class="fas fa-tv menu-icons"></i> μεσο ΜΑΖΙΚΗΣ ΕΝΗΜΕΡΩΣΗΣ</a><li class="masthead__menu-item hvr-outline-in menu-lang-btn"title="Change website's language"><button title="Languages Menu"class=langs-dropdown-wrapper type=button><i class="fas fa-language menu-icons"></i> Lang <div class="langs-dropdown-content langs-dropdown-menu"><ul class=lang-list><a class="lang-link lang-ar"href=/ar/posts/alpine><span class="flag flag-sa"></span>Arabic</a><a class="lang-link lang-bn"href=/bn/posts/alpine><span class="flag flag-bd"></span>Bengali</a><a class="lang-link lang-nl"href=/nl/posts/alpine><span class="flag flag-nl"></span>Dutch</a><a class="lang-link lang-en"href=/posts/alpine><span class="flag flag-gb"></span>English</a><a class="lang-link lang-tl"href=/tl/posts/alpine><span class="flag flag-ph"></span>Filipino</a><a class="lang-link lang-fr"href=/fr/posts/alpine><span class="flag flag-fr"></span>French</a><a class="lang-link lang-de"href=/de/posts/alpine><span class="flag flag-de"></span>German</a><a class="lang-link lang-el"href=/el/posts/alpine><span class="flag flag-gr"></span>Greek</a><a class="lang-link lang-hi"href=/hi/posts/alpine><span class="flag flag-in"></span>Hindi</a><a class="lang-link lang-it"href=/it/posts/alpine><span class="flag flag-it"></span>Italian</a><a class="lang-link lang-ja"href=/ja/posts/alpine><span class="flag flag-jp"></span>Japanese</a><a class="lang-link lang-jw"href=/jw/posts/alpine><span class="flag flag-id"></span>Javanese</a><a class="lang-link lang-ko"href=/ko/posts/alpine><span class="flag flag-kr"></span>Korean</a><a class="lang-link lang-ms"href=/ms/posts/alpine><span class="flag flag-ms"></span>Malay</a><a class="lang-link lang-zh"href=/zh/posts/alpine><span class="flag flag-cn"></span>Mandarin Chinese</a><a class="lang-link lang-pl"href=/pl/posts/alpine><span class="flag flag-pl"></span>Polish</a><a class="lang-link lang-pt"href=/pt/posts/alpine><span class="flag flag-pt"></span>Portuguese</a><a class="lang-link lang-pa"href=/pa/posts/alpine><span class="flag flag-in"></span>Punjabi</a><a class="lang-link lang-ro"href=/ro/posts/alpine><span class="flag flag-ro"></span>Romanian</a><a class="lang-link lang-ru"href=/ru/posts/alpine><span class="flag flag-ru"></span>Russian</a><a class="lang-link lang-es"href=/es/posts/alpine><span class="flag flag-es"></span>Spanish</a><a class="lang-link lang-sv"href=/sv/posts/alpine><span class="flag flag-se"></span>Swedish</a><a class="lang-link lang-th"href=/th/posts/alpine><span class="flag flag-th"></span>Thai</a><a class="lang-link lang-tr"href=/tr/posts/alpine><span class="flag flag-tr"></span>Turkish</a><a class="lang-link lang-uk"href=/uk/posts/alpine><span class="flag flag-ua"></span>Ukranian</a><a class="lang-link lang-ur"href=/ur/posts/alpine><span class="flag flag-pk"></span>Urdu</a><a class="lang-link lang-vi"href=/vi/posts/alpine><span class="flag flag-vn"></span>Vietnamese</a><a class="lang-link lang-zu"href=/zu/posts/alpine><span class="flag flag-za"></span>Zulu</a></ul></div></button></ul></div></nav></div></div></div><div><h1 id=title><a href=/el/posts/alpine> αλπικός</a></h1><blockquote id=page-description style=font-style:italic>Pine, Alpine linux βασισμένο στο OSTree</blockquote></div><div class=franklin-content><p>Επιλέγοντας τι<a href=https://en.wikipedia.org/wiki/Operating_system> Λειτουργικό σύστημα</a> η λειτουργία στους διακομιστές σας είναι θέμα ευκολίας και εξοικείωσης. Ευκολία σημαίνει ότι θέλετε κάτι που σας δίνει όσο το δυνατόν λιγότερα προβλήματα, εξοικείωση σημαίνει ότι θα προτιμούσατε<em> δεν</em> αν δεν χρειάζεται να μάθετε επιπλέον πράγματα.<p>Οι διακομιστές μου είναι<a href=https://devops.stackexchange.com/questions/653/what-is-the-definition-of-cattle-not-pets> κατοικίδια</a>οπότε είμαι εντάξει να εκδίδω μερικές εντολές κάθε τόσο και δεν απαιτώ πλήρη αυτοματοποίηση.<p>Αφού δοκίμασε<a href=https://en.wikipedia.org/wiki/Container_Linux> CoreOS</a> για ένα χρόνο άλλαξα στη δική μου απλοποιημένη<a href=https://en.wikipedia.org/wiki/Linux_distribution> διανομή</a> με βάση τα αλπικά και<a href=https://en.wikipedia.org/wiki/OSTree> ostree</a>.<h2 id=goals><a class=header-anchor href=#goals> Γκολ</a></h2><p>Αυτή η έκδοση του αλπικού παίρνει στοιχεία από<a href=https://kinvolk.io/flatcar-container-linux/> flatcar</a> και<a href=https://www.projectatomic.io/> έργο-ατομικό</a> και υποτίθεται ότι είναι εγκατεστημένο ως σύστημα αρχείων ρίζας μόνο για ανάγνωση με ενημερώσεις που συμβαίνουν ατομικά, δηλαδή είτε επιτυγχάνουν είτε το σύστημα αλλάζει πίσω στην προηγούμενη κατάσταση. Για να είναι αυτό δυνατό, το σύστημα πρέπει πάντα να έχει τουλάχιστον<strong> δύο στιγμιότυπα</strong> της έκδοσης του συστήματος αρχείων που κυκλοφόρησε, διαθέσιμο στο χώρο αποθήκευσης.<h2 id=targets><a class=header-anchor href=#targets> Στόχοι</a></h2><p>Σε τι περιβάλλον θα λειτουργήσει το σύστημα; Στοχοποίησα<a href=https://en.wikipedia.org/wiki/OpenVZ> OVZ</a> και [KVM], αλλά γενικά μπορείτε να πείτε<em> δοχεία</em> και<em> εικονικές μηχανές</em> με την κύρια διαφορά ότι τα κοντέινερ δεν τρέχουν τον δικό τους πυρήνα, συγκεκριμένα δεν έχουν διαδικασία εκκίνησης, καλούν απευθείας στο<em> μέσα σε αυτό</em> σύστημα (το οποίο για παράδειγμα σε α<code><a href=https://en.wikipedia.org/wiki/Docker_(software)>Dockerfile</a></code> θα οριζόταν από το<code>CMD</code> ή<code>ENTRYPOINT</code> δηλώσεις), η οποία είναι υπεύθυνη για τη διαχείριση του δέντρου των επιπέδων που θα διατηρήσει το κοντέινερ σε λειτουργία (ακριβώς όπως μια κανονική συνεδρία, εάν η διαδικασία εκκίνησης πεθάνει, το κοντέινερ τερματίζεται). Επίσης, τα κοντέινερ δεν μπορούν να διαμορφώσουν τα κουμπιά συστήματος και μπορούν να έχουν πρόσθετους περιορισμούς στις δυνατότητες.<h2 id=bisecting_the_build_process><a class=header-anchor href=#bisecting_the_build_process> Διχοτόμηση της διαδικασίας κατασκευής</a></h2><p>Πώς χτίζεται η εικόνα;<h3 id=dependencies><a class=header-anchor href=#dependencies> Εξαρτήσεις</a></h3><p>ο<code>prepare.sh</code> το σενάριο χειρίζεται εξαρτήσεις, τα περισσότερα από τα οποία είναι τα πακέτα για να προσφέρουν κοινά εργαλεία cli όπως<code>coreutils</code>, <code>util-linux</code>, <code>binutils</code> , βοηθητικά προγράμματα για λειτουργία με συσκευές μπλοκ, όπως<code>blkid</code>, <code>sfdisk</code>, <code>multipath-tools</code> και συστήματα αρχείων με<code>xfsprogs</code> και<code>e2fsprogs</code> Το ο<code>squashfs-tools</code> το πακέτο χρησιμοποιείται στο τέλος για τη συμπίεση του ενσωματωμένου ριζικού συστήματος αρχείων. ΕΝΑ<code>glib</code> Το πακέτο συμβατότητας είναι επίσης εγκατεστημένο από προεπιλογή επειδή το αλπικό βασίζεται σε<code><a href=https://musl.libc.org/>musl</a></code>, το πακέτο συμβατότητας λειτουργεί με την παροχή ορισμένων βιβλιοθηκών σε αντίθεση.<h3 id=the_tree><a class=header-anchor href=#the_tree> Το δέντρο</a></h3><p>Τα δέντρα αρχείων τόσο για VM όσο και για κοντέινερ δημιουργούνται αντίστοιχα<code>make.sh</code> και<code>make_ovz.sh</code> Το Αυτή είναι μια απλοποιημένη περιγραφή των βημάτων<ul><li><p>ορίστε την έκδοση που θα δημιουργηθεί σύμφωνα με την ετικέτα αποθετηρίου<li><p>δημιουργήστε έναν κατάλογο για το νέο δέντρο και καθαρίστε το περιβάλλον<li><p>δημιουργία βασικών καταλόγων στόχων και καταλόγων που απαιτούνται από το ostree, όπως<code>sysroot</code><li><p>δημιουργήστε συνδέσμους για να συμμορφωθείτε με το<a href=https://www.freedesktop.org/software/systemd/man/file-hierarchy.html> πρότυπο ιεραρχίας συστήματος αρχείων</a><li><p>αντιγραφή προσαρμοσμένων υπηρεσιών και προσαρμοσμένων ρυθμίσεων<li><p>ρύθμιση chroot με τοποθετημένους καταλόγους συστήματος<li><p>bootstrap ένα αλπικό rootfs με βασικά πακέτα<li><p>εφαρμόστε ελάχιστη διαμόρφωση στα rootfs όπως διαπιστευτήρια, ζώνη ώρας, όνομα κεντρικού υπολογιστή.<li><p>οι υπηρεσίες αντιγραφής θα ξεκινήσουν με το init<li><p>ρυθμίστε τη διαμόρφωση εκκίνησης με την καθορισμένη εικόνα πυρήνα<li><p>προαιρετικά προσθέστε προσαρμοσμένες μονάδες πυρήνα<li><p>πραγματοποιούν καθαρισμούς<li><p>δεσμεύστε τα rootfs<sup id=fnref:rootfs><a class=fnref href=#fndef:rootfs>[1]</a></sup> στο αποθετήριο ostree</ul><p>Για τα εμπορευματοκιβώτια, η ακολουθία είναι η ίδια, αλλά η διαμόρφωση αλλάζει, επειδή με ένα σύστημα που δεν εκκινείται από a<a href=https://en.wikipedia.org/wiki/Bootloader> bootloader</a> Το ostree έχει προβλήματα με την επαλήθευση του περιβάλλοντος, πρέπει να εφαρμόσουμε μερικά<a href=https://github.com/untoreh/pine/blob/e65f12be70fd91edfd935e3ae9854c7be555ec73/make_ovz.sh#L73> λύσεις</a> και ρυθμίστε ορισμένες συσκευές που συνήθως χειρίζονται οι<a href=https://en.wikipedia.org/wiki/Initial_ramdisk> initramfs</a> βήμα. Ετσι<a href=https://en.wikipedia.org/wiki/OpenVZ> OVZ</a> ή<a href=https://en.wikipedia.org/wiki/LXC> LXC</a> τα πρότυπα έχουν διαμορφωθεί.<h3 id=packaging><a class=header-anchor href=#packaging> Συσκευασία</a></h3><p>Μόλις έχουμε το δέντρο μας ostree δεσμευμένα αρχεία<code>build.sh</code> ή<code>build-update.sh</code> φροντίζει για την παραγωγή του τεχνητού που θα διανεμηθεί. Η διαφορά μεταξύ των σεναρίων είναι ότι η έκδοση ενημέρωσης ξεκινά από ένα προηγούμενο αποθετήριο ostree, και<em> επίσης</em> παράγει ένα τεχνούργημα δέλτα που ένα τρέχον σύστημα μπορεί να εφαρμόσει στην άλλη περίπτωση του για να πραγματοποιήσει αναβαθμίσεις. Αυτή είναι μια απλοποιημένη περιγραφή των βημάτων κατασκευής<ul><li><p>αν νέα κατασκευή<ul><li><p>δημιουργήστε νέα διαμερίσματα σε μια νέα εικόνα που είναι τοποθετημένη ως συσκευή βρόχου</ul><li><p>αλλού<ul><li><p>τοποθέτηση χωρισμάτων sysroot και εκκίνησης προηγούμενης κατασκευής</ul><li><p>καθαρίστε τις προηγούμενες αναπτύξεις ostree (σύνδεση αγροκτημάτων) σε τοποθετημένη κατασκευή<li><p>δεσμεύω νέο χτισμένο δέντρο σε τοποθετημένη κατασκευή<li><p>επαληθεύστε την ακεραιότητα και τα αθροίσματα ελέγχου<li><p>δημιουργία νέου δέλτα για αναβαθμίσεις<li><p>εκτέλεση ανάπτυξης ostree για ανανέωση της διαμόρφωσης εκκίνησης<li><p>αφαιρέστε τις παλιές δεσμεύσεις ostree<li><p>επαληθεύστε την ακεραιότητα του διαμερίσματος εκκίνησης<li><p>αποσυναρμολόγηση νέας ενημερωμένης εικόνας κατασκευής<li><p>δημιουργεί άθροισμα ελέγχου εικόνας και συμπιέζει το (με<code>squashfs</code> για δοχεία)</ul><p>Η διαμόρφωση των διαμερισμάτων εφαρμόζεται με fdisk<code>layout.cfg</code> αρχείο που καθορίζει τα μεγέθη των διαμερισμάτων, έχουμε ένα διαμέρισμα για τα rootfs (<code>~430M</code> ), το διαμέρισμα εκκίνησης (<code>~40M</code> ) και ένα διαμέρισμα ανταλλαγής (<code>~40M</code> ). Με δοχεία με απλή παράκαμψη της προηγούμενης κατασκευής σε μια συσκευή βρόχου και απλώς τραβήξτε τη νέα δέσμευση ostree πάνω από το παλιό (εξαγόμενο) αποθετήριο ostree.<h2 id=customizations><a class=header-anchor href=#customizations> Προσαρμογές</a></h2><p>Τι ομαδοποιώ σε αυτήν την εικόνα (εκτός από τα εγκατεστημένα πακέτα);<ul><li><p>Μια μικρή λίμπα μέσα<code>functions.sh</code> για κοινές εργασίες που εκτελούνται μέσα στο κέλυφος<li><p>Σενάρια αναβάθμισης βασισμένα σε ostree με μηχανισμό κλειδώματος βασισμένο στο κατάστημα KV<li><p>σενάρια παρακολούθησης και για τα δύο τοπικά (IO)<code>iomon</code> ) και δίκτυο (<code>tcpmon</code>)<li><p>εγκατάσταση σεναρίων για χρόνους εκτέλεσης κοντέινερ εκτός από<code>bubblewrap</code>: <code>podman</code>, <code>toolbox</code></ul><p>Αυτό που ήταν και δεν είναι πια<ul><li><p><code>sup</code>: <a href=https://github.com/pressly/sup/> Γουλιά</a> χρησιμοποιήθηκε για ενορχήστρωση (ανάπτυξη κοντέινερ) και διαμόρφωση του κεντρικού μηχανήματος, αλλά μετά άλλαξα σε<a href=https://www.ansible.com/> εύλογο</a> επειδή υπήρχαν μακροχρόνια σφάλματα στο sup που τους έλειπε να διορθώσουν, δεν επέλεξα το ansible από την αρχή γιατί δεν ήθελα να εγκατασταθεί εξάρτηση από python σε κάθε διακομιστή, τελικά τακτοποιήθηκα με ένα δευτερεύον αλπικό<a href=https://en.wikipedia.org/wiki/Chroot> chroot</a> στις μηχανές υποδοχής, που βρίσκονται στο<code>/opt/alp</code>εγκατέστησα επιπλέον λιγότερο κρίσιμο λογισμικό. Σήμερα, ωστόσο, θα άλλαζα ξανά από ansible σε<a href=https://github.com/Fizzadar/pyinfra> pyinfra</a> , επειδή<ul><li><p>είναι python χωρίς λέβητα (ansible έχει ψευδο<code>DSL</code> που προκαλεί περισσότερους πονοκεφάλους από αυτούς που λύνει)<li><p>εκτελεί τις συνταγές του με απλές εντολές ssh, οπότε δεν υπάρχει απαίτηση εξάρτησης από τους python στους κεντρικούς υπολογιστές -στόχους</ul><li><p><code>containerpilot</code> : Η περίπτωση χρήσης για πιλότο κοντέινερ είναι η διαχείριση σύνθετων εξαρτήσεων μεταξύ κοντέινερ χωρίς δέσμες ενεργειών κελύφους ... σταμάτησε να λαμβάνει ενημερώσεις από<a href=https://github.com/joyent/containerpilot> χαρούμενος</a> και τέθηκε σε λειτουργία συντήρησης, επίσης δεν μου άρεσε οι απαιτήσεις μνήμης και η χρήση μνήμης θα συνέβαινε να αυξάνεται συνεχώς για μεγάλο χρονικό διάστημα συνεχούς λειτουργίας. Το άλλαξα για απλά σενάρια κελύφους με<a href=https://www.consul.io/> πρόξενος</a> , Mightσως αναζητήσω πιο κατάλληλες εναλλακτικές λύσεις εάν τα σενάρια κελύφους αρχίσουν να αναπτύσσονται πάρα πολύ. Βαρύτερες λύσεις όπως<a href=https://kubernetes.io/> kubernetes</a>, <a href=https://docs.docker.com/engine/swarm/> σμήνος</a> ή<a href=https://www.nomadproject.io/> νομάς</a> απορρίφθηκαν από την αρχή.<li><p><code>beegfs</code> : Συνήθιζα να στέλνω τη μονάδα πυρήνα που απαιτείται για<a href=https://en.wikipedia.org/wiki/BeeGFS> μέλισσες</a> αλλά μετά από λίγο έσπασε τη συμβατότητα και το γεγονός ότι δεν υποστηρίχθηκε σωστά<a href=https://en.wikipedia.org/wiki/Filesystem_in_Userspace> ασφάλεια ηλεκτρική</a> Το module made be be drop it εντελώς, προς το παρόν δεν τρέχω ένα [DFS] στους διακομιστές μου, αλλά η δυνατότητα να έχω έτοιμο το σύστημα αρχείων για να συνδέσω ένα δίκτυο εξακολουθεί να είναι ελκυστική.<li><p></ul><h2 id=installation><a class=header-anchor href=#installation> Εγκατάσταση</a></h2><p>Για να εγκαταστήσετε την εικόνα, μπορείτε είτε να την ανεβάσετε στον πάροχο φιλοξενίας και να την εγκαταστήσετε από VNC, σε περίπτωση εικονικών μηχανών, αλλά συνήθως παρασύρω μια υπάρχουσα εγκατάσταση, επειδή είναι πάντα δυνατή, καθώς έχω δοκιμάσει το σενάριο εγκατάστασης σε σχέση με την έκδοση του η διανομή linux, γενικά χρησιμοποιώ το debian-8 ή το ubuntu-14, δεν έχω δοκιμάσει άλλα αφού αυτά τα έβρισκα πάντα διαθέσιμα. Ακολουθούν τα βήματα ρύθμισης<ul><li><p>διασφαλίστε την υποστήριξη https για λήψεις<li><p>κατεβάστε μια έκδοση busybox<li><p>εγκαταστήστε μια σύνδεση-αγρόκτημα busybox<li><p>καθορίστε τις διευθύνσεις ipv4/ipv6 για διαμόρφωση δικτύου<li><p>διασφαλίσει τις δυνατότητες του chroot<li><p>κατεβάστε την εικόνα του πεύκου και εξαγάγετε την<li><p>αν VM<ul><li><p>αναβοσβήνει στη συσκευή προορισμού<li><p>τοποθετήστε πάνω από μια συσκευή βρόχου</ul><li><p>γράψτε τη διαμόρφωση τοπικού δικτύου μέσω του<em> να αναβοσβήνει</em> rootfs<li><p>εάν δοχείο<ul><li><p>αντιγράψτε την υπηρεσία init (για κοντέινερ) πάνω από το κύριο σημείο στερέωσης ρίζας<code>/sbin/init</code></ul><li><p>αν VM<ul><li><p>διαμερίστε το αριστερό δίσκο με το τυπικό (<code>xfs</code> ) χωρίσματα<li><p>αποσυναρμολόγηση<li><p>επαληθεύστε την ακεραιότητα των διαμερισμάτων</ul><li><p>επανεκκίνηση</ul><h2 id=conclusions><a class=header-anchor href=#conclusions> Συμπεράσματα</a></h2><p>έφτιαξα<a href=https://github.com/untoreh/pine> πεύκο</a> 5 years from time of writing and I am still using it, and I see no reasons to switch to anything else. Alpine as a linux distro is great, simple, and I have never experienced breakage. I can easily deploy on <a href=https://en.wikipedia.org/wiki/Network_address_translation> NATED</a> διακομιστές που τείνουν να προσφέρουν εξαιρετικά χαμηλούς πόρους, στην πραγματικότητα έχω ένα κουτί που λειτουργεί με μόνο<code>64M</code> της μνήμης RAM και εξακολουθούν να έχουν όλες τις δυνατότητες που χρειάζομαι.<p><table class=fndef id=fndef:rootfs><tbody><tr><td class=fndef-backref><a href=#fnref:rootfs>[1]</a><td class=fndef-content>ριζικό σύστημα αρχείων</table><p><div class=page-foot><div class=copyright></div></div></div><div class=page__footer><footer><div class=page__footer-copyright>© untoreh - Powered by<a href=https://github.com/tlienart/Franklin.jl> Φράνκλιν</a></div><div class=page__footer-links>- <ul><li><a href=/el/sitemapxml> Χάρτης ιστοτόπου</a></li> | <li><a href=/el/tag> Ετικέτες</a></li> | <li><a href=https://www.unto.re/tag/feed.xml> RSS</a></ul></div><ul class=author__wrap><li class="author__urls social-icons"><a rel="nofollow noopener noreferrer"title="Twitter link"href=https://twitter.com/untoreh><i class="fab fa-fw fa-twitter-square"aria-hidden=true></i></a><li class="author__urls social-icons"><a rel="nofollow noopener noreferrer"title="GitHub link"href=https://github.com/untoreh><i class="fab fa-fw fa-github"aria-hidden=true></i></a><li class="author__urls social-icons"><a href=mailto:contact@unto.re title=email><i class="fas fa-envelope"></i></a><li><script type=application/ld+json>{"potentialAction":{"query-input":"required maxlength=100 name=input","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":{"uri":"","scheme":"https","userinfo":"","host":"www.unto.re","port":"","path":"/search","query":"q=%7Binput%7D","fragment":""}}}</script></ul></footer></div><script crossorigin=anonymous defer id=fa integrity=sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH src=https://use.fontawesome.com/releases/v5.8.2/js/all.js></script><script src=/libs/colors.js></script><script src=/libs/menu.js></script><script defer src=/libs/lunr/lunr.min.js></script>