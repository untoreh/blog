<!DOCTYPE html><HTML lang=en ><meta charset=UTF-8 /><script type="application/ld+json">{"copyrightHolder":"untoreh","@id":"https://unto.re","url":"https://unto.re","copyrightYear":2021,"@context":"https://schema.org/","@type":"WebSite"}</script><script type="application/ld+json">{"audience":"cool people","url":"https://unto.re/posts/paroodise/index.html","mainContentOfPage":{"@type":"WebPageElement","cssSelector":".franklin-content"},"accessMode":["textual","visual"],"accessibilitySummary":"Visual elements are tentatively described.","author":"untoreh","description":"A small utility for live modification of file systems","mentions":[],"accessModeSufficient":{"itemListElement":["textual","visual"],"description":"text and images","@type":"itemList"},"lastReviewed":"April 08, 2021","@type":"https://schema.org/WebPage","dateCreated":"April 24, 2021","@id":"https://unto.re/posts/paroodise/index.html","dateModified":"April 08, 2021","abstract":"A small utility for live modification of file systems","headline":"Paroodise","creativeWorkStatus":"Published","availableLanguage":[{"name":"English","@type":"Language"},{"name":"German","@type":"Language"},{"name":"Italian","@type":"Language"},{"name":"Mandarin Chinese","@type":"Language"},{"name":"Spanish","@type":"Language"},{"name":"Hindi","@type":"Language"},{"name":"Arabic","@type":"Language"},{"name":"Portuguese","@type":"Language"},{"name":"Bengali","@type":"Language"},{"name":"Russian","@type":"Language"},{"name":"Japanese","@type":"Language"},{"name":"Punjabi","@type":"Language"},{"name":"Javanese","@type":"Language"},{"name":"Vietnamese","@type":"Language"},{"name":"French","@type":"Language"},{"name":"Urdu","@type":"Language"},{"name":"Turkish","@type":"Language"},{"name":"Polish","@type":"Language"},{"name":"Ukranian","@type":"Language"},{"name":"Dutch","@type":"Language"},{"name":"Greek","@type":"Language"},{"name":"Swedish","@type":"Language"},{"name":"Zulu","@type":"Language"},{"name":"Romanian","@type":"Language"},{"name":"Malay","@type":"Language"},{"name":"Korean","@type":"Language"},{"name":"Thai","@type":"Language"},{"name":"Filipino","@type":"Language"}],"keywords":["tools","hosting","about"],"datePublished":"April 24, 2021","inLanguage":"English","name":"Paroodise","identifier":"https://unto.re/posts/paroodise/index.html"}</script><meta content="width=device-width, initial-scale=1" name=viewport /><link href="/css/franklin.css" rel=stylesheet /><link href="/css/main.css" rel=stylesheet /><link href="/css/menu.css" rel=stylesheet /><link href="/css/pages.css" rel=stylesheet /><link href="/css/lunr.css" rel=stylesheet /><link href="/css/footer.css" rel=stylesheet /><link href="/css/responsive.css" rel=stylesheet /><link href="/css/animations.css" rel=stylesheet /><link href="/css/docco.css" rel=stylesheet /><link href="/css/flag-icon.min.css" rel=stylesheet /><link href="/assets/favicon.png" rel=icon /><title> Paroodise</title><script src="/libs/lunr/lunr.min.js"></script><script src="/libs/lunr/lunr_index.js"></script><script src="/libs/lunr/lunrclient.min.js"></script><script src="/libs/load.js"></script><script type="application/ld+json">{"@id":"https://unto.re/pt/posts/paroodise/index.html","url":"https://unto.re/pt/posts/paroodise/index.html","abstract":null,"headline":null,"keywords":null,"description":null,"mentions":null,"translator":{"url":"https://translate.google.com/","name":"Google","@type":"https://schema.org/Organization"},"translationOfWork":{"@id":"/home/fra/dev/blog/https://unto.re/"},"inLanguage":"pt","name":null,"@type":"https://schema.org/WebPage"}</script><body class=""><div class=masthead ><div class=masthead__inner-wrap ><div class=masthead__menu ><a class=site-title href="/pt/"></a><div class=author__wrap ><script type="application/ld+json">{"sameAs":["https://github.com/untoreh","https://twitter.com/untoreh"],"description":"<ul>\n<li><p><strong>Name</strong>: Francesco Giannelli</p>\n\n<li><p><strong>Website</strong>: &#91;«https://unto.re»&#93;, the place where I put stuff I should remember...or forget</p>\n\n<li><p><strong>Location</strong>: south italy {{bio_link}}</p>\n\n<li><p><strong>Year</strong>: &#39;91</p>\n\n</ul>\n","image":"/assets/appa.png","name":"untoreh","@type":"https://schema.org/Person","email":"contact@unto.re"}</script><ul><li class=author__avatar onclick="toggleTheme()"><img alt=" desabrochar luz" class=flip-front src="/assets/appa.png"/><li class="author__urls social-icons"><a href="https://twitter.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden=true class="fab fa-fw fa-twitter-square"></i></a><li class="author__urls social-icons"><a href="https://github.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden=true class="fab fa-fw fa-github"></i></a><li class="author__urls social-icons"><a href="mailto:contact@unto.re"><i class="fas fa-envelope"></i></a><li><script type="application/ld+json">{"potentialAction":{"query-input":"required maxlength=100 name=query","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":"https://unto.re/search?&q={query}"}}</script></ul></div><nav id=site-nav ><div class=horiz ><ul><li class="masthead__menu-item hvr-outline-in" id=lunrSearch ><form id=lunrSearchForm name=lunrSearchForm ><button class=search-button formaction="/search/index.html" type=submit value=Search ><i class="fas fa-search menu-icons"></i></button><input class=search-input name=q placeholder="Search…" type=text /></form><li class="masthead__menu-item hvr-outline-in"><a href="/pt/posts/" title="All the articles that I have written"><i class="fas fa-pen menu-icons"></i> Postagens</a><li class="masthead__menu-item hvr-outline-in"><a href="/pt/about/" title="Things about me, what I have read, past projects and ideas for future ones"><i class="fas fa-user-alt menu-icons"></i> cerca de</a><li class="masthead__menu-item hvr-outline-in menu-lang-btn" title="Change website&#39;s language"><button class=langs-dropdown-wrapper ><i class="fas fa-language menu-icons"></i> Lang <div class=langs-dropdown-content id=langs-dropdown-menu ><ul id=lang-list ><a class=lang-link href="/ar/posts/paroodise" id=lang-ar ><span class="flag-icon flag-icon-sa"></span> árabe</a><a class=lang-link href="/pt/bn/posts/paroodise" id=lang-bn ><span class="flag-icon flag-icon-bd"></span> bengali</a><a class=lang-link href="/pt/nl/posts/paroodise" id=lang-nl ><span class="flag-icon flag-icon-nl"></span> holandês</a><a class=lang-link href="/pt/en/posts/paroodise" id=lang-en ><span class="flag-icon flag-icon-gb"></span> inglês</a><a class=lang-link href="/pt/tl/posts/paroodise" id=lang-tl ><span class="flag-icon flag-icon-ph"></span> Filipino</a><a class=lang-link href="/pt/fr/posts/paroodise" id=lang-fr ><span class="flag-icon flag-icon-fr"></span> francês</a><a class=lang-link href="/pt/de/posts/paroodise" id=lang-de ><span class="flag-icon flag-icon-de"></span> alemão</a><a class=lang-link href="/pt/el/posts/paroodise" id=lang-el ><span class="flag-icon flag-icon-gr"></span> grego</a><a class=lang-link href="/pt/hi/posts/paroodise" id=lang-hi ><span class="flag-icon flag-icon-in"></span> hindi</a><a class=lang-link href="/pt/it/posts/paroodise" id=lang-it ><span class="flag-icon flag-icon-it"></span> italiano</a><a class=lang-link href="/pt/ja/posts/paroodise" id=lang-ja ><span class="flag-icon flag-icon-jp"></span> japonês</a><a class=lang-link href="/pt/jw/posts/paroodise" id=lang-jw ><span class="flag-icon flag-icon-id"></span> Javanês</a><a class=lang-link href="/pt/ko/posts/paroodise" id=lang-ko ><span class="flag-icon flag-icon-kr"></span> coreano</a><a class=lang-link href="/pt/ms/posts/paroodise" id=lang-ms ><span class="flag-icon flag-icon-ms"></span> malaio</a><a class=lang-link href="/pt/zh/posts/paroodise" id=lang-zh ><span class="flag-icon flag-icon-cn"></span> chinês mandarim</a><a class=lang-link href="/pt/pl/posts/paroodise" id=lang-pl ><span class="flag-icon flag-icon-pl"></span> polonês</a><a class=lang-link href="/pt/pt/posts/paroodise" id=lang-pt ><span class="flag-icon flag-icon-pt"></span> português</a><a class=lang-link href="/pt/pa/posts/paroodise" id=lang-pa ><span class="flag-icon flag-icon-in"></span> Punjabi</a><a class=lang-link href="/pt/ro/posts/paroodise" id=lang-ro ><span class="flag-icon flag-icon-ro"></span> romena</a><a class=lang-link href="/pt/ru/posts/paroodise" id=lang-ru ><span class="flag-icon flag-icon-ru"></span> russo</a><a class=lang-link href="/pt/es/posts/paroodise" id=lang-es ><span class="flag-icon flag-icon-es"></span> espanhol</a><a class=lang-link href="/pt/sv/posts/paroodise" id=lang-sv ><span class="flag-icon flag-icon-se"></span> sueco</a><a class=lang-link href="/pt/th/posts/paroodise" id=lang-th ><span class="flag-icon flag-icon-th"></span> tailandês</a><a class=lang-link href="/pt/tr/posts/paroodise" id=lang-tr ><span class="flag-icon flag-icon-tr"></span> turco</a><a class=lang-link href="/pt/uk/posts/paroodise" id=lang-uk ><span class="flag-icon flag-icon-ua"></span> Ucraniano</a><a class=lang-link href="/pt/ur/posts/paroodise" id=lang-ur ><span class="flag-icon flag-icon-pk"></span> urdu</a><a class=lang-link href="/pt/vi/posts/paroodise" id=lang-vi ><span class="flag-icon flag-icon-vn"></span> vietnamita</a><a class=lang-link href="/pt/zu/posts/paroodise" id=lang-zu ><span class="flag-icon flag-icon-za"></span> zulu</a></ul></div></button></ul></div><button class=ham ><i class="fas fa-bars ham-icon"></i></button><div class=vert ><ul><li class="masthead__menu-item hvr-outline-in" id=lunrSearch ><form id=lunrSearchForm name=lunrSearchForm ><button class=search-button formaction="/search/index.html" type=submit value=Search ><i class="fas fa-search menu-icons"></i></button><input class=search-input name=q placeholder="Search…" type=text /></form><li class="masthead__menu-item hvr-outline-in"><a href="/pt/posts/" title="All the articles that I have written"><i class="fas fa-pen menu-icons"></i> Postagens</a><li class="masthead__menu-item hvr-outline-in"><a href="/pt/about/" title="Things about me, what I have read, past projects and ideas for future ones"><i class="fas fa-user-alt menu-icons"></i> cerca de</a><li class="masthead__menu-item hvr-outline-in menu-lang-btn" title="Change website&#39;s language"><button class=langs-dropdown-wrapper ><i class="fas fa-language menu-icons"></i> Lang <div class=langs-dropdown-content id=langs-dropdown-menu ><ul id=lang-list ><a class=lang-link href="/ar/posts/paroodise" id=lang-ar ><span class="flag-icon flag-icon-sa"></span> árabe</a><a class=lang-link href="/pt/bn/posts/paroodise" id=lang-bn ><span class="flag-icon flag-icon-bd"></span> bengali</a><a class=lang-link href="/pt/nl/posts/paroodise" id=lang-nl ><span class="flag-icon flag-icon-nl"></span> holandês</a><a class=lang-link href="/pt/en/posts/paroodise" id=lang-en ><span class="flag-icon flag-icon-gb"></span> inglês</a><a class=lang-link href="/pt/tl/posts/paroodise" id=lang-tl ><span class="flag-icon flag-icon-ph"></span> Filipino</a><a class=lang-link href="/pt/fr/posts/paroodise" id=lang-fr ><span class="flag-icon flag-icon-fr"></span> francês</a><a class=lang-link href="/pt/de/posts/paroodise" id=lang-de ><span class="flag-icon flag-icon-de"></span> alemão</a><a class=lang-link href="/pt/el/posts/paroodise" id=lang-el ><span class="flag-icon flag-icon-gr"></span> grego</a><a class=lang-link href="/pt/hi/posts/paroodise" id=lang-hi ><span class="flag-icon flag-icon-in"></span> hindi</a><a class=lang-link href="/pt/it/posts/paroodise" id=lang-it ><span class="flag-icon flag-icon-it"></span> italiano</a><a class=lang-link href="/pt/ja/posts/paroodise" id=lang-ja ><span class="flag-icon flag-icon-jp"></span> japonês</a><a class=lang-link href="/pt/jw/posts/paroodise" id=lang-jw ><span class="flag-icon flag-icon-id"></span> Javanês</a><a class=lang-link href="/pt/ko/posts/paroodise" id=lang-ko ><span class="flag-icon flag-icon-kr"></span> coreano</a><a class=lang-link href="/pt/ms/posts/paroodise" id=lang-ms ><span class="flag-icon flag-icon-ms"></span> malaio</a><a class=lang-link href="/pt/zh/posts/paroodise" id=lang-zh ><span class="flag-icon flag-icon-cn"></span> chinês mandarim</a><a class=lang-link href="/pt/pl/posts/paroodise" id=lang-pl ><span class="flag-icon flag-icon-pl"></span> polonês</a><a class=lang-link href="/pt/pt/posts/paroodise" id=lang-pt ><span class="flag-icon flag-icon-pt"></span> português</a><a class=lang-link href="/pt/pa/posts/paroodise" id=lang-pa ><span class="flag-icon flag-icon-in"></span> Punjabi</a><a class=lang-link href="/pt/ro/posts/paroodise" id=lang-ro ><span class="flag-icon flag-icon-ro"></span> romena</a><a class=lang-link href="/pt/ru/posts/paroodise" id=lang-ru ><span class="flag-icon flag-icon-ru"></span> russo</a><a class=lang-link href="/pt/es/posts/paroodise" id=lang-es ><span class="flag-icon flag-icon-es"></span> espanhol</a><a class=lang-link href="/pt/sv/posts/paroodise" id=lang-sv ><span class="flag-icon flag-icon-se"></span> sueco</a><a class=lang-link href="/pt/th/posts/paroodise" id=lang-th ><span class="flag-icon flag-icon-th"></span> tailandês</a><a class=lang-link href="/pt/tr/posts/paroodise" id=lang-tr ><span class="flag-icon flag-icon-tr"></span> turco</a><a class=lang-link href="/pt/uk/posts/paroodise" id=lang-uk ><span class="flag-icon flag-icon-ua"></span> Ucraniano</a><a class=lang-link href="/pt/ur/posts/paroodise" id=lang-ur ><span class="flag-icon flag-icon-pk"></span> urdu</a><a class=lang-link href="/pt/vi/posts/paroodise" id=lang-vi ><span class="flag-icon flag-icon-vn"></span> vietnamita</a><a class=lang-link href="/pt/zu/posts/paroodise" id=lang-zu ><span class="flag-icon flag-icon-za"></span> zulu</a></ul></div></button></ul></div></nav></div></div></div><div><h1 id=title ><a href="/pt/posts/paroodise"> Paroodise</a></h1><blockquote id=page-description style="font-style: italic;"> Um pequeno utilitário para modificação ao vivo de sistemas de arquivos </blockquote></div><div class=franklin-content ><p> Quando eu estava decidindo qual distribuição Linux usaria para meus servidores remotos, eu precisava de uma maneira de instalar rapidamente diferentes sistemas de arquivos raiz em um host de destino, então escrevi [paroodise].</p><p> Para ser capaz de atualizar um dispositivo de bloco inicializado, você precisa<em> desmontar</em> . Você só pode desmontar se parar de usá-lo. Para parar de usá-lo, você precisa reiniciar seus serviços no local, a partir de outro sistema de arquivos raiz. Isso é semelhante ao que o<a href="https://en.wikipedia.org/wiki/Initial_ramdisk"> initramfs</a>faz quando inicializa um sistema operacional baseado em Linux, o kernel executa uma imagem de inicialização que configura o sistema de arquivos de onde o verdadeiro<a href="https://en.wikipedia.org/wiki/Init"> iniciar</a> serviço é lançado.</p><p> Para conseguir isso em um<em> já correndo</em> sistema, temos que ter cuidado ao reiniciar nossos processos. Não podemos matar o ssh a menos que tenhamos certeza de que nosso script será executado até ser bem-sucedido.</p><p> Todo o processo é muito mais fácil em distros não baseadas no systemd, uma vez que o systemd se conecta profundamente ao kernel do Linux, mutilar seus processos de forma imprudente pode causar pânicos no kernel ... na verdade, em distribuições mais recentes é o que geralmente acontece :)</p><p> Quando escrevi este mini utilitário, parece que não conhecia maneiras estáveis ​​de gerar processos que sobrevivessem às sessões ssh originais. Ele deveria ser reescrito com métodos mais consistentes.</p><p> Todo o processo consiste em</p><ul><li><p> copiando os arquivos mínimos necessários para reinicializar o sistema de arquivos na memória</p><li><p> mover (ou recriar) os pontos de montagem do kernel (<code>/dev</code>, <code>/proc</code>, <code>/sys</code>)</p><li><p> matando serviços anteriores gerados pela árvore de processo permanente do systemd</p><li><p> reexecutando o systemd para o novo sistema de arquivos pivotado,<a href="https://www.freedesktop.org/software/systemd/man/systemctl.html#Manager%20State%20Commands"><code>systemctl daemon-reexec</code></a></p></ul><p> Se tudo for concluído com sucesso, é possível neste ponto gerar um novo serviço ssh e fazer o login em uma sessão onde os pontos de montagem originais estão disponíveis para modificações.</p><p></p><div id=post-tags-list > Tags de postagem: <span class=post-tag ><a href="/pt/posts/tag/tools" style=""> Ferramentas</a>, </span><span class=post-tag ><a href="/pt/posts/tag/hosting" style=""> hospedagem</a>, </span><span class=post-tag ><a href="/pt/posts/tag/about" style=""> cerca de</a></span></div><div class=page-foot ><div class=copyright > 8 de abril de 2021 </div><script async="" crossorigin=anonymous issue-term=pathname label=Comment repo="untoreh/untoreh.github.io" src="https://utteranc.es/client.js"></script></div></div><div class=page__footer ><footer><div class=page__footer-copyright > © untoreh - Desenvolvido por<a href="https://github.com/tlienart/Franklin.jl"> Franklin</a></div><div class=page__footer-links > - <ul><li><a href="/pt/sitemap.xml"> Mapa do site</a> | <li><a href="/pt/tag"> Tag</a> | <li><a href="/pt/feed.xml"> RSS</a></ul></div><ul class=author__wrap ><li class="author__urls social-icons"><a href="https://twitter.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden=true class="fab fa-fw fa-twitter-square"></i></a><li class="author__urls social-icons"><a href="https://github.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden=true class="fab fa-fw fa-github"></i></a><li class="author__urls social-icons"><a href="mailto:contact@unto.re"><i class="fas fa-envelope"></i></a><li><script type="application/ld+json">{"potentialAction":{"query-input":"required maxlength=100 name=query","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":"https://unto.re/search?&q={query}"}}</script></ul></footer></div><script crossorigin=anonymous defer="" id=fa integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" src="https://use.fontawesome.com/releases/v5.8.2/js/all.js"></script><script src="/libs/colors.js"></script><script src="/libs/menu.js"></script><script defer="" src="/libs/lunr/lunr.min.js"></script></HTML>