<!DOCTYPE html><HTML lang="en"><head><meta charset="UTF-8"/><script type="application/ld+json">{"copyrightHolder":"untoreh","@id":"https://unto.re","url":"https://unto.re","copyrightYear":2021,"@context":"https://schema.org/","@type":"WebSite"}</script><script type="application/ld+json">{"audience":"cool people","url":"https://unto.re/posts/alpine/index.html","mainContentOfPage":{"@type":"WebPageElement","cssSelector":".franklin-content"},"accessMode":["textual","visual"],"accessibilitySummary":"Visual elements are tentatively described.","author":"untoreh","description":"Pine, Alpine linux based on OSTree","mentions":[],"accessModeSufficient":{"itemListElement":["textual","visual"],"description":"text and images","@type":"itemList"},"lastReviewed":"April 19, 2021","@type":"https://schema.org/WebPage","dateCreated":"April 24, 2021","@id":"https://unto.re/posts/alpine/index.html","dateModified":"April 19, 2021","abstract":"Pine, Alpine linux based on OSTree","headline":"Alpine","creativeWorkStatus":"Published","availableLanguage":[{"name":"English","@type":"Language"},{"name":"German","@type":"Language"},{"name":"Italian","@type":"Language"},{"name":"Mandarin Chinese","@type":"Language"},{"name":"Spanish","@type":"Language"},{"name":"Hindi","@type":"Language"},{"name":"Arabic","@type":"Language"},{"name":"Portuguese","@type":"Language"},{"name":"Bengali","@type":"Language"},{"name":"Russian","@type":"Language"},{"name":"Japanese","@type":"Language"},{"name":"Punjabi","@type":"Language"},{"name":"Javanese","@type":"Language"},{"name":"Vietnamese","@type":"Language"},{"name":"French","@type":"Language"},{"name":"Urdu","@type":"Language"},{"name":"Turkish","@type":"Language"},{"name":"Polish","@type":"Language"},{"name":"Ukranian","@type":"Language"},{"name":"Dutch","@type":"Language"},{"name":"Greek","@type":"Language"},{"name":"Swedish","@type":"Language"},{"name":"Zulu","@type":"Language"},{"name":"Romanian","@type":"Language"},{"name":"Malay","@type":"Language"},{"name":"Korean","@type":"Language"},{"name":"Thai","@type":"Language"},{"name":"Filipino","@type":"Language"}],"keywords":["tools","about"],"datePublished":"April 24, 2021","inLanguage":"English","name":"Alpine","identifier":"https://unto.re/posts/alpine/index.html"}</script><meta content="width=device-width, initial-scale=1" name="viewport"/><link href="/css/franklin.css" rel="stylesheet"/><link href="/css/main.css" rel="stylesheet"/><link href="/css/menu.css" rel="stylesheet"/><link href="/css/pages.css" rel="stylesheet"/><link href="/css/lunr.css" rel="stylesheet"/><link href="/css/footer.css" rel="stylesheet"/><link href="/css/responsive.css" rel="stylesheet"/><link href="/css/animations.css" rel="stylesheet"/><link href="/css/docco.css" rel="stylesheet"/><link href="/css/flag-icon.min.css" rel="stylesheet"/><link href="/assets/favicon.png" rel="icon"/><title> alpin</title><script src="/libs/lunr/lunr.min.js"></script><script src="/libs/lunr/lunr_index.js"></script><script src="/libs/lunr/lunrclient.min.js"></script><script src="/libs/load.js"></script><script type="application/ld+json">{"@id":"https://unto.re/de/posts/alpine/index.html","url":"https://unto.re/de/posts/alpine/index.html","abstract":null,"headline":null,"keywords":null,"description":null,"mentions":null,"translator":{"url":"https://translate.google.com/","name":"Google","@type":"https://schema.org/Organization"},"translationOfWork":{"@id":"/home/fra/dev/blog/https://unto.re/"},"inLanguage":"de","name":null,"@type":"https://schema.org/WebPage"}</script></head><body class=""><div class="masthead"><div class="masthead__inner-wrap"><div class="masthead__menu"><a class="site-title" href="/de/"></a><div class="author__wrap"><script type="application/ld+json">{"sameAs":["https://github.com/untoreh","https://twitter.com/untoreh"],"description":"<ul>\n<li><p><strong>Name</strong>: Francesco Giannelli</p>\n</li>\n<li><p><strong>Website</strong>: &#91;«https://unto.re»&#93;, the place where I put stuff I should remember...or forget</p>\n</li>\n<li><p><strong>Location</strong>: south italy {{bio_link}}</p>\n</li>\n<li><p><strong>Year</strong>: &#39;91</p>\n</li>\n</ul>\n","image":"/assets/appa.png","name":"untoreh","@type":"https://schema.org/Person","email":"contact@unto.re"}</script><ul><li class="author__avatar" onclick="toggleTheme()"><img alt=" untoreh-light" class="flip-front" src="/assets/appa.png"/></li><li class="author__urls social-icons"><a href="https://twitter.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden="true" class="fab fa-fw fa-twitter-square"></i></a></li><li class="author__urls social-icons"><a href="https://github.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden="true" class="fab fa-fw fa-github"></i></a></li><li class="author__urls social-icons"><a href="mailto:contact@unto.re"><i class="fas fa-envelope"></i></a></li><li><script type="application/ld+json">{"potentialAction":{"query-input":"required maxlength=100 name=query","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":"https://unto.re/search?&q={query}"}}</script></li></ul></div><nav id="site-nav"><div class="horiz"><ul><li class="masthead__menu-item hvr-outline-in" id="lunrSearch"><form id="lunrSearchForm" name="lunrSearchForm"><button class="search-button" formaction="/search/index.html" type="submit" value="Search"><i class="fas fa-search menu-icons"></i></button><input class="search-input" name="q" placeholder="Search…" type="text"/></form></li><li class="masthead__menu-item hvr-outline-in"><a href="/de/posts/" title="All the articles that I have written"><i class="fas fa-pen menu-icons"></i> Beiträge</a></li><li class="masthead__menu-item hvr-outline-in"><a href="/de/about/" title="Things about me, what I have read, past projects and ideas for future ones"><i class="fas fa-user-alt menu-icons"></i> Über</a></li><li class="masthead__menu-item hvr-outline-in menu-lang-btn" title="Change website&#39;s language"><button class="langs-dropdown-wrapper"><i class="fas fa-language menu-icons"></i> Lang
            <div class="langs-dropdown-content" id="langs-dropdown-menu"><ul id="lang-list"><a class="lang-link" href="/ar/posts/alpine" id="lang-ar"><span class="flag-icon flag-icon-sa"></span> Arabisch</a><a class="lang-link" href="/de/bn/posts/alpine" id="lang-bn"><span class="flag-icon flag-icon-bd"></span> Bengali</a><a class="lang-link" href="/de/nl/posts/alpine" id="lang-nl"><span class="flag-icon flag-icon-nl"></span> Niederländisch</a><a class="lang-link" href="/de/en/posts/alpine" id="lang-en"><span class="flag-icon flag-icon-gb"></span> Englisch</a><a class="lang-link" href="/de/tl/posts/alpine" id="lang-tl"><span class="flag-icon flag-icon-ph"></span> Philippinisch</a><a class="lang-link" href="/de/fr/posts/alpine" id="lang-fr"><span class="flag-icon flag-icon-fr"></span> Französisch</a><a class="lang-link" href="/de/de/posts/alpine" id="lang-de"><span class="flag-icon flag-icon-de"></span> Deutsch</a><a class="lang-link" href="/de/el/posts/alpine" id="lang-el"><span class="flag-icon flag-icon-gr"></span> griechisch</a><a class="lang-link" href="/de/hi/posts/alpine" id="lang-hi"><span class="flag-icon flag-icon-in"></span> Hindi</a><a class="lang-link" href="/de/it/posts/alpine" id="lang-it"><span class="flag-icon flag-icon-it"></span> Italienisch</a><a class="lang-link" href="/de/ja/posts/alpine" id="lang-ja"><span class="flag-icon flag-icon-jp"></span> japanisch</a><a class="lang-link" href="/de/jw/posts/alpine" id="lang-jw"><span class="flag-icon flag-icon-id"></span> Javanisch</a><a class="lang-link" href="/de/ko/posts/alpine" id="lang-ko"><span class="flag-icon flag-icon-kr"></span> Koreanisch</a><a class="lang-link" href="/de/ms/posts/alpine" id="lang-ms"><span class="flag-icon flag-icon-ms"></span> malaiisch</a><a class="lang-link" href="/de/zh/posts/alpine" id="lang-zh"><span class="flag-icon flag-icon-cn"></span> Mandarin Chinesisch</a><a class="lang-link" href="/de/pl/posts/alpine" id="lang-pl"><span class="flag-icon flag-icon-pl"></span> Polieren</a><a class="lang-link" href="/de/pt/posts/alpine" id="lang-pt"><span class="flag-icon flag-icon-pt"></span> Portugiesisch</a><a class="lang-link" href="/de/pa/posts/alpine" id="lang-pa"><span class="flag-icon flag-icon-in"></span> Punjabi</a><a class="lang-link" href="/de/ro/posts/alpine" id="lang-ro"><span class="flag-icon flag-icon-ro"></span> rumänisch</a><a class="lang-link" href="/de/ru/posts/alpine" id="lang-ru"><span class="flag-icon flag-icon-ru"></span> Russisch</a><a class="lang-link" href="/de/es/posts/alpine" id="lang-es"><span class="flag-icon flag-icon-es"></span> Spanisch</a><a class="lang-link" href="/de/sv/posts/alpine" id="lang-sv"><span class="flag-icon flag-icon-se"></span> Schwedisch</a><a class="lang-link" href="/de/th/posts/alpine" id="lang-th"><span class="flag-icon flag-icon-th"></span> Thai</a><a class="lang-link" href="/de/tr/posts/alpine" id="lang-tr"><span class="flag-icon flag-icon-tr"></span> Türkisch</a><a class="lang-link" href="/de/uk/posts/alpine" id="lang-uk"><span class="flag-icon flag-icon-ua"></span> ukrainisch</a><a class="lang-link" href="/de/ur/posts/alpine" id="lang-ur"><span class="flag-icon flag-icon-pk"></span> Urdu</a><a class="lang-link" href="/de/vi/posts/alpine" id="lang-vi"><span class="flag-icon flag-icon-vn"></span> Vietnamesisch</a><a class="lang-link" href="/de/zu/posts/alpine" id="lang-zu"><span class="flag-icon flag-icon-za"></span> Zulu-</a></ul></div></button></li></ul></div><button class="ham"><i class="fas fa-bars ham-icon"></i></button><div class="vert"><ul><li class="masthead__menu-item hvr-outline-in" id="lunrSearch"><form id="lunrSearchForm" name="lunrSearchForm"><button class="search-button" formaction="/search/index.html" type="submit" value="Search"><i class="fas fa-search menu-icons"></i></button><input class="search-input" name="q" placeholder="Search…" type="text"/></form></li><li class="masthead__menu-item hvr-outline-in"><a href="/de/posts/" title="All the articles that I have written"><i class="fas fa-pen menu-icons"></i> Beiträge</a></li><li class="masthead__menu-item hvr-outline-in"><a href="/de/about/" title="Things about me, what I have read, past projects and ideas for future ones"><i class="fas fa-user-alt menu-icons"></i> Über</a></li><li class="masthead__menu-item hvr-outline-in menu-lang-btn" title="Change website&#39;s language"><button class="langs-dropdown-wrapper"><i class="fas fa-language menu-icons"></i> Lang
            <div class="langs-dropdown-content" id="langs-dropdown-menu"><ul id="lang-list"><a class="lang-link" href="/ar/posts/alpine" id="lang-ar"><span class="flag-icon flag-icon-sa"></span> Arabisch</a><a class="lang-link" href="/de/bn/posts/alpine" id="lang-bn"><span class="flag-icon flag-icon-bd"></span> Bengali</a><a class="lang-link" href="/de/nl/posts/alpine" id="lang-nl"><span class="flag-icon flag-icon-nl"></span> Niederländisch</a><a class="lang-link" href="/de/en/posts/alpine" id="lang-en"><span class="flag-icon flag-icon-gb"></span> Englisch</a><a class="lang-link" href="/de/tl/posts/alpine" id="lang-tl"><span class="flag-icon flag-icon-ph"></span> Philippinisch</a><a class="lang-link" href="/de/fr/posts/alpine" id="lang-fr"><span class="flag-icon flag-icon-fr"></span> Französisch</a><a class="lang-link" href="/de/de/posts/alpine" id="lang-de"><span class="flag-icon flag-icon-de"></span> Deutsch</a><a class="lang-link" href="/de/el/posts/alpine" id="lang-el"><span class="flag-icon flag-icon-gr"></span> griechisch</a><a class="lang-link" href="/de/hi/posts/alpine" id="lang-hi"><span class="flag-icon flag-icon-in"></span> Hindi</a><a class="lang-link" href="/de/it/posts/alpine" id="lang-it"><span class="flag-icon flag-icon-it"></span> Italienisch</a><a class="lang-link" href="/de/ja/posts/alpine" id="lang-ja"><span class="flag-icon flag-icon-jp"></span> japanisch</a><a class="lang-link" href="/de/jw/posts/alpine" id="lang-jw"><span class="flag-icon flag-icon-id"></span> Javanisch</a><a class="lang-link" href="/de/ko/posts/alpine" id="lang-ko"><span class="flag-icon flag-icon-kr"></span> Koreanisch</a><a class="lang-link" href="/de/ms/posts/alpine" id="lang-ms"><span class="flag-icon flag-icon-ms"></span> malaiisch</a><a class="lang-link" href="/de/zh/posts/alpine" id="lang-zh"><span class="flag-icon flag-icon-cn"></span> Mandarin Chinesisch</a><a class="lang-link" href="/de/pl/posts/alpine" id="lang-pl"><span class="flag-icon flag-icon-pl"></span> Polieren</a><a class="lang-link" href="/de/pt/posts/alpine" id="lang-pt"><span class="flag-icon flag-icon-pt"></span> Portugiesisch</a><a class="lang-link" href="/de/pa/posts/alpine" id="lang-pa"><span class="flag-icon flag-icon-in"></span> Punjabi</a><a class="lang-link" href="/de/ro/posts/alpine" id="lang-ro"><span class="flag-icon flag-icon-ro"></span> rumänisch</a><a class="lang-link" href="/de/ru/posts/alpine" id="lang-ru"><span class="flag-icon flag-icon-ru"></span> Russisch</a><a class="lang-link" href="/de/es/posts/alpine" id="lang-es"><span class="flag-icon flag-icon-es"></span> Spanisch</a><a class="lang-link" href="/de/sv/posts/alpine" id="lang-sv"><span class="flag-icon flag-icon-se"></span> Schwedisch</a><a class="lang-link" href="/de/th/posts/alpine" id="lang-th"><span class="flag-icon flag-icon-th"></span> Thai</a><a class="lang-link" href="/de/tr/posts/alpine" id="lang-tr"><span class="flag-icon flag-icon-tr"></span> Türkisch</a><a class="lang-link" href="/de/uk/posts/alpine" id="lang-uk"><span class="flag-icon flag-icon-ua"></span> ukrainisch</a><a class="lang-link" href="/de/ur/posts/alpine" id="lang-ur"><span class="flag-icon flag-icon-pk"></span> Urdu</a><a class="lang-link" href="/de/vi/posts/alpine" id="lang-vi"><span class="flag-icon flag-icon-vn"></span> Vietnamesisch</a><a class="lang-link" href="/de/zu/posts/alpine" id="lang-zu"><span class="flag-icon flag-icon-za"></span> Zulu-</a></ul></div></button></li></ul></div></nav></div></div></div><div><h1 id="title"><a href="/de/posts/alpine"> alpin</a></h1><blockquote id="page-description" style="font-style: italic;"> 
                Kiefer, Alpine Linux basierend auf OSTree
            </blockquote></div><div class="franklin-content"><p> Auswählen was<a href="https://en.wikipedia.org/wiki/Operating_system"> Betriebssystem</a>  auf Ihren Servern läuft, ist eine Frage der Bequemlichkeit und Vertrautheit. Bequemlichkeit bedeutet, dass Sie etwas wollen, das Ihnen so wenig Ärger wie möglich bereitet, Vertrautheit bedeutet, dass Sie es bevorzugen würden<em> nicht</em>  um zusätzliche Dinge zu lernen, wenn Sie nicht müssen.</p><p> Meine Server sind<a href="https://devops.stackexchange.com/questions/653/what-is-the-definition-of-cattle-not-pets"> Haustiere</a>  Ich bin also in Ordnung, ab und zu ein paar Befehle manuell auszugeben, und benötige keine vollständige Automatisierung.</p><p> Nach dem Ausprobieren<a href="https://en.wikipedia.org/wiki/Container_Linux"> CoreOS</a>  für ein Jahr wechselte ich zu meiner eigenen vereinfachten<a href="https://en.wikipedia.org/wiki/Linux_distribution"> verteilen</a>  basierend auf alpinen und<a href="https://en.wikipedia.org/wiki/OSTree"> Ostree</a>.</p><h2 id="goals"><a class="header-anchor" href="#goals"> Ziele</a></h2><p>Diese Version von Alpine orientiert sich an<a href="https://kinvolk.io/flatcar-container-linux/"> Flachwagen</a>  und<a href="https://www.projectatomic.io/"> projekt-atomar</a>  und soll als schreibgeschütztes Root-Dateisystem installiert werden, wobei Aktualisierungen atomar erfolgen, dh entweder sie erfolgreich sind oder das System in den vorherigen Zustand zurückwechselt. Damit dies möglich ist, muss das System immer mindestens<strong> zwei Schnappschüsse</strong>  der freigegebenen Dateisystemversion, die auf dem Speicher verfügbar ist.</p><h2 id="targets"><a class="header-anchor" href="#targets"> Ziele</a></h2><p> In welchen Umgebungen wird das System laufen? Ich habe gezielt<a href="https://en.wikipedia.org/wiki/OpenVZ"> OVZ</a>  und [KVM], aber im Allgemeinen kann man sagen<em> Behälter</em>  und<em> virtuelle Maschinen</em>  mit dem Hauptunterschied, dass Container keinen eigenen Kernel ausführen, insbesondere keinen Bootprozess haben, sie rufen direkt in die<em> drin</em>  System (das zum Beispiel in a<code><a href="https://en.wikipedia.org/wiki/Docker_(software)">Dockerfile</a></code>  es wäre definiert durch die<code>CMD</code>  oder<code>ENTRYPOINT</code>  -Anweisungen), die für die Verwaltung des Prozessbaums verantwortlich ist, der den Container am Laufen hält (genau wie eine normale Sitzung, wenn der Init-Prozess abbricht, wird der Container beendet). Außerdem können Container keine System-Knöpfe konfigurieren und können zusätzliche Einschränkungen hinsichtlich der Funktionen haben.</p><h2 id="bisecting_the_build_process"><a class="header-anchor" href="#bisecting_the_build_process">Halbieren des Build-Prozesses</a></h2><p> Wie ist das Bild aufgebaut?</p><h3 id="dependencies"><a class="header-anchor" href="#dependencies"> Abhängigkeiten</a></h3><p> Die<code>prepare.sh</code>  Das Skript behandelt Abhängigkeiten, von denen die meisten Pakete sind, die gängige CLI-Tools anbieten wie<code>coreutils</code>, <code>util-linux</code>, <code>binutils</code> , Dienstprogramme für den Betrieb mit Blockgeräten wie<code>blkid</code>, <code>sfdisk</code>, <code>multipath-tools</code>  und Dateisysteme mit<code>xfsprogs</code>  und<code>e2fsprogs</code> . Die<code>squashfs-tools</code>  package wird am Ende verwendet, um das erstellte Root-Dateisystem zu komprimieren. EIN<code>glib</code>  Kompatibilitätspaket wird ebenfalls standardmäßig installiert, da alpine auf basiert<code><a href="https://musl.libc.org/">musl</a></code> funktioniert das Kompatibilitätspaket, indem es einige Bibliotheken bereitstellt, die gegen .</p><h3 id="the_tree"><a class="header-anchor" href="#the_tree"> Der Baum</a></h3><p> Dateibäume für VMs und Container werden entsprechend erstellt<code>make.sh</code>  und<code>make_ovz.sh</code> . Dies ist eine vereinfachte Beschreibung der Schritte</p><ul><li><p> Legen Sie die Version fest, die gemäß dem Repository-Tag erstellt werden soll</p></li><li><p>Erstellen Sie ein Verzeichnis für den neuen Baum und löschen Sie die Umgebung</p></li><li><p> Erstellen Sie Basiszielverzeichnisse und Verzeichnisse, die von ostree benötigt werden, wie<code>sysroot</code></p></li><li><p> Erstellen Sie Symlinks, um mit den<a href="https://www.freedesktop.org/software/systemd/man/file-hierarchy.html"> Dateisystemhierarchie-Standard</a></p></li><li><p> Kopieren Sie benutzerdefinierte Dienste und benutzerdefinierte Konfigurationen</p></li><li><p> chroot mit gemounteten Systemverzeichnissen einrichten</p></li><li><p> Bootstrap ein alpines Rootfs mit Basispaketen</p></li><li><p> Wenden Sie eine minimale Konfiguration auf die Rootfs an, z. B. Anmeldeinformationen, Zeitzone, Hostname.</p></li><li><p> Kopierdienste, die von init gestartet werden</p></li><li><p> Setup der Boot-Konfiguration mit dem angegebenen Kernel-Image</p></li><li><p> optional benutzerdefinierte Kernel-Module hinzufügen</p></li><li><p> Aufräumarbeiten durchführen</p></li><li><p> begehen die rootfs<sup id="fnref:rootfs"><a class="fnref" href="#fndef:rootfs">[1]</a></sup>  zum ostree Repository</p></li></ul><p> Bei Containern ist die Reihenfolge dieselbe, jedoch ändert sich die Konfiguration, da bei einem System, das nicht von einem<a href="https://en.wikipedia.org/wiki/Bootloader"> Bootloader</a>  ostree hat Probleme bei der Überprüfung der Umgebung, wir müssen einige anwenden<a href="https://github.com/untoreh/pine/blob/e65f12be70fd91edfd935e3ae9854c7be555ec73/make_ovz.sh#L73"> Problemumgehungen</a>  und richten Sie einige Geräte ein, die normalerweise von der<a href="https://en.wikipedia.org/wiki/Initial_ramdisk"> initramfs</a>  Schritt. Das ist wie<a href="https://en.wikipedia.org/wiki/OpenVZ"> OVZ</a>  oder<a href="https://en.wikipedia.org/wiki/LXC"> LXC</a>  Vorlagen konfiguriert sind.</p><h3 id="packaging"><a class="header-anchor" href="#packaging"> Verpackung</a></h3><p> Sobald wir unseren Ostree-Commited-Dateibaum haben<code>build.sh</code>  oder<code>build-update.sh</code>  kümmert sich um die Produktion des zu verteilenden Artefakts. Der Unterschied zwischen den Skripten besteht darin, dass die Update-Version von einem früheren ostree-Repository startet und<em> Auch</em>  erzeugt ein Delta-Artefakt, das ein laufendes System auf seine Ostree-Instanz anwenden kann, um Upgrades durchzuführen. Dies ist eine vereinfachte Beschreibung der Build-Schritte</p><ul><li><p> wenn neu gebaut</p><ul><li><p> Erstellen Sie neue Partitionen auf einem neuen Image, das als Loop-Gerät gemountet ist</p></li></ul></li><li><p> anders</p><ul><li><p> Mounten Sie sysroot und booten Sie Partitionen des vorherigen Builds</p></li></ul></li><li><p> Bereinigen Sie frühere ostree-Bereitstellungen (Link-Farmen) auf bereitgestellten Builds</p></li><li><p> Commit neu erstellten Baum auf gemounteten Build</p></li><li><p> Integrität und Prüfsummen überprüfen</p></li><li><p> Neues Delta für Upgrades erstellen</p></li><li><p>Führen Sie die ostree-Bereitstellung aus, um die Boot-Konfiguration zu regenerieren</p></li><li><p> alte Ostree-Commits entfernen</p></li><li><p> Integrität der Boot-Partition überprüfen</p></li><li><p> unmounten Sie das neue aktualisierte Build-Image</p></li><li><p> Bildprüfsumme generieren und komprimieren (mit<code>squashfs</code>  für Container)</p></li></ul><p> Die Partitionskonfiguration wird mit einer fdisk . angewendet<code>layout.cfg</code>  Datei, die die Partitionsgrößen definiert, haben wir eine Partition für die rootfs (<code>~430M</code> ), die Bootpartition (<code>~40M</code> ) und eine Swap-Partition (<code>~40M</code> ). Bei Containern überspringen Sie einfach das Mounten des vorherigen Builds über ein Loop-Gerät und ziehen einfach den neuen ostree-Commit über das alte (extrahierte) ostree-Repository.</p><h2 id="customizations"><a class="header-anchor" href="#customizations"> Anpassungen</a></h2><p> Was bündele ich in diesem Image (abgesehen von installierten Paketen)?</p><ul><li><p> Eine kleine Bibliothek in<code>functions.sh</code>  für allgemeine Aufgaben, die innerhalb der Shell ausgeführt werden</p></li><li><p> ostree-basierte Upgrade-Skripte mit Sperrmechanismus basierend auf KV Store</p></li><li><p> Überwachungsskripte für IO sowohl lokale (<code>iomon</code> ) und Netzwerk (<code>tcpmon</code>)</p></li><li><p> Setup-Skripte für andere Container-Laufzeiten als<code>bubblewrap</code>: <code>podman</code>, <code>toolbox</code></p></li></ul><p> Was war und ist nicht mehr</p><ul><li><p><code>sup</code>: <a href="https://github.com/pressly/sup/"> Sup</a>  wurde für die Orchestrierung (Bereitstellen von Containern) und die Konfiguration des Hostcomputers verwendet, aber dann wechselte ich zu<a href="https://www.ansible.com/"> ansible</a>  da es in sup seit langem fehler gab, die nicht behoben wurden, habe ich mich von vornherein nicht für ansible entschieden, da ich nicht wollte, dass auf jedem server eine python-abhängigkeit installiert wird, schlussendlich habe ich mich mit einem sekundären alpinen begnügt<a href="https://en.wikipedia.org/wiki/Chroot"> chroot</a>  auf den Host-Rechnern, die sich in befinden<code>/opt/alp</code>  wo ich zusätzliche weniger kritische Software installiere. Heute würde ich aber wieder von ansible zu wechseln<a href="https://github.com/Fizzadar/pyinfra"> pyinfra</a> , da</p><ul><li><p> es ist Python ohne Boilerplate (ansible hat pseudo<code>DSL</code>  das verursacht mehr Kopfschmerzen als die, die es löst)</p></li><li><p> es führt seine Rezepte mit einfachen ssh-Befehlen aus, es gibt also keine Python-Abhängigkeitsanforderung auf Zielhosts</p></li></ul></li><li><p><code>containerpilot</code>: Der Anwendungsfall für Container Pilot besteht darin, komplexe Abhängigkeiten zwischen Containern ohne Shell-Skripte zu verwalten ... es werden keine Updates mehr von<a href="https://github.com/joyent/containerpilot"> freudig</a>  und in den Wartungsmodus versetzt wurde, gefiel mir auch der Speicherbedarf nicht und die Speicherauslastung stieg für eine lange Betriebszeit ständig an. Ich habe es auf einfache Shell-Skripte umgestellt mit<a href="https://www.consul.io/"> Konsul</a> , könnte ich nach geeigneten Alternativen suchen, wenn Shell-Skripte zu stark anwachsen. Schwerere Lösungen wie<a href="https://kubernetes.io/"> Kubernetes</a>, <a href="https://docs.docker.com/engine/swarm/"> Schwarm</a>  oder<a href="https://www.nomadproject.io/"> Nomade</a>  wurden von vornherein verworfen.</p></li><li><p><code>beegfs</code> : Früher habe ich das Kernel-Modul geliefert, das für . erforderlich ist<a href="https://en.wikipedia.org/wiki/BeeGFS"> Rindfleisch</a>  aber nach einer Weile brach es die Kompatibilität und die Tatsache, dass es kein richtig unterstütztes gab<a href="https://en.wikipedia.org/wiki/Filesystem_in_Userspace"> Sicherung</a>  Modul gemacht werden, es ganz wegzulassen, ich betreibe derzeit kein [DFS] auf meinen Servern, aber die Möglichkeit, ein einsatzbereites Dateisystem zu haben, um ein Netzwerk anzuschließen, ist immer noch attraktiv.</p></li><li><p></p></li></ul><h2 id="installation"><a class="header-anchor" href="#installation"> Installation</a></h2><p> Um das Image zu installieren, können Sie es entweder beim Hosting-Provider hochladen und von VNC aus installieren, im Fall von virtuellen Maschinen, aber normalerweise hijacke ich eine vorhandene Installation, da dies immer möglich ist, solange ich das Setup-Skript gegen die Version von getestet habe die Linux-Distribution, im Allgemeinen verwende ich Debian-8 oder Ubuntu-14, habe andere nicht getestet, da ich diese immer als verfügbar gefunden habe. Die Einrichtungsschritte folgen</p><ul><li><p> https-Unterstützung für Downloads sicherstellen</p></li><li><p> Laden Sie eine Busybox-Version herunter</p></li><li><p> installiere eine Busybox Link-Farm</p></li><li><p> Bestimmen Sie IPv4-/IPv6-Adressen für die Netzwerkkonfiguration</p></li><li><p> chroot-Fähigkeiten sicherstellen</p></li><li><p> Laden Sie das Kiefernbild herunter und extrahieren Sie es</p></li><li><p> wenn VM</p><ul><li><p> über Zielgerät flashen</p></li><li><p> über einem Loop-Gerät montieren</p></li></ul></li><li><p> schreiben Sie die lokale Netzwerkkonfiguration über die<em> geflasht werden</em>  rootfs</p></li><li><p>wenn Behälter</p><ul><li><p> Kopieren Sie den Init-Dienst (für Container) über den Haupt-Root-Mount-Punkt<code>/sbin/init</code></p></li></ul></li><li><p> wenn VM</p><ul><li><p> Partitionieren Sie die übrig gebliebene Festplatte mit Standard (<code>xfs</code> ) Partitionen</p></li><li><p> abmontieren</p></li><li><p> Integrität der Partitionen überprüfen</p></li></ul></li><li><p> neustarten</p></li></ul><h2 id="conclusions"><a class="header-anchor" href="#conclusions"> Schlussfolgerungen</a></h2><p> ich machte<a href="https://github.com/untoreh/pine"> Kiefer</a> 5 years from time of writing and I am still using it, and I see no reasons to switch to anything else. Alpine as a linux distro is great, simple, and I have never experienced breakage. I can easily deploy on <a href="https://en.wikipedia.org/wiki/Network_address_translation"> NATed</a>  Server, die dazu neigen, extrem niedrige Ressourcen anzubieten, eigentlich habe ich eine Box mit nur<code>64M</code>  RAM und habe immer noch alle Funktionen, die ich benötige.</p><p></p><table class="fndef" id="fndef:rootfs"><tbody><tr><td class="fndef-backref"><a href="#fnref:rootfs">[1]</a></td><td class="fndef-content"> Root-Dateisystem</td></tr></tbody></table><p></p><div id="post-tags-list"> 
Post-Tags:
<span class="post-tag"><a href="/de/posts/tag/tools" style="">  Werkzeuge</a>, </span><span class="post-tag"><a href="/de/posts/tag/about" style="">  Über</a></span></div><div class="page-foot"><div class="copyright"> 
        19. April 2021
    </div><script async="" crossorigin="anonymous" issue-term="pathname" label="Comment" repo="untoreh/untoreh.github.io" src="https://utteranc.es/client.js"></script></div></div><div class="page__footer"><footer><div class="page__footer-copyright"> 
            © untoreh - Powered by<a href="https://github.com/tlienart/Franklin.jl"> Franklin</a></div><div class="page__footer-links">
            -
            <ul><li><a href="/de/sitemap.xml"> Seitenverzeichnis</a></li>
                |
                <li><a href="/de/tag"> Stichworte</a></li>
                |
                <li><a href="/de/feed.xml"> RSS</a></li></ul></div><ul class="author__wrap"><li class="author__urls social-icons"><a href="https://twitter.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden="true" class="fab fa-fw fa-twitter-square"></i></a></li><li class="author__urls social-icons"><a href="https://github.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden="true" class="fab fa-fw fa-github"></i></a></li><li class="author__urls social-icons"><a href="mailto:contact@unto.re"><i class="fas fa-envelope"></i></a></li><li><script type="application/ld+json">{"potentialAction":{"query-input":"required maxlength=100 name=query","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":"https://unto.re/search?&q={query}"}}</script></li></ul></footer></div><script crossorigin="anonymous" defer="" id="fa" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" src="https://use.fontawesome.com/releases/v5.8.2/js/all.js"></script><script src="/libs/colors.js"></script><script src="/libs/menu.js"></script><script defer="" src="/libs/lunr/lunr.min.js"></script></body></HTML>