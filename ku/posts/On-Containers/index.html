<!DOCTYPE html><HTML lang="en"><head><meta charset="UTF-8"/><script type="application/ld+json">{"copyrightHolder":"untoreh","@id":"https://unto.re","url":"https://unto.re","copyrightYear":2021,"@context":"https://schema.org/","@type":"WebSite"}</script><script type="application/ld+json">{"audience":"cool people","url":"https://unto.re/posts/On-Containers/index.html","mainContentOfPage":{"@type":"WebPageElement","cssSelector":".franklin-content"},"accessMode":["textual","visual"],"accessibilitySummary":"Visual elements are tentatively described.","author":"untoreh","description":"Using containers, what and why","mentions":[],"accessModeSufficient":{"itemListElement":["textual","visual"],"description":"text and images","@type":"itemList"},"lastReviewed":"April 19, 2021","@type":"https://schema.org/WebPage","dateCreated":"April 24, 2021","@id":"https://unto.re/posts/On-Containers/index.html","dateModified":"April 19, 2021","abstract":"Using containers, what and why","headline":"On Containers","creativeWorkStatus":"Published","availableLanguage":[{"name":"English","@type":"Language"},{"name":"German","@type":"Language"},{"name":"Italian","@type":"Language"},{"name":"Mandarin Chinese","@type":"Language"},{"name":"Spanish","@type":"Language"},{"name":"Hindi","@type":"Language"},{"name":"Arabic","@type":"Language"},{"name":"Portuguese","@type":"Language"},{"name":"Bengali","@type":"Language"},{"name":"Russian","@type":"Language"},{"name":"Japanese","@type":"Language"},{"name":"Punjabi","@type":"Language"},{"name":"Javanese","@type":"Language"},{"name":"Vietnamese","@type":"Language"},{"name":"French","@type":"Language"},{"name":"Urdu","@type":"Language"},{"name":"Turkish","@type":"Language"},{"name":"Polish","@type":"Language"},{"name":"Ukranian","@type":"Language"},{"name":"Dutch","@type":"Language"},{"name":"Greek","@type":"Language"},{"name":"Swedish","@type":"Language"},{"name":"Zulu","@type":"Language"},{"name":"Kurdish","@type":"Language"},{"name":"Romanian","@type":"Language"},{"name":"Malay","@type":"Language"}],"keywords":["opinions","about"],"datePublished":"April 24, 2021","inLanguage":"English","name":"On Containers","identifier":"https://unto.re/posts/On-Containers/index.html"}</script><meta content="width=device-width, initial-scale=1" name="viewport"/><link href="/libs/highlight/github.min.css" rel="stylesheet"/><link href="/css/franklin.css" rel="stylesheet"/><link href="/css/main.css" rel="stylesheet"/><link href="/css/menu.css" rel="stylesheet"/><link href="/css/pages.css" rel="stylesheet"/><link href="/css/lunr.css" rel="stylesheet"/><link href="/css/footer.css" rel="stylesheet"/><link href="/css/responsive.css" rel="stylesheet"/><link href="/css/animations.css" rel="stylesheet"/><link href="/css/docco.css" rel="stylesheet"/><link href="/assets/favicon.png" rel="icon"/><title>On Containers</title><script src="/libs/lunr/lunr.min.js"></script><script src="/libs/lunr/lunr_index.js"></script><script src="/libs/lunr/lunrclient.min.js"></script><script src="/libs/load.js"></script><script type="application/ld+json">{"@id":"https://unto.re/ku/posts/On-Containers/index.html","url":"https://unto.re/ku/posts/On-Containers/index.html","abstract":null,"headline":null,"keywords":null,"description":null,"mentions":null,"translator":{"url":"https://translate.google.com/","name":"Google","@type":"https://schema.org/Organization"},"translationOfWork":{"@id":"/home/fra/dev/blog/https://unto.re/"},"inLanguage":"ku","name":null,"@type":"https://schema.org/WebPage"}</script></head><body class=""><div class="masthead"><div class="masthead__inner-wrap"><div class="masthead__menu"><a class="site-title" href="/"></a><div class="author__wrap"><script type="application/ld+json">{"sameAs":["https://github.com/untoreh","https://twitter.com/untoreh"],"description":"I am Francesco Giannelli. The website «unto.re» is the place where I put stuff I should remember...or forget. Located in south italy. Born in the early nineties.","image":"/assets/appa.png","name":"untoreh","@type":"https://schema.org/Person","email":"contact@unto.re"}</script><ul><li class="author__avatar" onclick="toggleTheme()"><img alt=" untoreh-ışık" class="flip-front" src="/assets/appa.png"/></li><li class="author__urls social-icons"><a href="https://twitter.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden="true" class="fab fa-fw fa-twitter-square"></i></a></li><li class="author__urls social-icons"><a href="https://github.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden="true" class="fab fa-fw fa-github"></i></a></li><li class="author__urls social-icons"><a href="mailto:contact@unto.re"><i class="fas fa-envelope"></i></a></li><li class="author__place hvr-buzz-out"><script type="application/ld+json">{"homeLocation":{"addressCountry":"IT","addressRegion":"Apulia","@type":"https://schema.org/Place"}}</script><div class="author__bio .hvr-bubble-float-top">
        I am Francesco Giannelli. The website «unto.re» is the place where I put stuff I should remember...or forget. Located in south italy. Born in the early nineties.
    </div><a href="https://goo.gl/maps/E3Si7WzG4LX7wpNJ6" rel="nofollow noopener noreferrer" target="_blank"><i aria-hidden="true" class="fas fa-fw fa-map-marker-alt"></i>italy</a></li><li><script type="application/ld+json">{"potentialAction":{"query-input":"required maxlength=100 name=query","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":"https://unto.re/search?&q={query}"}}</script></li></ul></div><nav id="site-nav"><div class="horiz"><ul><li class="masthead__menu-item hvr-outline-in" id="lunrSearch"><form id="lunrSearchForm" name="lunrSearchForm"><button class="search-button" formaction="/search/index.html" type="submit" value="Search"><i class="fas fa-search menu-icons"></i></button><input class="search-input" name="q" placeholder="Search…" type="text"/></form></li><li class="masthead__menu-item hvr-outline-in"><a href="/posts/"><i class="fas fa-pen menu-icons"></i>posts</a></li><li class="masthead__menu-item hvr-outline-in"><a href="/tag/lightbulbs/"><i class="fas fa-lightbulb menu-icons"></i>bulbs</a></li><li class="masthead__menu-item hvr-outline-in"><a href="/reads/"><i class="fas fa-book menu-icons"></i>reads</a></li><li class="masthead__menu-item hvr-outline-in"><a href="/tag/about/"><i class="fas fa-wrench menu-icons"></i>about</a></li></ul></div><button class="ham"><i class="fas fa-bars ham-icon"></i></button><div class="vert"><ul><li class="masthead__menu-item hvr-outline-in" id="lunrSearch"><form id="lunrSearchForm" name="lunrSearchForm"><button class="search-button" formaction="/search/index.html" type="submit" value="Search"><i class="fas fa-search menu-icons"></i></button><input class="search-input" name="q" placeholder="Search…" type="text"/></form></li><li class="masthead__menu-item hvr-outline-in"><a href="/posts/"><i class="fas fa-pen menu-icons"></i>posts</a></li><li class="masthead__menu-item hvr-outline-in"><a href="/tag/lightbulbs/"><i class="fas fa-lightbulb menu-icons"></i>bulbs</a></li><li class="masthead__menu-item hvr-outline-in"><a href="/reads/"><i class="fas fa-book menu-icons"></i>reads</a></li><li class="masthead__menu-item hvr-outline-in"><a href="/tag/about/"><i class="fas fa-wrench menu-icons"></i>about</a></li></ul></div></nav></div></div></div><div><h1 id="title"><a href="">On Containers</a></h1><blockquote id="page-description" style="font-style: italic;">
                Using containers, what and why
            </blockquote></div><div class="franklin-content"><h2 id="what_are_containers"><a class="header-anchor" href="#what_are_containers">What are containers</a></h2><p>[Containers] is a name given to restricted environments, made possible by a collection of subsystems within linux like [<code>cgroups</code>] and [<code>namespaces</code>]. Although the wiki page uses the word <em>virtualization</em> I think the word <em>isolation</em> is more appropriate, since virtualization means that there is a layer of translation in-between, while what cgroups and namespaces do is to separate, and contextualize processes.</p><p>Cgroups are used to define allocation policies for resources, usually <code>RAM</code> and <code>CPU</code>, while namespaces control the contexts like mount-points, networking and users. [Apparmor] instead provides a way to restrict capabilities for containers environments as a whole, whereas apparmor without containers is, as written in wikipedia, program-based.</p><p>Tools like <a href="https://en.wikipedia.org/wiki/Flatpak">flatpak</a> and <a href="https://github.com/netblue30/firejail">firejail</a> use containers, to constrain the access surface of user applications. [Windows] containers implements equivalent systems, and also offer support for linux containers through [WSL].</p><h2 id="but_why"><a class="header-anchor" href="#but_why">But why?</a></h2><ul><li><p>Sometimes for security, however in that case, full virtualization gives better assurances.</p></li><li><p>To achieve reproducibility of execution, and portability, such that applications relying on particular environments configurations can run without troubling the user for additional setup steps.</p></li><li><p>Scheduling, orchestration software like kubernetes uses [container runtimes] to move services across hosts seamlessly and to abstract execution logic.</p></li></ul><h2 id="too_much"><a class="header-anchor" href="#too_much">Too much?</a></h2><p>When I started building <a href="/posts/alpine/">pine</a>, I experimented a bit with shipping my own container images, distributed from github releases. The main script (<code>trees</code>) commands were</p><pre><code class="sh hljs">Usage: trees APP [FLAGS]...
<span class="hljs-string">'APP'</span>               Install apps through ostree deltas checkouts.
    -b, --base      base image (alp,trub...)
    -n, --name      same as APP (etcd,hhvm...)
    -f, --force     clear before install
    -d, --delete    clear checkout and prune ostree repo
ck, check           make sure the apps repo is mounted
co, checkout        builds the trees of links <span class="hljs-keyword">for</span> the specified APP
    -t 	            optional path <span class="hljs-built_in">where</span> to build the tree</code></pre><p>It was similar to flatpak, as I was shipping an ostree static delta based on the main pine image, and [checking out] the new app based rootfs, and then launching a container instance on top of it. OpenVZ had lots of issues before v7 for running container (since you know...you were running a <em>nested</em> container on a container-based [VPS], and the kernel was a fork of <code>v2.6</code> (!))...it was a <strong>huge</strong> waste of time.</p><h2 id="when"><a class="header-anchor" href="#when">When?</a></h2><p>My attempt was to get a minimal container runtime without requiring <code>docker</code> or more beefier software, as docker is probably the most lightweight, and <a href="https://docs.docker.com/engine/swarm/">docker swarm</a>, being built-in shares a lot of functionality and provides you the most useful features for orchestration, which makes it the most lean on host system requirements compared to <a href="https://docs.kublr.com/installation/hardware-recommendation/">k8s</a> or <a href="https://www.nomadproject.io/docs/install/production/requirements">nomad</a>.</p><p>Despite containers being a feature you might want most of the times, orchestration isn't. I think <em>loosely targeted</em> advertising campaigns attract the <em>un-intended</em> target audience for such software, making one believe that it can be useful <em>to them</em>, without emphasizing the premise that you <strong>really</strong> need to scale a lot(!) to justify the complexity cost of such setups. The number of <a href="https://reddit.com/r/kubernetes/comments/be0415/k3s_minikube_or_microk8s/el2xy5r/">convenience tooling</a> built around k8s to aid the bootstrapping process of a k8s cluster should be enough evidence...</p><h2 id="conclusions"><a class="header-anchor" href="#conclusions">Conclusions</a></h2><p>Orchestrations tools end up crowding the place for solutions to manage multi host machines when users can't tell the difference between pet and cattle servers. On many occasions, software like ansible, pyinfra or even <a href="https://github.com/duncs/clusterssh">cssh</a> or <a href="https://github.com/moul/assh">assh</a> is all one ever needs.</p><p></p><div id="post-tags-list">
Post Tags:
<span class="post-tag"><a href="/posts/tag/opinions" style=""> opinions </a>, </span><span class="post-tag"><a href="/posts/tag/about" style=""> about </a></span></div><div class="page-foot"><div class="copyright">
        April 19, 2021
    </div><script async="" crossorigin="anonymous" issue-term="pathname" label="Comment" repo="untoreh/untoreh.github.io" src="https://utteranc.es/client.js"></script></div></div><div class="page__footer"><footer><div class="page__footer-copyright">
            © untoreh - Powered by <a href="https://github.com/tlienart/Franklin.jl">Franklin</a></div><div class="page__footer-links">
            -
            <ul><li><a href="/sitemap.xml">Sitemap</a></li>
                |
                <li><a href="/tag">Tags</a></li>
                |
                <li><a href="/feed.xml">RSS</a></li></ul></div><ul class="author__wrap"><li class="author__urls social-icons"><a href="https://twitter.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden="true" class="fab fa-fw fa-twitter-square"></i></a></li><li class="author__urls social-icons"><a href="https://github.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden="true" class="fab fa-fw fa-github"></i></a></li><li class="author__urls social-icons"><a href="mailto:contact@unto.re"><i class="fas fa-envelope"></i></a></li><li class="author__place hvr-buzz-out"><script type="application/ld+json">{"homeLocation":{"addressCountry":"IT","addressRegion":"Apulia","@type":"https://schema.org/Place"}}</script><div class="author__bio .hvr-bubble-float-top">
        I am Francesco Giannelli. The website «unto.re» is the place where I put stuff I should remember...or forget. Located in south italy. Born in the early nineties.
    </div><a href="https://goo.gl/maps/E3Si7WzG4LX7wpNJ6" rel="nofollow noopener noreferrer" target="_blank"><i aria-hidden="true" class="fas fa-fw fa-map-marker-alt"></i>italy</a></li><li><script type="application/ld+json">{"potentialAction":{"query-input":"required maxlength=100 name=query","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":"https://unto.re/search?&q={query}"}}</script></li></ul></footer></div><script crossorigin="anonymous" defer="" id="fa" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" src="https://use.fontawesome.com/releases/v5.8.2/js/all.js"></script><script src="/libs/colors.js"></script><script src="/libs/menu.js"></script><script defer="" src="/libs/lunr/lunr.min.js"></script></body></HTML>